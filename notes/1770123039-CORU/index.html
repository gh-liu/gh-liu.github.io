<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Blog"><title>test</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.16.0/devicon.min.css"><script>
      // This script runs synchronously in the head to prevent FOUC (Flash of Unstyled Content)
      (function() {
        const THEME_KEY = 'nord-theme';
        const DARK = 'dark';
        
        function getStoredTheme() {
          try {
            return localStorage.getItem(THEME_KEY);
          } catch {
            return null;
          }
        }
        
        function getSystemTheme() {
          return window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : 'light';
        }
        
        function getTheme() {
          return getStoredTheme() || getSystemTheme();
        }
        
        function applyTheme(theme) {
          const html = document.documentElement;
          if (theme === DARK) {
            html.classList.add('dark');
          } else {
            html.classList.remove('dark');
          }
        }
        
        // Apply theme immediately before page renders
        applyTheme(getTheme());
      })();
    </script><link rel="stylesheet" href="/_astro/_id_.6ed6JusR.css">
<style>.knowledge-graph-container[data-astro-cid-zjb43jqo]{border:1px solid var(--nord-4);border-radius:8px;background:var(--nord-6);position:relative;overflow:hidden}.knowledge-graph-container[data-astro-cid-zjb43jqo]:fullscreen,.knowledge-graph-container[data-astro-cid-zjb43jqo]::-webkit-full-screen{width:100vw;height:100vh;border-radius:0}.knowledge-graph-container[data-astro-cid-zjb43jqo]:fullscreen .knowledge-graph-wrapper[data-astro-cid-zjb43jqo],.knowledge-graph-container[data-astro-cid-zjb43jqo]::-webkit-full-screen .knowledge-graph-wrapper[data-astro-cid-zjb43jqo]{width:100%;height:100%}.knowledge-graph-toolbar{position:absolute;top:8px;right:8px;z-index:10;display:flex;gap:4px;align-items:center}.knowledge-graph-toolbar-btn{width:32px;height:32px;padding:0;border:1px solid var(--nord-4);border-radius:6px;background:var(--nord-6);color:var(--nord-2);font-size:16px;font-weight:600;line-height:1;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .15s,color .15s}.knowledge-graph-toolbar-btn:hover{background:var(--nord-5);color:var(--nord-10)}.knowledge-graph-toolbar-btn:active{background:var(--nord-4)}.knowledge-graph-wrapper[data-astro-cid-zjb43jqo]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.knowledge-graph-node{cursor:pointer;stroke:#5e81ac;stroke-width:2.5px;transition:all .2s ease}.knowledge-graph-node:hover{stroke-width:2.5px;filter:brightness(1.2)}.knowledge-graph-node.active{stroke:var(--nord-14);stroke-width:3px;filter:drop-shadow(0 0 8px rgba(191,97,106,.5))}.knowledge-graph-node--current{stroke:var(--nord-10);stroke-width:3px;filter:drop-shadow(0 0 6px rgba(94,129,172,.6))}.knowledge-graph-node--outlink{stroke:var(--nord-14);stroke-width:2.5px}.knowledge-graph-node--backlink{stroke:var(--nord-15);stroke-width:2.5px}.knowledge-graph-node--both{stroke:var(--nord-12);stroke-width:2.5px}.knowledge-graph-node--neighbor{stroke:var(--nord-4);stroke-width:2px;opacity:.9}.knowledge-graph-link{stroke:#4c566a;stroke-opacity:.85;stroke-width:2px}.knowledge-graph-link.active{stroke:var(--nord-11);stroke-opacity:.9;stroke-width:2px}.knowledge-graph-label{pointer-events:none;font-size:11px;text-anchor:middle;fill:var(--nord-1);font-weight:500;text-shadow:0 0 3px var(--nord-6)}.knowledge-graph-tooltip{position:absolute;padding:8px 12px;background:var(--nord-0);border:1px solid var(--nord-3);border-radius:4px;font-size:12px;color:var(--nord-6);pointer-events:none;z-index:1000;box-shadow:0 2px 8px #0000004d;white-space:nowrap}.knowledge-graph-tooltip-type{color:var(--nord-8);font-size:11px}.knowledge-graph-legend{position:absolute;bottom:8px;left:8px;z-index:10;display:flex;flex-wrap:wrap;gap:8px 12px;font-size:11px;color:var(--nord-2)}.kg-legend-item{display:inline-flex;align-items:center;gap:4px}.kg-legend--current{color:var(--nord-10)}.kg-legend--outlink{color:var(--nord-14)}.kg-legend--backlink{color:var(--nord-15)}.kg-legend--both{color:var(--nord-12)}.kg-legend--neighbor{color:var(--nord-4);opacity:.9}
html{scroll-behavior:smooth}article[data-astro-cid-v5yihett]{word-break:break-word}
</style></head> <body class="text-nord-3 dark:text-nord-5 transition-all bg-gradient-light"> <header class="border-b border-nord-5 dark:border-nord-1 bg-nord-6 dark:bg-nord-0"> <nav class="max-w-4xl mx-auto px-4 py-5 flex items-center justify-between gap-4"> <div class="flex items-center gap-2 min-w-0"> <a href="/" title="Liu" class="shrink-0 p-1.5 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-lg dark:hover:shadow-nord-8/20 active:scale-95"> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"> <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path> <circle cx="12" cy="7" r="4"></circle> </svg> </a> <h1 class="text-xl font-bold truncate"> <a href="/" class="text-nord-2 dark:text-nord-6 hover:text-nord-10 dark:hover:text-nord-8 transition-colors"> Liu </a> </h1> </div> <div class="flex items-center gap-2 shrink-0"> <a href="https://github.com/gh-liu" title="GitHub" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-label="GitHub"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </svg> </a> <a href="https://x.com" title="X" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-label="X"> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24h-6.657l-5.207-6.807-5.975 6.807H2.306l7.644-8.74-8.179-10.76h6.467l4.713 6.231 5.429-6.231zM17.002 18.807h1.844L6.983 4.126H5.025l11.977 14.681z"></path> </svg> </a> <span class="w-px h-4 bg-nord-4 dark:bg-nord-2 shrink-0" aria-hidden="true"></span> <div class="relative series-dropdown" id="series-dropdown-root"> <a href="/notes/series" title="Series" aria-expanded="false" aria-haspopup="true" aria-controls="series-dropdown-panel" id="series-dropdown-trigger" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M4 6h16M4 12h16M4 18h16"></path> </svg> </a> <div id="series-dropdown-panel" class="absolute right-0 top-full mt-1 py-2 min-w-[12rem] max-h-[70vh] overflow-y-auto rounded-lg border border-nord-4 dark:border-nord-2 bg-nord-6 dark:bg-nord-1 shadow-lg z-50 hidden" role="menu"> <div id="series-dropdown-list" class="py-1"> <span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">åŠ è½½ä¸­â€¦</span> </div> <div class="border-t border-nord-4 dark:border-nord-2 pt-1 mt-1"> <a href="/notes/series" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors">
æŸ¥çœ‹å…¨éƒ¨ç³»åˆ— â†’
</a> </div> </div> </div> <div class="relative tags-dropdown" id="tags-dropdown-root"> <a href="/notes/tags" title="Tags" aria-expanded="false" aria-haspopup="true" aria-controls="tags-dropdown-panel" id="tags-dropdown-trigger" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> </a> <div id="tags-dropdown-panel" class="absolute right-0 top-full mt-1 py-2 min-w-[12rem] max-h-[70vh] overflow-y-auto rounded-lg border border-nord-4 dark:border-nord-2 bg-nord-6 dark:bg-nord-1 shadow-lg z-50 hidden" role="menu"> <div id="tags-dropdown-list" class="py-1"> <span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">åŠ è½½ä¸­â€¦</span> </div> <div class="border-t border-nord-4 dark:border-nord-2 pt-1 mt-1"> <a href="/notes/tags" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors">
æŸ¥çœ‹å…¨éƒ¨æ ‡ç­¾ â†’
</a> </div> </div> </div> <div class="search-container" id="search-wrapper" data-astro-cid-t47yvtpn><button id="search-toggle" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex" aria-label="Search notes" title="Search (âŒ˜K)" data-astro-cid-t47yvtpn><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-t47yvtpn><circle cx="11" cy="11" r="8" data-astro-cid-t47yvtpn></circle><path d="m21 21-4.35-4.35" data-astro-cid-t47yvtpn></path></svg></button><div id="search-modal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-50 flex items-start justify-center pt-20 backdrop-blur-sm" data-astro-cid-t47yvtpn><div class="bg-nord-6 dark:bg-nord-0 rounded-2xl shadow-2xl w-full max-w-2xl border border-nord-5 dark:border-nord-1 max-h-[70vh] flex flex-col overflow-hidden animate-fade-in" data-astro-cid-t47yvtpn><div class="p-4 border-b border-nord-5 dark:border-nord-1" data-astro-cid-t47yvtpn><input type="search" id="search-input" placeholder="Search notes... (use #tag for tag search)" class="w-full px-4 py-2 bg-nord-5 dark:bg-nord-1 text-nord-2 dark:text-nord-6 placeholder-nord-3 dark:placeholder-nord-4 rounded focus:outline-none focus:ring-2 focus:ring-nord-9 dark:focus:ring-nord-8" autocomplete="off" data-astro-cid-t47yvtpn></div><div id="search-results" class="flex-1 overflow-y-auto p-4" data-astro-cid-t47yvtpn><p class="text-nord-3 dark:text-nord-5 text-sm" data-astro-cid-t47yvtpn>Type to search...</p></div><div class="p-3 border-t border-nord-5 dark:border-nord-1 text-xs text-nord-3 dark:text-nord-4" data-astro-cid-t47yvtpn><p data-astro-cid-t47yvtpn>Press <kbd class="px-1 py-0.5 bg-nord-4 dark:bg-nord-2 rounded" data-astro-cid-t47yvtpn>Esc</kbd> to close | Use <kbd class="px-1 py-0.5 bg-nord-4 dark:bg-nord-2 rounded" data-astro-cid-t47yvtpn>#tag</kbd> to search by tag</p></div></div></div></div><script>(function(){const pagefindUrl = "/pagefind/pagefind.js";

  if (!globalThis.pagefindLoaded) {
    globalThis.pagefindLoaded = true;
    
    let pagefind;
    let searchInput;
    let searchModal;
    let searchResults;
    let isSearchOpen = false;

    async function initSearch() {
      if (typeof window === "undefined") return;

      try {
        pagefind = await import(pagefindUrl);
        await pagefind.init();
      } catch (error) {
        console.log("Search not available.", error);
        return;
      }

      searchInput = document.getElementById("search-input");
      searchModal = document.getElementById("search-modal");
      searchResults = document.getElementById("search-results");
      const toggleBtn = document.getElementById("search-toggle");

      if (!searchInput || !searchModal || !searchResults || !toggleBtn) return;

      toggleBtn.addEventListener("click", () => {
        openSearch();
      });

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          closeSearch();
        }
        if ((e.metaKey || e.ctrlKey) && e.key === "k") {
          e.preventDefault();
          isSearchOpen ? closeSearch() : openSearch();
        }
      });

      searchModal.addEventListener("click", (e) => {
        if (e.target === searchModal) closeSearch();
      });

      searchInput.addEventListener("input", async (e) => {
        const query = e.target.value.trim();
        if (!query) {
          searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">Type to search...</p>';
          return;
        }

        // Check if query starts with #tag
        const isTagSearch = query.startsWith('#');
        let results;
        
        if (isTagSearch) {
          // Tag search
          const tag = query.slice(1).toUpperCase();
          results = await pagefind.search(`tag:${tag}`);
        } else {
          // Regular text search
          results = await pagefind.search(query);
        }

        if (results.results.length === 0) {
          searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">No results found.</p>';
          return;
        }

        let html = '<ul class="space-y-2">';
        for (const result of results.results) {
          const data = await result.data();
          // Extract title from h1 or use URL slug as fallback
          const title = data.meta?.title || data.title || (data.url.split('/').pop() || 'untitled').replace(/-/g, ' ');
          html += `<li><a href="${data.url}" class="block p-3 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-2 text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-all hover:shadow-md duration-200 border border-transparent hover:border-nord-9 dark:hover:border-nord-8"><div class="font-medium">${title}</div><div class="text-xs text-nord-3 dark:text-nord-5 mt-1 line-clamp-2">${data.excerpt || ""}</div></a></li>`;
        }
        searchResults.innerHTML = html + "</ul>";
      });
    }

    function openSearch() {
      isSearchOpen = true;
      searchModal.classList.remove("hidden");
      searchInput.focus();
      document.body.style.overflow = "hidden";
    }

    function closeSearch() {
      isSearchOpen = false;
      searchModal.classList.add("hidden");
      searchInput.value = "";
      searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">Type to search...</p>';
      document.body.style.overflow = "";
    }

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initSearch);
    } else {
      initSearch();
    }
  }
})();</script> <button id="theme-toggle" aria-label="Toggle theme" title="Toggle theme" class="group relative p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-3 dark:text-nord-4 transition-all duration-200 ease-out hover:scale-110 inline-flex"> <span class="inline-block transition-transform duration-200 ease-out group-hover:rotate-12"> <svg id="sun-icon" class="w-4 h-4 text-nord-13 hidden dark:block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <circle cx="12" cy="12" r="5"></circle> <line x1="12" y1="1" x2="12" y2="3"></line> <line x1="12" y1="21" x2="12" y2="23"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line> <line x1="1" y1="12" x2="3" y2="12"></line> <line x1="21" y1="12" x2="23" y2="12"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line> </svg> <svg id="moon-icon" class="w-4 h-4 text-nord-9 block dark:hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path> </svg> </span> </button> <script>
  const THEME_KEY = 'nord-theme';
  const DARK = 'dark';
  
  function getStoredTheme() {
    return localStorage.getItem(THEME_KEY);
  }
  
  function getSystemTheme() {
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : 'light';
  }
  
  function getTheme() {
    return getStoredTheme() || getSystemTheme();
  }
  
  function applyTheme(theme) {
    const html = document.documentElement;
    if (theme === DARK) {
      html.classList.add('dark');
    } else {
      html.classList.remove('dark');
    }
  }
  
  function toggleTheme() {
    const currentTheme = getTheme();
    const newTheme = currentTheme === DARK ? 'light' : DARK;
    localStorage.setItem(THEME_KEY, newTheme);
    applyTheme(newTheme);
  }
  
  const themeToggle = document.getElementById('theme-toggle');
  if (themeToggle) {
    themeToggle.addEventListener('click', toggleTheme);
  }
</script> </div> </nav> </header> <main class="max-w-4xl mx-auto px-4 py-12" data-pagefind-body> <aside id="toc-sidebar" class="fixed left-0 top-0 h-screen w-56 bg-nord-6 dark:bg-nord-0 border-r border-nord-5 dark:border-nord-1 overflow-y-auto overflow-x-hidden pt-4 pb-4 transition-transform duration-300 -translate-x-full z-50" data-astro-cid-vrmg3htk> <nav class="px-4 space-y-1" data-astro-cid-vrmg3htk> <!-- Close button --> <button id="toc-close" class="flex justify-end w-full mb-4 p-2 text-nord-2 dark:text-nord-6 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors" aria-label="Close navigation" data-astro-cid-vrmg3htk> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-vrmg3htk> <path d="M18 6L6 18M6 6l12 12" data-astro-cid-vrmg3htk></path> </svg> </button> <h3 class="text-xs font-bold text-nord-2 dark:text-nord-6 uppercase tracking-widest px-2 py-3 border-b border-nord-5 dark:border-nord-1" data-astro-cid-vrmg3htk>
On this page
</h3> <ul class="space-y-0.5 text-sm mt-4" data-astro-cid-vrmg3htk> <li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#01--go-test-å‘½ä»¤go-help-test" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.1 Â· go test å‘½ä»¤ï¼ˆgo help testï¼‰ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#02--testing-åŒ…go-doc-testing" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.2 Â· testing åŒ…ï¼ˆgo doc testingï¼‰ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#021--å››ç§å‡½æ•°å½¢å¼" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 0.2.1 Â· å››ç§å‡½æ•°å½¢å¼ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#022--testxxx" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 0.2.2 Â· TestXxx </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#023--benchmarkxxx" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 0.2.3 Â· BenchmarkXxx </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#024--fuzzxxx" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 0.2.4 Â· FuzzXxx </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#025--examplexxx" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 0.2.5 Â· ExampleXxx </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#026--testmain" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 0.2.6 Â· TestMain </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#03--testing-flagsgo-help-testflag" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.3 Â· Testing flagsï¼ˆgo help testflagï¼‰ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#04--è¡¨é©±åŠ¨ä¸å¹¶è¡Œç¤ºä¾‹" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.4 Â· è¡¨é©±åŠ¨ä¸å¹¶è¡Œç¤ºä¾‹ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#05--pkg-for-test" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.5 Â· pkg for test </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#06--coverage--tricks--å¯æµ‹ä»£ç " class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.6 Â· coverage / tricks / å¯æµ‹ä»£ç  </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#07--å‚è€ƒé“¾æ¥" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 0.7 Â· å‚è€ƒé“¾æ¥ </a> </li> </ul> </nav> </aside> <!-- Toggle button - fixed at left edge --> <button id="toc-toggle" class="fixed left-0 top-4 p-3 rounded-r-lg bg-nord-9 dark:bg-nord-8 text-nord-6 dark:text-nord-0 hover:bg-nord-10 dark:hover:bg-nord-7 hover:text-nord-6 dark:hover:text-nord-0 transition-colors shadow-lg z-40" aria-label="Toggle sidebar" title="Toggle sidebar (â† â†’)" data-astro-cid-vrmg3htk> <svg id="toggle-icon" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-vrmg3htk> <path d="M4 6h16M4 12h16M4 18h16" data-astro-cid-vrmg3htk></path> </svg> </button> <script>
  const TOC_KEY = 'toc-open';
  const sidebar = document.getElementById('toc-sidebar');
  const toggle = document.getElementById('toc-toggle');
  const closeBtn = document.getElementById('toc-close');

  function getSidebarState() {
    return localStorage.getItem(TOC_KEY) !== 'false';
  }

  function setSidebarState(open) {
    localStorage.setItem(TOC_KEY, open ? 'true' : 'false');
  }

  function updateSidebar() {
    const isOpen = getSidebarState();
    if (sidebar) {
      if (isOpen) {
        sidebar.classList.remove('-translate-x-full');
      } else {
        sidebar.classList.add('-translate-x-full');
      }
    }
  }

  function toggleSidebar() {
    const isOpen = getSidebarState();
    setSidebarState(!isOpen);
    updateSidebar();
  }

  // Initialize
  updateSidebar();

  // Event listeners
  if (toggle) {
    toggle.addEventListener('click', toggleSidebar);
  }

  if (closeBtn) {
    closeBtn.addEventListener('click', toggleSidebar);
  }

  // Keyboard shortcut: left/right arrow to toggle
  document.addEventListener('keydown', (e) => {
    if ((e.key === 'ArrowLeft' || e.key === 'ArrowRight') && e.ctrlKey) {
      e.preventDefault();
      toggleSidebar();
    }
  });

  // Highlight current section on scroll
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          document.querySelectorAll('.toc-item a').forEach((link) => {
            link.classList.remove('text-nord-9', 'dark:text-nord-8', 'font-semibold', 'bg-nord-5', 'dark:bg-nord-1');
            link.classList.add('text-nord-3', 'dark:text-nord-4');
          });
          const activeLink = document.querySelector(
            `.toc-item a[href="#${entry.target.id}"]`
          );
          if (activeLink) {
            activeLink.classList.remove('text-nord-3', 'dark:text-nord-4');
            activeLink.classList.add('text-nord-9', 'dark:text-nord-8', 'font-semibold', 'bg-nord-5', 'dark:bg-nord-1');
          }
        }
      });
    },
    { rootMargin: '-50% 0px -50% 0px' }
  );

  document.querySelectorAll('h2, h3').forEach((heading) => {
    if (heading.id) {
      observer.observe(heading);
    }
  });

  // Close sidebar on link click
  document.querySelectorAll('.toc-item a').forEach((link) => {
    link.addEventListener('click', () => {
      setSidebarState(false);
      updateSidebar();
    });
  });
</script>  <article class="prose prose-nord dark:prose-nord max-w-none
      prose-headings:font-serif
      prose-code:before:content-none prose-code:after:content-none" data-astro-cid-v5yihett> <header class="mb-8" data-astro-cid-v5yihett> <h1 class="mb-3" data-pagefind-meta="title" data-astro-cid-v5yihett>test</h1> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4" data-astro-cid-v5yihett> <div class="text-sm text-nord-3 dark:text-nord-5" data-astro-cid-v5yihett> <div> <div class="flex flex-wrap gap-2 mb-2"> <span class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-nord-7 dark:bg-nord-7 text-nord-0 dark:text-nord-0 rounded font-medium"> <span>ğŸ“…</span> <span>2026-02-05</span> </span> <span class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-nord-8 dark:bg-nord-8 text-nord-0 dark:text-nord-0 rounded font-medium"> <span>âœï¸</span> <span>2026-02-12</span> </span>  <div class="flex flex-wrap gap-2"> <a href="/notes/tag/CS" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-blue-light dark:tag-text-blue-dark !no-underline hover:!no-underline" title="Tag: CS"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> <span>CS</span>  </a><a href="/notes/tag/GO" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-blue-light dark:tag-text-blue-dark !no-underline hover:!no-underline" title="Tag: GO"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> <span>GO</span>  </a> </div> </div> </div> </div> <div class="text-sm" data-astro-cid-v5yihett> <div> <div class="flex items-center gap-4"> <!-- Back to notes link - removed, now in footer --> <!-- Show only links and backlinks stats --> <!-- Outlinks -->  <!-- Backlinks -->  <!-- No links message --> <span class="text-nord-3 dark:text-nord-4 italic">No related notes</span> </div> <!-- Modals --> <div id="outlinks-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-nord-6 dark:bg-nord-0 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-nord-5 dark:border-nord-1"> <!-- Header --> <div class="sticky top-0 bg-nord-6 dark:bg-nord-0 border-b border-nord-5 dark:border-nord-1 px-6 py-4 flex items-center justify-between"> <h2 class="text-lg font-semibold text-nord-2 dark:text-nord-6"> Outlinks <span class="text-sm font-normal text-nord-3 dark:text-nord-5 ml-2">
(0)
</span> </h2> <button class="close-modal p-1 text-nord-3 dark:text-nord-4 hover:bg-nord-5 dark:hover:bg-nord-1 hover:text-nord-2 dark:hover:text-nord-5 rounded transition-colors" aria-label="Close modal"> <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M18 6L6 18M6 6l12 12"></path> </svg> </button> </div> <!-- Content --> <div class="p-6"> <p class="text-nord-3 dark:text-nord-5 text-center py-8">
No outlinks found
</p> </div> </div> </div> <script>(function(){const modalId = "outlinks-modal";
const type = "outlinks";

  const modal = document.getElementById(modalId);
  const closeButtons = modal ? modal.querySelectorAll('.close-modal') : [];

  // Create camelCase function name: "backlinks" -> "openBacklinksModal"
  const functionName = `open${type.charAt(0).toUpperCase() + type.slice(1)}Modal`;

  // Open modal
  window[functionName] = function() {
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  };

  // Close modal
  function closeModal() {
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  }

  // Close button listeners
  closeButtons.forEach((btn) => {
    btn.addEventListener('click', closeModal);
  });

  // Close on background click
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
})();</script> <div id="backlinks-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-nord-6 dark:bg-nord-0 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-nord-5 dark:border-nord-1"> <!-- Header --> <div class="sticky top-0 bg-nord-6 dark:bg-nord-0 border-b border-nord-5 dark:border-nord-1 px-6 py-4 flex items-center justify-between"> <h2 class="text-lg font-semibold text-nord-2 dark:text-nord-6"> Backlinks <span class="text-sm font-normal text-nord-3 dark:text-nord-5 ml-2">
(0)
</span> </h2> <button class="close-modal p-1 text-nord-3 dark:text-nord-4 hover:bg-nord-5 dark:hover:bg-nord-1 hover:text-nord-2 dark:hover:text-nord-5 rounded transition-colors" aria-label="Close modal"> <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M18 6L6 18M6 6l12 12"></path> </svg> </button> </div> <!-- Content --> <div class="p-6"> <p class="text-nord-3 dark:text-nord-5 text-center py-8">
No backlinks found
</p> </div> </div> </div> <script>(function(){const modalId = "backlinks-modal";
const type = "backlinks";

  const modal = document.getElementById(modalId);
  const closeButtons = modal ? modal.querySelectorAll('.close-modal') : [];

  // Create camelCase function name: "backlinks" -> "openBacklinksModal"
  const functionName = `open${type.charAt(0).toUpperCase() + type.slice(1)}Modal`;

  // Open modal
  window[functionName] = function() {
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  };

  // Close modal
  function closeModal() {
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  }

  // Close button listeners
  closeButtons.forEach((btn) => {
    btn.addEventListener('click', closeModal);
  });

  // Close on background click
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
})();</script> <script>
  // Outlinks button - calls window.openOutlinksModal()
  document.querySelectorAll('.open-outlinks-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      if (window.openOutlinksModal) {
        window.openOutlinksModal();
      }
    });
  });

  // Backlinks button - calls window.openBacklinksModal()
  document.querySelectorAll('.open-backlinks-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      if (window.openBacklinksModal) {
        window.openBacklinksModal();
      }
    });
  });
</script> </div> </div> </div> </header>    <h2 id="01--go-test-å‘½ä»¤go-help-test">0.1 Â· go test å‘½ä»¤ï¼ˆgo help testï¼‰</h2>
<p><strong>ç”¨æ³•</strong>ï¼š<code>go test [build/test flags] [packages] [flags &#x26; test binary flags]</code></p>
<ul>
<li>å¯¹æŒ‡å®šåŒ…åšè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè¾“å‡ºæ¯åŒ…æ‘˜è¦ï¼ˆ<code>ok</code>/<code>FAIL</code> + è€—æ—¶ï¼‰ï¼Œå¤±è´¥æ—¶å†æ‰“è¯¦ç»†è¾“å‡ºã€‚</li>
<li>ä¼šç¼–è¯‘ <code>*_test.go</code>ï¼›ä»¥ <code>_</code> æˆ– <code>.</code> å¼€å¤´çš„æ–‡ä»¶è¢«å¿½ç•¥ã€‚<code>testdata</code> ç›®å½•è¢«å¿½ç•¥ï¼Œå¯æ”¾æµ‹è¯•æ•°æ®ã€‚</li>
<li>æ„å»ºå‰ä¼šè·‘ <strong>go vet</strong> å­é›†ï¼ˆatomicã€boolã€printfã€tests ç­‰ï¼‰ï¼Œæœ‰é—®é¢˜åˆ™ä¸è¿è¡Œæµ‹è¯•ã€‚<code>-vet=off</code> å…³é—­ï¼Œ<code>-vet=all</code> å…¨å¼€ã€‚</li>
<li>æµ‹è¯•çš„ stdout/stderr ä¼šæ±‡æ€»åˆ° <code>go test</code> çš„ stdoutã€‚</li>
</ul>
<p><strong>ä¸¤ç§æ¨¡å¼</strong>ï¼š</p>




















<table><thead><tr><th>æ¨¡å¼</th><th>è§¦å‘</th><th>ç¼“å­˜</th></tr></thead><tbody><tr><td>æœ¬åœ°ç›®å½•</td><td>æ— åŒ…å‚æ•°ï¼ˆ<code>go test</code> / <code>go test -v</code>ï¼‰</td><td>å¦</td></tr><tr><td>åŒ…åˆ—è¡¨</td><td>æ˜¾å¼åŒ…ï¼ˆ<code>go test .</code> / <code>./...</code> / <code>math</code>ï¼‰</td><td>æ˜¯</td></tr></tbody></table>
<p><strong>ç¼“å­˜</strong>ï¼šä»…å½“ä»…ç”¨å¯ç¼“å­˜æ ‡å¿—æ—¶ç”Ÿæ•ˆï¼ˆå¦‚ <code>-run</code>ã€<code>-bench</code>ã€<code>-v</code>ã€<code>-count</code>ã€<code>-timeout</code> ç­‰ï¼‰ã€‚ç¦ç”¨ç¼“å­˜å¸¸ç”¨ <code>-count=1</code>ã€‚</p>
<p><strong>go test è‡ªæœ‰æ ‡å¿—</strong>ï¼š<code>-c</code> åªç¼–è¯‘ä¸è¿è¡Œï¼›<code>-o file</code> æŒ‡å®šäºŒè¿›åˆ¶è·¯å¾„ï¼›<code>-args</code> åå‚æ•°åŸæ ·ä¼ æµ‹è¯•äºŒè¿›åˆ¶ï¼ˆåŒ…åˆ—è¡¨é¡»åœ¨ <code>-args</code> å‰ï¼‰ï¼›<code>-json</code> è¾“å‡º JSONï¼›<code>-exec xprog</code> ç”¨ xprog è·‘äºŒè¿›åˆ¶ã€‚</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> test</span><span style="color:#A3BE8C"> -v</span><span style="color:#A3BE8C"> -args</span><span style="color:#A3BE8C"> -x</span><span style="color:#A3BE8C"> -v</span><span style="color:#616E88">          # -args ååŸæ ·ä¼ æµ‹è¯•äºŒè¿›åˆ¶</span></span>
<span class="line"><span style="color:#88C0D0">pkg.test</span><span style="color:#A3BE8C"> -test.v</span><span style="color:#A3BE8C"> -test.cpuprofile=prof.out</span><span style="color:#616E88">   # ç›´æ¥è·‘äºŒè¿›åˆ¶æ—¶ç”¨ test. å‰ç¼€</span></span></code></pre>
<hr>
<h2 id="02--testing-åŒ…go-doc-testing">0.2 Â· testing åŒ…ï¼ˆgo doc testingï¼‰</h2>
<h3 id="021--å››ç§å‡½æ•°å½¢å¼">0.2.1 Â· å››ç§å‡½æ•°å½¢å¼</h3>

























<table><thead><tr><th>å½¢å¼</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>func TestXxx(*testing.T)</code></td><td>å•å…ƒæµ‹è¯•ï¼Œç”¨ <code>t.Error</code>/<code>t.Fail</code> æŠ¥å‘Šå¤±è´¥</td></tr><tr><td><code>func BenchmarkXxx(*testing.B)</code></td><td>åŸºå‡†ï¼Œæä¾› <code>-bench</code> æ—¶é¡ºåºæ‰§è¡Œ</td></tr><tr><td><code>func FuzzXxx(*testing.F)</code></td><td>æ¨¡ç³Šæµ‹è¯•ï¼Œéšæœº/å˜å¼‚è¾“å…¥</td></tr><tr><td><code>func ExampleXxx()</code></td><td>ç¤ºä¾‹ï¼Œç”¨ stdout + <code>// Output:</code> æ ¡éªŒ</td></tr></tbody></table>
<ul>
<li>æµ‹è¯•æ–‡ä»¶ï¼š<code>*_test.go</code>ï¼Œæ™®é€š build ä¸åŒ…å«ã€‚<strong>åŒåŒ…</strong>å¯è®¿é—®æœªå¯¼å‡ºç¬¦å·ï¼›<strong><code>package pkg_test</code></strong> ä¸ºé»‘ç›’ï¼Œåªèƒ½è®¿é—®å¯¼å‡ºç¬¦å·ã€‚</li>
<li>æ›´å¤šï¼š<code>go help test</code>ã€<code>go help testflag</code>ã€‚</li>
</ul>
<h3 id="022--testxxx">0.2.2 Â· TestXxx</h3>
<ul>
<li><strong>è·³è¿‡</strong>ï¼š<code>t.Skip()</code>ï¼›ä¾‹ <code>if testing.Short() { t.Skip("...") }</code>ï¼Œé…åˆ <code>go test -short</code>ã€‚</li>
</ul>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> TestTimeConsuming</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">    if</span><span style="color:#D8DEE9"> testing</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Short</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">        t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Skip</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">short æ¨¡å¼ä¸‹è·³è¿‡</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">    }</span></span>
<span class="line"><span style="color:#616E88">    // ...</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<ul>
<li><strong>å­æµ‹è¯•</strong>ï¼š<a href="https://go.dev/blog/subtests">Subtests</a> â€” <code>t.Run(name, func(t *testing.T) { ... })</code>ï¼Œå¯è¡¨é©±åŠ¨ã€å…±ç”¨ setup/tear-downã€‚åå­—ä¸ºã€Œé¡¶å±‚/å­åã€å±‚çº§ã€‚</li>
</ul>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> TestFoo</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#616E88">    // &#x3C;setup code></span></span>
<span class="line"><span style="color:#D8DEE9">    t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">A=1</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span><span style="color:#81A1C1"> ...</span><span style="color:#ECEFF4"> })</span></span>
<span class="line"><span style="color:#D8DEE9">    t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">A=2</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span><span style="color:#81A1C1"> ...</span><span style="color:#ECEFF4"> })</span></span>
<span class="line"><span style="color:#D8DEE9">    t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">B=1</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span><span style="color:#81A1C1"> ...</span><span style="color:#ECEFF4"> })</span></span>
<span class="line"><span style="color:#616E88">    // &#x3C;tear-down code></span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> test</span><span style="color:#A3BE8C"> -run</span><span style="color:#A3BE8C"> Foo/A=</span><span style="color:#616E88">    # é¡¶å±‚åŒ¹é… Fooï¼Œå­æµ‹è¯•åŒ¹é… A=</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> test</span><span style="color:#A3BE8C"> -run</span><span style="color:#A3BE8C"> /A=</span><span style="color:#B48EAD">1</span><span style="color:#616E88">      # æ‰€æœ‰é¡¶å±‚çš„å­æµ‹è¯•åŒ¹é… A=1</span></span></code></pre>
<ul>
<li><strong>-run</strong>ï¼šæœªé”šå®šæ­£åˆ™ï¼ŒæŒ‰ <code>/</code> åˆ†å±‚ï¼›<code>go test -run=FuzzFoo/ç§å­id</code> å¯è°ƒè¯•ç§å­ã€‚</li>
<li><strong>å¹¶è¡Œ</strong>ï¼šå­æµ‹è¯•é‡Œ <code>t.Parallel()</code>ï¼›çˆ¶æµ‹è¯•ç­‰æ‰€æœ‰å­æµ‹è¯•å®Œæˆã€‚å¯ç”¨ <code>t.Run("group", ...)</code> å†åœ¨å¤–éƒ¨åš tear-downã€‚</li>
</ul>
<h3 id="023--benchmarkxxx">0.2.3 Â· BenchmarkXxx</h3>
<ul>
<li>æ–°å†™æ³•ç”¨ <code>b.Loop()</code> åŒ…ä½è¢«æµ‹ä»£ç ï¼›æ—§å†™æ³• <code>for i := 0; i &#x3C; b.N; i++</code>ï¼Œæ˜‚è´µåˆå§‹åŒ–å‰è°ƒ <code>b.ResetTimer()</code>ã€‚</li>
<li>å¹¶è¡Œï¼š<code>b.RunParallel(func(pb *testing.PB) { for pb.Next() { ... } })</code>ï¼Œå¸¸é… <code>-cpu</code>ã€‚</li>
<li>å­åŸºå‡†ï¼š<code>b.Run(name, func(b *testing.B) { ... })</code>ã€‚</li>
</ul>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> BenchmarkRandInt</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">b</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">B</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">    for</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> :=</span><span style="color:#B48EAD"> 0</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> &#x3C;</span><span style="color:#D8DEE9"> b</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">N</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1">++</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> rand</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Int</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> }</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"><span style="color:#616E88">// è¾“å‡º BenchmarkRandInt-8  68453040  17.8 ns/op è¡¨ç¤ºå¾ªç¯ 68453040 æ¬¡ï¼Œçº¦ 17.8 ns/op</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> BenchmarkBigLen</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">b</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">B</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">    big</span><span style="color:#81A1C1"> :=</span><span style="color:#88C0D0"> NewBig</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#D8DEE9">    b</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">ResetTimer</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#81A1C1">    for</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> :=</span><span style="color:#B48EAD"> 0</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> &#x3C;</span><span style="color:#D8DEE9"> b</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">N</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1">++</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> big</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Len</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> }</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<p><strong>å¹¶è¡ŒåŸºå‡†</strong>ï¼ˆå¸¸é… <code>-cpu</code>ï¼‰ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> BenchmarkTemplateParallel</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">b</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">B</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">    templ</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> template</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Must</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">template</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">New</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">test</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">).</span><span style="color:#88C0D0">Parse</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">Hello, {{.}}!</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">))</span></span>
<span class="line"><span style="color:#D8DEE9">    b</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">RunParallel</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">pb</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">PB</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">        var</span><span style="color:#D8DEE9"> buf</span><span style="color:#D8DEE9FF"> bytes</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">Buffer</span></span>
<span class="line"><span style="color:#81A1C1">        for</span><span style="color:#D8DEE9"> pb</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Next</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">            buf</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Reset</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#D8DEE9">            templ</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Execute</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">&#x26;</span><span style="color:#D8DEE9">buf</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">World</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">        }</span></span>
<span class="line"><span style="color:#ECEFF4">    })</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<p><strong>å­åŸºå‡†</strong>ï¼ˆ<a href="https://go.dev/blog/subtests">Sub-benchmarks</a>ï¼‰ï¼š<code>b.Run(name, func(b *testing.B) { for i := 0; i &#x3C; b.N; i++ { ... } })</code>ï¼Œå¤šç»„å‚æ•°å¯å†™è¡¨é©±åŠ¨ã€‚</p>
<ul>
<li>è§„èŒƒä¸å·¥å…·ï¼š<a href="https://go.googlesource.com/proposal/+/master/design/14313-benchmark-format.md">Go Benchmark Data Format</a>ã€<a href="https://pkg.go.dev/golang.org/x/perf/cmd">golang.org/x/perf/cmd</a>ï¼ˆå¦‚ benchstatï¼‰ã€‚</li>
</ul>
<h3 id="024--fuzzxxx">0.2.4 Â· FuzzXxx</h3>
<p><a href="https://en.wikipedia.org/wiki/Fuzzing">æ¨¡ç³Šæµ‹è¯•</a>ï¼šéšæœº/å˜å¼‚è¾“å…¥æ‰¾ bugã€‚ç§å­ï¼š<code>(*F).Add</code> æˆ– <code>testdata/fuzz/&#x3C;Name></code>ï¼›target å‚æ•°ç±»å‹ä¸ <code>Add</code> ä¸€è‡´ã€‚æ— æ•ˆè¾“å…¥å¯ <code>t.Skip()</code>ã€‚å¤±è´¥è¾“å…¥ä¼šå†™å› <code>testdata/fuzz/&#x3C;Name></code>ã€‚</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> FuzzHex</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">f</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">F</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">    for</span><span style="color:#D8DEE9"> _</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> seed</span><span style="color:#81A1C1"> :=</span><span style="color:#81A1C1"> range</span><span style="color:#ECEFF4"> [][]</span><span style="color:#81A1C1">byte</span><span style="color:#ECEFF4">{{},</span><span style="color:#ECEFF4"> {</span><span style="color:#B48EAD">0</span><span style="color:#ECEFF4">},</span><span style="color:#ECEFF4"> {</span><span style="color:#B48EAD">9</span><span style="color:#ECEFF4">},</span><span style="color:#ECEFF4"> {</span><span style="color:#81A1C1">0x</span><span style="color:#B48EAD">a</span><span style="color:#ECEFF4">},</span><span style="color:#ECEFF4"> {</span><span style="color:#81A1C1">0x</span><span style="color:#B48EAD">f</span><span style="color:#ECEFF4">},</span><span style="color:#ECEFF4"> {</span><span style="color:#B48EAD">1</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 2</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 3</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 4</span><span style="color:#ECEFF4">}}</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> f</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Add</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">seed</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> }</span></span>
<span class="line"><span style="color:#D8DEE9">    f</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Fuzz</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> in</span><span style="color:#ECEFF4"> []</span><span style="color:#81A1C1">byte</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">        enc</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> hex</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">EncodeToString</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">in</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#D8DEE9">        out</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> err</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> hex</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">DecodeString</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">enc</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#81A1C1">        if</span><span style="color:#D8DEE9"> err</span><span style="color:#81A1C1"> !=</span><span style="color:#81A1C1"> nil</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Fatalf</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#EBCB8B">%v</span><span style="color:#A3BE8C">: decode: </span><span style="color:#EBCB8B">%v</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> in</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> err</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> }</span></span>
<span class="line"><span style="color:#81A1C1">        if</span><span style="color:#81A1C1"> !</span><span style="color:#D8DEE9">bytes</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Equal</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">in</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> out</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Fatalf</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#EBCB8B">%v</span><span style="color:#A3BE8C">: round trip</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> in</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> out</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> }</span></span>
<span class="line"><span style="color:#ECEFF4">    })</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<ul>
<li><code>Add</code> æ”¯æŒï¼šstring, []byte, æ•´æ•°/æµ®ç‚¹/boolï¼ŒåŠ BinaryMarshaler/TextMarshalerã€‚</li>
<li>æ–‡æ¡£ï¼š<a href="https://go.dev/doc/fuzz">go.dev/doc/fuzz</a>ã€<a href="https://go.googlesource.com/proposal/+/master/design/draft-fuzzing.md">draft-fuzzing</a>ã€<a href="https://towardsdatascience.com/fuzzing-tests-in-go-96eb08b7694d">Fuzzing in Go</a>ã€‚<a href="https://www.cnblogs.com/kevinwan/p/16016866.html">æœ€ä½³å®è·µ</a>ã€‚</li>
</ul>
<h3 id="025--examplexxx">0.2.5 Â· ExampleXxx</h3>
<ul>
<li>ç”¨ <code>// Output:</code> æˆ– <code>// Unordered output:</code> ä¸ stdout æ¯”è¾ƒï¼ˆå¿½ç•¥é¦–å°¾ç©ºç™½ï¼‰ã€‚æ— æ³¨é‡Šåˆ™åªç¼–è¯‘ä¸æ‰§è¡Œã€‚</li>
<li>å‘½åï¼š<code>Example</code>ã€<code>ExampleF</code>ã€<code>ExampleT</code>ã€<code>ExampleT_M</code>ï¼›å¤šç¤ºä¾‹åŠ åç¼€å¦‚ <code>Example_suffix</code>ã€‚</li>
</ul>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> ExamplePrintln</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">    Println</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">The output of</span><span style="color:#EBCB8B">\n</span><span style="color:#A3BE8C">this example.</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#616E88">    // Output: The output of</span></span>
<span class="line"><span style="color:#616E88">    // this example.</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> ExamplePerm</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">    for</span><span style="color:#D8DEE9"> _</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> v</span><span style="color:#81A1C1"> :=</span><span style="color:#81A1C1"> range</span><span style="color:#88C0D0"> Perm</span><span style="color:#ECEFF4">(</span><span style="color:#B48EAD">4</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span><span style="color:#D8DEE9"> fmt</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Println</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">v</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> }</span></span>
<span class="line"><span style="color:#616E88">    // Unordered output: 4</span></span>
<span class="line"><span style="color:#616E88">    // 2</span></span>
<span class="line"><span style="color:#616E88">    // 1</span></span>
<span class="line"><span style="color:#616E88">    // 3</span></span>
<span class="line"><span style="color:#616E88">    // 0</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<h3 id="026--testmain">0.2.6 Â· TestMain</h3>
<p>è‹¥å®šä¹‰ <code>func TestMain(m *testing.M)</code>ï¼Œç”Ÿæˆçš„ main è°ƒç”¨å®ƒè€Œéç›´æ¥è·‘æµ‹è¯•ï¼›åœ¨ main goroutine é‡Œ setup/tear-down å¹¶ <code>m.Run()</code>ã€‚ç”¨æ ‡å¿—æ—¶éœ€åœ¨ TestMain é‡Œ <code>flag.Parse()</code>ã€‚</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> TestMain</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">m</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">M</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#616E88">    // flag.Parse() è‹¥ä¾èµ–å‘½ä»¤è¡Œæ ‡å¿—</span></span>
<span class="line"><span style="color:#D8DEE9">    os</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Exit</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">m</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">())</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<hr>
<h2 id="03--testing-flagsgo-help-testflag">0.3 Â· Testing flagsï¼ˆgo help testflagï¼‰</h2>
<p>å‚è€ƒï¼š<a href="https://pkg.go.dev/cmd/go#hdr-Testing_flags">Testing flags</a></p>





























































<table><thead><tr><th>æ ‡å¿—</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>-run regexp</code></td><td>åªè¿è¡ŒåŒ¹é…çš„æµ‹è¯•</td></tr><tr><td><code>-bench regexp</code></td><td>è¿è¡ŒåŒ¹é…çš„åŸºå‡†ï¼›é»˜è®¤ä¸è·‘ï¼Œ<code>-bench .</code> è·‘å…¨éƒ¨</td></tr><tr><td><code>-benchtime t</code></td><td>åŸºå‡†æ—¶é•¿ï¼Œé»˜è®¤ 1sï¼›<code>Nx</code> ä¸º N æ¬¡</td></tr><tr><td><code>-fuzz regexp</code> / <code>-fuzztime t</code></td><td>æ¨¡ç³Šæµ‹è¯•åŠæ—¶é•¿</td></tr><tr><td><code>-cpu 1,2,4</code></td><td>GOMAXPROCS ç»„åˆ</td></tr><tr><td><code>-count n</code></td><td>æ‰§è¡Œæ¬¡æ•°</td></tr><tr><td><code>-parallel n</code></td><td><code>t.Parallel()</code> çš„æœ€å¤§å¹¶å‘æ•°</td></tr><tr><td><code>-timeout d</code></td><td>è¶…æ—¶ panicï¼Œ0 ç¦ç”¨</td></tr><tr><td><code>-v</code></td><td>è¯¦ç»†è¾“å‡º</td></tr><tr><td><code>-short</code></td><td>å¯é…åˆ <code>testing.Short()</code> è·³è¿‡è€—æ—¶æµ‹è¯•</td></tr><tr><td><code>-cover</code> / <code>-covermode</code> / <code>-coverpkg</code></td><td>è¦†ç›–ç‡</td></tr><tr><td><code>-benchmem</code></td><td>åŸºå‡†å†…å­˜åˆ†é…</td></tr><tr><td><code>-cpuprofile</code> / <code>-memprofile</code></td><td>å†™å‡º profile ç»™ <code>go tool pprof</code></td></tr></tbody></table>
<p>å¯¹ test äºŒè¿›åˆ¶å¯ç”¨ <code>test.</code> å‰ç¼€ï¼Œå¦‚ <code>pkg.test -test.v -test.cpuprofile=out</code>ã€‚</p>
<hr>
<h2 id="04--è¡¨é©±åŠ¨ä¸å¹¶è¡Œç¤ºä¾‹">0.4 Â· è¡¨é©±åŠ¨ä¸å¹¶è¡Œç¤ºä¾‹</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#616E88">// è¡¨é©±åŠ¨ï¼šæ¯è¡Œè¾“å…¥+é¢„æœŸï¼Œå¯å¸¦ name</span></span>
<span class="line"><span style="color:#D8DEE9">tests</span><span style="color:#81A1C1"> :=</span><span style="color:#ECEFF4"> []</span><span style="color:#81A1C1">struct</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">    input</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> sep</span><span style="color:#81A1C1"> string</span></span>
<span class="line"><span style="color:#D8DEE9">    want</span><span style="color:#ECEFF4">       []</span><span style="color:#81A1C1">string</span></span>
<span class="line"><span style="color:#ECEFF4">}{</span></span>
<span class="line"><span style="color:#ECEFF4">    {</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">a/b/c</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">/</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> []</span><span style="color:#81A1C1">string</span><span style="color:#ECEFF4">{</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">a</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">b</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">c</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">}},</span></span>
<span class="line"><span style="color:#ECEFF4">    {</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">abc</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">/</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> []</span><span style="color:#81A1C1">string</span><span style="color:#ECEFF4">{</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">abc</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">}},</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"><span style="color:#81A1C1">for</span><span style="color:#D8DEE9"> _</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tc</span><span style="color:#81A1C1"> :=</span><span style="color:#81A1C1"> range</span><span style="color:#D8DEE9"> tests</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">    t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">tc</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">input</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">        got</span><span style="color:#81A1C1"> :=</span><span style="color:#88C0D0"> Split</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">tc</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">input</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tc</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">sep</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#81A1C1">        if</span><span style="color:#81A1C1"> !</span><span style="color:#D8DEE9">reflect</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">DeepEqual</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">tc</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">want</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> got</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">            t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Fatalf</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">expected: </span><span style="color:#EBCB8B">%v</span><span style="color:#A3BE8C">, got: </span><span style="color:#EBCB8B">%v</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tc</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">want</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> got</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">        }</span></span>
<span class="line"><span style="color:#ECEFF4">    })</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88">// å¹¶è¡Œå­æµ‹è¯•ï¼ˆæ³¨æ„ tc := tc é¿å…é—­åŒ…æ•è·ï¼‰</span></span>
<span class="line"><span style="color:#81A1C1">for</span><span style="color:#D8DEE9"> _</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tc</span><span style="color:#81A1C1"> :=</span><span style="color:#81A1C1"> range</span><span style="color:#D8DEE9"> tests</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">    tc</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> tc</span></span>
<span class="line"><span style="color:#D8DEE9">    t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">tc</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">Name</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">        t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Parallel</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#616E88">        // ...</span></span>
<span class="line"><span style="color:#ECEFF4">    })</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<hr>
<h2 id="05--pkg-for-test">0.5 Â· pkg for test</h2>
<ul>
<li><strong>æ–­è¨€</strong>ï¼š<a href="https://github.com/stretchr/testify">stretchr/testify</a>ï¼ˆassertã€requireï¼‰</li>
<li><strong>HTTP</strong>ï¼š<a href="https://pkg.go.dev/net/http/httptest">net/http/httptest</a>ï¼›å¤–éƒ¨ API mockï¼š<a href="https://github.com/h2non/gock">h2non/gock</a>ã€<a href="https://github.com/jarcoal/httpmock">jarcoal/httpmock</a></li>
<li><strong>DB</strong>ï¼š<a href="https://github.com/DATA-DOG/go-sqlmock">DATA-DOG/go-sqlmock</a>ï¼›Redisï¼š<a href="https://github.com/alicebob/miniredis">alicebob/miniredis</a></li>
<li><strong>Mock/Stub</strong>ï¼šMock=æ¥å£æ›¿æ¢ï¼ŒStub=å‡½æ•°/å ä½ã€‚<a href="https://stackoverflow.com/questions/3459287/whats-the-difference-between-a-mock-stub">åŒºåˆ«</a>ã€<a href="https://www.martinfowler.com/articles/mocksArentStubs.html">Mocks Arenâ€™t Stubs</a>ã€‚<a href="https://github.com/golang/mock">golang/mock</a>ã€<a href="https://github.com/prashantv/gostub">prashantv/gostub</a>ï¼›<a href="https://github.com/bouk/monkey">bouk/monkey</a>ï¼ˆéœ€ <code>-gcflags=-l</code>ï¼Œéçº¿ç¨‹å®‰å…¨ï¼‰ã€<a href="https://github.com/agiledragon/gomonkey">agiledragon/gomonkey</a></li>
<li><strong>BDD</strong>ï¼š<a href="https://github.com/smartystreets/goconvey">goconvey</a>ï¼ˆConvey/Soã€SkipConveyã€FocusConveyï¼‰ã€<a href="https://github.com/smartystreets/goconvey/wiki/Assertions">Assertions</a></li>
</ul>
<p><strong>HTTP æµ‹è¯•ç¤ºä¾‹</strong>ï¼ˆhttptest + è¡¨é©±åŠ¨ï¼‰ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> Test_helloHandler</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">    tests</span><span style="color:#81A1C1"> :=</span><span style="color:#ECEFF4"> []</span><span style="color:#81A1C1">struct</span><span style="color:#ECEFF4">{</span><span style="color:#D8DEE9"> name</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> param</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> expect</span><span style="color:#81A1C1"> string</span><span style="color:#ECEFF4"> }{</span></span>
<span class="line"><span style="color:#ECEFF4">        {</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">base</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> `</span><span style="color:#A3BE8C">{"name":"liwenzhou"}</span><span style="color:#ECEFF4">`</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">hello liwenzhou</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">},</span></span>
<span class="line"><span style="color:#ECEFF4">        {</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">bad</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> ""</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">we need a name</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">},</span></span>
<span class="line"><span style="color:#ECEFF4">    }</span></span>
<span class="line"><span style="color:#D8DEE9">    r</span><span style="color:#81A1C1"> :=</span><span style="color:#88C0D0"> SetupRouter</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#81A1C1">    for</span><span style="color:#D8DEE9"> _</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tt</span><span style="color:#81A1C1"> :=</span><span style="color:#81A1C1"> range</span><span style="color:#D8DEE9"> tests</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">        t</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Run</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">tt</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">name</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">testing</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">T</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">            req</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> httptest</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">NewRequest</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">POST</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">/hello</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> strings</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">NewReader</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">tt</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">param</span><span style="color:#ECEFF4">))</span></span>
<span class="line"><span style="color:#D8DEE9">            w</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> httptest</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">NewRecorder</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#D8DEE9">            r</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">ServeHTTP</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">w</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> req</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#D8DEE9">            assert</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Equal</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> http</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">StatusOK</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> w</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">Code</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#81A1C1">            var</span><span style="color:#D8DEE9"> resp</span><span style="color:#81A1C1"> map</span><span style="color:#ECEFF4">[</span><span style="color:#81A1C1">string</span><span style="color:#ECEFF4">]</span><span style="color:#81A1C1">string</span></span>
<span class="line"><span style="color:#D8DEE9">            json</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Unmarshal</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">w</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">Body</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Bytes</span><span style="color:#ECEFF4">(),</span><span style="color:#81A1C1"> &#x26;</span><span style="color:#D8DEE9">resp</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#D8DEE9">            assert</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Equal</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">t</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> tt</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">expect</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> resp</span><span style="color:#ECEFF4">[</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">msg</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">])</span></span>
<span class="line"><span style="color:#ECEFF4">        })</span></span>
<span class="line"><span style="color:#ECEFF4">    }</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<hr>
<h2 id="06--coverage--tricks--å¯æµ‹ä»£ç ">0.6 Â· coverage / tricks / å¯æµ‹ä»£ç </h2>
<ul>
<li><strong>è¦†ç›–ç‡</strong>ï¼š<code>go test -cover</code>ï¼›å¸¸è§è¦æ±‚çº¦ 80%ã€‚</li>
<li><strong>æŠ€å·§</strong>ï¼šinline æ¥å£ï¼ˆcaller å®šä¹‰æ¥å£å¹¶æ³¨å…¥ï¼Œä¾¿äº mockï¼‰ï¼›è¾…åŠ©æ–­è¨€ï¼ˆassert/ok/equalsï¼‰è§ <a href="https://github.com/benbjohnson/testing">benbjohnson/testing</a>ã€<a href="https://zhuanlan.zhihu.com/p/335484135">Go æµ‹è¯•æŠ€å·§</a>ã€<a href="https://povilasv.me/go-advanced-testing-tips-tricks/">povilasv</a>ã€‚</li>
<li><strong>é›†æˆæµ‹è¯•</strong>ï¼š<a href="https://www.ardanlabs.com/blog/2019/03/integration-testing-in-go-executing-tests-with-docker.">Integration testing with Docker</a></li>
<li><strong>å¯æµ‹è®¾è®¡</strong>ï¼šæ¥å£æŠ½è±¡ + ä¾èµ–æ³¨å…¥ï¼ˆå¦‚ <a href="https://github.com/google/wire">google/wire</a>ï¼‰ï¼›SOLIDã€‚<a href="https://dave.cheney.net/2019/04/03/absolute-unit-test">Absolute unit test</a>ã€<a href="https://quii.gitbook.io/learn-go-with-tests/">Learn Go with Tests</a>ã€<a href="https://github.com/golang/go/wiki/TestComments">TestComments</a>ã€‚</li>
</ul>
<hr>
<h2 id="07--å‚è€ƒé“¾æ¥">0.7 Â· å‚è€ƒé“¾æ¥</h2>





































<table><thead><tr><th>ç±»åˆ«</th><th>é“¾æ¥</th></tr></thead><tbody><tr><td>å®˜æ–¹</td><td><a href="https://pkg.go.dev/cmd/go#hdr-Testing_flags">Testing flags</a>ã€<a href="https://go.dev/doc/fuzz">go.dev/doc/fuzz</a>ã€<a href="https://go.dev/doc/cmd/go#test">go help test</a>ã€<a href="https://pkg.go.dev/cmd/go/internal/test2json">test2json</a>ï¼ˆ-json ç¼–ç ï¼‰</td></tr><tr><td>å­æµ‹è¯•/å­åŸºå‡†</td><td><a href="https://go.dev/blog/subtests">Subtests</a>ã€<a href="https://go.dev/blog/subtests">Sub-benchmarks</a></td></tr><tr><td>Benchmark</td><td><a href="https://go.googlesource.com/proposal/+/master/design/14313-benchmark-format.md">design/14313-benchmark-format</a>ã€<a href="https://pkg.go.dev/golang.org/x/perf/cmd">golang.org/x/perf/cmd</a></td></tr><tr><td>Fuzz</td><td><a href="https://en.wikipedia.org/wiki/Fuzzing">Fuzzing (wiki)</a>ã€<a href="https://go.googlesource.com/proposal/+/master/design/draft-fuzzing.md">draft-fuzzing</a>ã€<a href="https://towardsdatascience.com/fuzzing-tests-in-go-96eb08b7694d">Fuzzing in Go</a>ã€<a href="https://www.cnblogs.com/kevinwan/p/16016866.html">æœ€ä½³å®è·µ</a></td></tr><tr><td>Mock/Stub</td><td><a href="https://stackoverflow.com/questions/3459287/whats-the-difference-between-a-mock-stub">mock vs stub (SO)</a>ã€<a href="https://www.martinfowler.com/articles/mocksArentStubs.html">Mocks Arenâ€™t Stubs</a></td></tr><tr><td>åº“</td><td><a href="https://github.com/stretchr/testify">testify</a>ã€<a href="https://pkg.go.dev/net/http/httptest">httptest</a>ã€<a href="https://github.com/h2non/gock">gock</a>ã€<a href="https://github.com/jarcoal/httpmock">httpmock</a>ã€<a href="https://github.com/DATA-DOG/go-sqlmock">go-sqlmock</a>ã€<a href="https://github.com/alicebob/miniredis">miniredis</a>ã€<a href="https://github.com/golang/mock">gomock</a>ã€<a href="https://github.com/prashantv/gostub">gostub</a>ã€<a href="https://github.com/bouk/monkey">monkey</a>ã€<a href="https://github.com/agiledragon/gomonkey">gomonkey</a>ã€<a href="https://github.com/smartystreets/goconvey">goconvey</a>ã€<a href="https://github.com/smartystreets/goconvey/wiki/Assertions">Assertions</a></td></tr><tr><td>æŠ€å·§ä¸å¯æµ‹æ€§</td><td><a href="https://github.com/benbjohnson/testing">benbjohnson/testing</a>ã€<a href="https://zhuanlan.zhihu.com/p/335484135">Go æµ‹è¯•æŠ€å·§</a>ã€<a href="https://povilasv.me/go-advanced-testing-tips-tricks/">povilasv</a>ã€<a href="https://github.com/google/wire">wire</a>ã€<a href="https://dave.cheney.net/2019/04/03/absolute-unit-test">Absolute unit test</a>ã€<a href="https://quii.gitbook.io/learn-go-with-tests/">Learn Go with Tests</a>ã€<a href="https://github.com/golang/go/wiki/TestComments">TestComments</a>ã€<a href="https://www.ardanlabs.com/blog/2019/03/integration-testing-in-go-executing-tests-with-docker.">Integration testing with Docker</a></td></tr></tbody></table> <!-- Diagrams rendered at build time -->  </article> <nav class="mt-12 pt-8 border-t border-nord-4 dark:border-nord-1" data-astro-cid-v5yihett> <a href="/notes" class="btn-primary" data-astro-cid-v5yihett> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-v5yihett> <path d="M15 19l-7-7 7-7" data-astro-cid-v5yihett></path> </svg>
Back to Notes
</a> </nav>  </main> <footer class="border-t border-nord-5 dark:border-nord-1 mt-12"> <div class="max-w-4xl mx-auto px-4 py-6 text-sm text-nord-3 dark:text-nord-4 text-center"> <p>&copy; 2026. All rights reserved.</p> </div> </footer> <script type="module" src="/_astro/Base.astro_astro_type_script_index_0_lang.WDMQca9J.js"></script> <script>
      (function() {
        const root = document.getElementById('series-dropdown-root');
        const trigger = document.getElementById('series-dropdown-trigger');
        const panel = document.getElementById('series-dropdown-panel');
        const listEl = document.getElementById('series-dropdown-list');
        if (!root || !trigger || !panel || !listEl) return;

        let seriesList = null;
        let hoverTimeout = null;

        function open() {
          panel.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
          if (seriesList === null) {
            fetch('/series-list.json')
              .then((r) => r.json())
              .then((list) => {
                seriesList = list;
                if (list.length === 0) {
                  listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">æš‚æ— ç³»åˆ—</span>';
                } else {
                  listEl.innerHTML = list.map(function(name) {
                     const slug = name.toLowerCase().replace(/\s+/g, '-');
                     const url = '/notes/series/' + slug;
                     return '<a href="' + url + '" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors" role="menuitem">' + escapeHtml(name) + '</a>';
                   }).join('');
                }
              })
              .catch(function() {
                listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-11">åŠ è½½å¤±è´¥</span>';
              });
          }
        }

        function close() {
          panel.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        }

        function escapeHtml(s) {
          const div = document.createElement('div');
          div.textContent = s;
          return div.innerHTML;
        }

        // On click: allow default navigation to /notes/series
        // On hover: show dropdown menu
        trigger.addEventListener('click', function(e) {
          e.stopPropagation();
          // Don't preventDefault - allow link to navigate
        });

        trigger.addEventListener('mouseenter', function() {
          if (hoverTimeout) clearTimeout(hoverTimeout);
          hoverTimeout = setTimeout(open, 200);
        });

        root.addEventListener('mouseleave', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
          hoverTimeout = setTimeout(close, 150);
        });

        panel.addEventListener('mouseenter', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
        });

        document.addEventListener('click', function(e) {
          if (!root.contains(e.target)) close();
        });
      })();
    </script> <script>
      (function() {
        const root = document.getElementById('tags-dropdown-root');
        const trigger = document.getElementById('tags-dropdown-trigger');
        const panel = document.getElementById('tags-dropdown-panel');
        const listEl = document.getElementById('tags-dropdown-list');
        if (!root || !trigger || !panel || !listEl) return;

        let tagList = null;
        let hoverTimeout = null;

        function open() {
          panel.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
          if (tagList === null) {
            fetch('/tag-list.json')
              .then((r) => r.json())
              .then((list) => {
                tagList = list;
                if (list.length === 0) {
                  listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">æš‚æ— æ ‡ç­¾</span>';
                } else {
                  listEl.innerHTML = list.map(function(tag) {
                     const url = '/notes/tag/' + encodeURIComponent(tag);
                     return '<a href="' + url + '" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors" role="menuitem">' + escapeHtml(tag) + '</a>';
                   }).join('');
                }
              })
              .catch(function() {
                listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-11">åŠ è½½å¤±è´¥</span>';
              });
          }
        }

        function close() {
          panel.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        }

        function escapeHtml(s) {
          const div = document.createElement('div');
          div.textContent = s;
          return div.innerHTML;
        }

        trigger.addEventListener('click', function(e) {
          e.stopPropagation();
        });

        trigger.addEventListener('mouseenter', function() {
          if (hoverTimeout) clearTimeout(hoverTimeout);
          hoverTimeout = setTimeout(open, 200);
        });

        root.addEventListener('mouseleave', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
          hoverTimeout = setTimeout(close, 150);
        });

        panel.addEventListener('mouseenter', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
        });

        document.addEventListener('click', function(e) {
          if (!root.contains(e.target)) close();
        });
      })();
    </script> </body> </html>  <script>
  // Language aliases (matches server-side)
  const langAliases = {
    js: 'javascript',
    ts: 'typescript',
    yml: 'yaml',
    yaml: 'yaml',
    sh: 'bash',
    shell: 'bash',
    sql: 'postgresql',
    java: 'openjdk',
  };

  // Add headers and copy buttons to code blocks
  function initCodeBlocks() {
    document.querySelectorAll('pre[data-language]').forEach((pre) => {
      // Skip if already processed
      if (pre.parentNode.classList.contains('code-block-wrapper')) return;
      
      const lang = pre.getAttribute('data-language') || 'code';
      
      // Create wrapper
      const wrapper = document.createElement('div');
      wrapper.className = 'code-block-wrapper';
      pre.parentNode.insertBefore(wrapper, pre);
      wrapper.appendChild(pre);
      
      // Create header
      const header = document.createElement('div');
      header.className = 'code-header';
      
      const langSpan = document.createElement('span');
      langSpan.className = 'code-header-lang';
      langSpan.title = lang;
      
      // Normalize lang for devicon
      const normalizedLang = lang.toLowerCase();
      const iconLang = langAliases[normalizedLang] || normalizedLang;
      
      // Display language with devicon (format: devicon-{name}-{version} colored)
      const iconEl = document.createElement('i');
      iconEl.className = `devicon-${iconLang}-plain colored`;
      iconEl.style.marginRight = '0.375rem';
      iconEl.style.fontSize = '0.75rem';
      langSpan.appendChild(iconEl);
      langSpan.appendChild(document.createTextNode(lang));
      
      const button = document.createElement('button');
      button.className = 'copy-code-btn';
      button.title = 'Copy to clipboard';
      button.innerHTML = '<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
      
      let isCopying = false;
      button.addEventListener('click', async () => {
        if (isCopying) return;
        isCopying = true;
        
        const code = pre.querySelector('code')?.textContent || '';
        try {
          await navigator.clipboard.writeText(code);
          const originalHtml = button.innerHTML;
          button.innerHTML = '<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>';
          button.title = 'Copied!';
          setTimeout(() => {
            button.innerHTML = originalHtml;
            button.title = 'Copy to clipboard';
            isCopying = false;
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
          isCopying = false;
        }
      });
      
      header.appendChild(langSpan);
      header.appendChild(button);
      wrapper.appendChild(header);
    });
  }

  // Run ASAP, then on DOMContentLoaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCodeBlocks);
  } else {
    initCodeBlocks();
  }

  // Convert wikilinks to links on client side
  // Matches [[ref]] or [[ref|display text]]
  document.addEventListener('DOMContentLoaded', () => {
    const wikiRegex = /\[\[([a-zA-Z0-9][a-zA-Z0-9_-]*?)(?:\|([^\]]+))?\]\]/g;
    
    // Process all text nodes in prose content
    const walker = document.createTreeWalker(
      document.querySelector('.prose') || document.body,
      NodeFilter.SHOW_TEXT,
      null,
      false
    );
    
    const nodesToReplace = [];
    let node;
    
    while (node = walker.nextNode()) {
      if (node.nodeValue.includes('[[')) {
        nodesToReplace.push(node);
      }
    }
    
    nodesToReplace.forEach((textNode) => {
      const parent = textNode.parentNode;
      let lastIndex = 0;
      const matches = [...textNode.nodeValue.matchAll(wikiRegex)];
      
      if (matches.length === 0) return;
      
      const fragment = document.createDocumentFragment();
      
      matches.forEach((match) => {
        const [fullMatch, ref, displayText] = match;
        const startIndex = match.index;
        
        // Add text before match
        if (startIndex > lastIndex) {
          fragment.appendChild(
            document.createTextNode(textNode.nodeValue.slice(lastIndex, startIndex))
          );
        }
        
        // Create link
        const link = document.createElement('a');
        link.href = `/notes/${ref.toLowerCase()}`;
        link.textContent = (displayText || ref).trim();
        link.className = 'text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-colors';
        fragment.appendChild(link);
        
        lastIndex = startIndex + fullMatch.length;
      });
      
      // Add remaining text
      if (lastIndex < textNode.nodeValue.length) {
        fragment.appendChild(
          document.createTextNode(textNode.nodeValue.slice(lastIndex))
        );
      }
      
      parent.replaceChild(fragment, textNode);
    });
  });
</script> 