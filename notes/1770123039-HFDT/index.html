<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Blog"><title>practical</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.16.0/devicon.min.css"><script>
      // This script runs synchronously in the head to prevent FOUC (Flash of Unstyled Content)
      (function() {
        const THEME_KEY = 'nord-theme';
        const DARK = 'dark';
        
        function getStoredTheme() {
          try {
            return localStorage.getItem(THEME_KEY);
          } catch {
            return null;
          }
        }
        
        function getSystemTheme() {
          return window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : 'light';
        }
        
        function getTheme() {
          return getStoredTheme() || getSystemTheme();
        }
        
        function applyTheme(theme) {
          const html = document.documentElement;
          if (theme === DARK) {
            html.classList.add('dark');
          } else {
            html.classList.remove('dark');
          }
        }
        
        // Apply theme immediately before page renders
        applyTheme(getTheme());
      })();
    </script><link rel="stylesheet" href="/_astro/_id_.6ed6JusR.css">
<style>.knowledge-graph-container[data-astro-cid-zjb43jqo]{border:1px solid var(--nord-4);border-radius:8px;background:var(--nord-6);position:relative;overflow:hidden}.knowledge-graph-container[data-astro-cid-zjb43jqo]:fullscreen,.knowledge-graph-container[data-astro-cid-zjb43jqo]::-webkit-full-screen{width:100vw;height:100vh;border-radius:0}.knowledge-graph-container[data-astro-cid-zjb43jqo]:fullscreen .knowledge-graph-wrapper[data-astro-cid-zjb43jqo],.knowledge-graph-container[data-astro-cid-zjb43jqo]::-webkit-full-screen .knowledge-graph-wrapper[data-astro-cid-zjb43jqo]{width:100%;height:100%}.knowledge-graph-toolbar{position:absolute;top:8px;right:8px;z-index:10;display:flex;gap:4px;align-items:center}.knowledge-graph-toolbar-btn{width:32px;height:32px;padding:0;border:1px solid var(--nord-4);border-radius:6px;background:var(--nord-6);color:var(--nord-2);font-size:16px;font-weight:600;line-height:1;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .15s,color .15s}.knowledge-graph-toolbar-btn:hover{background:var(--nord-5);color:var(--nord-10)}.knowledge-graph-toolbar-btn:active{background:var(--nord-4)}.knowledge-graph-wrapper[data-astro-cid-zjb43jqo]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.knowledge-graph-node{cursor:pointer;stroke:#5e81ac;stroke-width:2.5px;transition:all .2s ease}.knowledge-graph-node:hover{stroke-width:2.5px;filter:brightness(1.2)}.knowledge-graph-node.active{stroke:var(--nord-14);stroke-width:3px;filter:drop-shadow(0 0 8px rgba(191,97,106,.5))}.knowledge-graph-node--current{stroke:var(--nord-10);stroke-width:3px;filter:drop-shadow(0 0 6px rgba(94,129,172,.6))}.knowledge-graph-node--outlink{stroke:var(--nord-14);stroke-width:2.5px}.knowledge-graph-node--backlink{stroke:var(--nord-15);stroke-width:2.5px}.knowledge-graph-node--both{stroke:var(--nord-12);stroke-width:2.5px}.knowledge-graph-node--neighbor{stroke:var(--nord-4);stroke-width:2px;opacity:.9}.knowledge-graph-link{stroke:#4c566a;stroke-opacity:.85;stroke-width:2px}.knowledge-graph-link.active{stroke:var(--nord-11);stroke-opacity:.9;stroke-width:2px}.knowledge-graph-label{pointer-events:none;font-size:11px;text-anchor:middle;fill:var(--nord-1);font-weight:500;text-shadow:0 0 3px var(--nord-6)}.knowledge-graph-tooltip{position:absolute;padding:8px 12px;background:var(--nord-0);border:1px solid var(--nord-3);border-radius:4px;font-size:12px;color:var(--nord-6);pointer-events:none;z-index:1000;box-shadow:0 2px 8px #0000004d;white-space:nowrap}.knowledge-graph-tooltip-type{color:var(--nord-8);font-size:11px}.knowledge-graph-legend{position:absolute;bottom:8px;left:8px;z-index:10;display:flex;flex-wrap:wrap;gap:8px 12px;font-size:11px;color:var(--nord-2)}.kg-legend-item{display:inline-flex;align-items:center;gap:4px}.kg-legend--current{color:var(--nord-10)}.kg-legend--outlink{color:var(--nord-14)}.kg-legend--backlink{color:var(--nord-15)}.kg-legend--both{color:var(--nord-12)}.kg-legend--neighbor{color:var(--nord-4);opacity:.9}
html{scroll-behavior:smooth}article[data-astro-cid-v5yihett]{word-break:break-word}
</style></head> <body class="text-nord-3 dark:text-nord-5 transition-all bg-gradient-light"> <header class="border-b border-nord-5 dark:border-nord-1 bg-nord-6 dark:bg-nord-0"> <nav class="max-w-4xl mx-auto px-4 py-5 flex items-center justify-between gap-4"> <div class="flex items-center gap-2 min-w-0"> <a href="/" title="Liu" class="shrink-0 p-1.5 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-lg dark:hover:shadow-nord-8/20 active:scale-95"> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"> <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path> <circle cx="12" cy="7" r="4"></circle> </svg> </a> <h1 class="text-xl font-bold truncate"> <a href="/" class="text-nord-2 dark:text-nord-6 hover:text-nord-10 dark:hover:text-nord-8 transition-colors"> Liu </a> </h1> </div> <div class="flex items-center gap-2 shrink-0"> <a href="https://github.com/gh-liu" title="GitHub" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-label="GitHub"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </svg> </a> <a href="https://x.com" title="X" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-label="X"> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24h-6.657l-5.207-6.807-5.975 6.807H2.306l7.644-8.74-8.179-10.76h6.467l4.713 6.231 5.429-6.231zM17.002 18.807h1.844L6.983 4.126H5.025l11.977 14.681z"></path> </svg> </a> <span class="w-px h-4 bg-nord-4 dark:bg-nord-2 shrink-0" aria-hidden="true"></span> <div class="relative series-dropdown" id="series-dropdown-root"> <a href="/notes/series" title="Series" aria-expanded="false" aria-haspopup="true" aria-controls="series-dropdown-panel" id="series-dropdown-trigger" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M4 6h16M4 12h16M4 18h16"></path> </svg> </a> <div id="series-dropdown-panel" class="absolute right-0 top-full mt-1 py-2 min-w-[12rem] max-h-[70vh] overflow-y-auto rounded-lg border border-nord-4 dark:border-nord-2 bg-nord-6 dark:bg-nord-1 shadow-lg z-50 hidden" role="menu"> <div id="series-dropdown-list" class="py-1"> <span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">åŠ è½½ä¸­â€¦</span> </div> <div class="border-t border-nord-4 dark:border-nord-2 pt-1 mt-1"> <a href="/notes/series" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors">
æŸ¥çœ‹å…¨éƒ¨ç³»åˆ— â†’
</a> </div> </div> </div> <div class="relative tags-dropdown" id="tags-dropdown-root"> <a href="/notes/tags" title="Tags" aria-expanded="false" aria-haspopup="true" aria-controls="tags-dropdown-panel" id="tags-dropdown-trigger" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> </a> <div id="tags-dropdown-panel" class="absolute right-0 top-full mt-1 py-2 min-w-[12rem] max-h-[70vh] overflow-y-auto rounded-lg border border-nord-4 dark:border-nord-2 bg-nord-6 dark:bg-nord-1 shadow-lg z-50 hidden" role="menu"> <div id="tags-dropdown-list" class="py-1"> <span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">åŠ è½½ä¸­â€¦</span> </div> <div class="border-t border-nord-4 dark:border-nord-2 pt-1 mt-1"> <a href="/notes/tags" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors">
æŸ¥çœ‹å…¨éƒ¨æ ‡ç­¾ â†’
</a> </div> </div> </div> <div class="search-container" id="search-wrapper" data-astro-cid-t47yvtpn><button id="search-toggle" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex" aria-label="Search notes" title="Search (âŒ˜K)" data-astro-cid-t47yvtpn><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-t47yvtpn><circle cx="11" cy="11" r="8" data-astro-cid-t47yvtpn></circle><path d="m21 21-4.35-4.35" data-astro-cid-t47yvtpn></path></svg></button><div id="search-modal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-50 flex items-start justify-center pt-20 backdrop-blur-sm" data-astro-cid-t47yvtpn><div class="bg-nord-6 dark:bg-nord-0 rounded-2xl shadow-2xl w-full max-w-2xl border border-nord-5 dark:border-nord-1 max-h-[70vh] flex flex-col overflow-hidden animate-fade-in" data-astro-cid-t47yvtpn><div class="p-4 border-b border-nord-5 dark:border-nord-1" data-astro-cid-t47yvtpn><input type="search" id="search-input" placeholder="Search notes... (use #tag for tag search)" class="w-full px-4 py-2 bg-nord-5 dark:bg-nord-1 text-nord-2 dark:text-nord-6 placeholder-nord-3 dark:placeholder-nord-4 rounded focus:outline-none focus:ring-2 focus:ring-nord-9 dark:focus:ring-nord-8" autocomplete="off" data-astro-cid-t47yvtpn></div><div id="search-results" class="flex-1 overflow-y-auto p-4" data-astro-cid-t47yvtpn><p class="text-nord-3 dark:text-nord-5 text-sm" data-astro-cid-t47yvtpn>Type to search...</p></div><div class="p-3 border-t border-nord-5 dark:border-nord-1 text-xs text-nord-3 dark:text-nord-4" data-astro-cid-t47yvtpn><p data-astro-cid-t47yvtpn>Press <kbd class="px-1 py-0.5 bg-nord-4 dark:bg-nord-2 rounded" data-astro-cid-t47yvtpn>Esc</kbd> to close | Use <kbd class="px-1 py-0.5 bg-nord-4 dark:bg-nord-2 rounded" data-astro-cid-t47yvtpn>#tag</kbd> to search by tag</p></div></div></div></div><script>(function(){const pagefindUrl = "/pagefind/pagefind.js";

  if (!globalThis.pagefindLoaded) {
    globalThis.pagefindLoaded = true;
    
    let pagefind;
    let searchInput;
    let searchModal;
    let searchResults;
    let isSearchOpen = false;

    async function initSearch() {
      if (typeof window === "undefined") return;

      try {
        pagefind = await import(pagefindUrl);
        await pagefind.init();
      } catch (error) {
        console.log("Search not available.", error);
        return;
      }

      searchInput = document.getElementById("search-input");
      searchModal = document.getElementById("search-modal");
      searchResults = document.getElementById("search-results");
      const toggleBtn = document.getElementById("search-toggle");

      if (!searchInput || !searchModal || !searchResults || !toggleBtn) return;

      toggleBtn.addEventListener("click", () => {
        openSearch();
      });

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          closeSearch();
        }
        if ((e.metaKey || e.ctrlKey) && e.key === "k") {
          e.preventDefault();
          isSearchOpen ? closeSearch() : openSearch();
        }
      });

      searchModal.addEventListener("click", (e) => {
        if (e.target === searchModal) closeSearch();
      });

      searchInput.addEventListener("input", async (e) => {
        const query = e.target.value.trim();
        if (!query) {
          searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">Type to search...</p>';
          return;
        }

        // Check if query starts with #tag
        const isTagSearch = query.startsWith('#');
        let results;
        
        if (isTagSearch) {
          // Tag search
          const tag = query.slice(1).toUpperCase();
          results = await pagefind.search(`tag:${tag}`);
        } else {
          // Regular text search
          results = await pagefind.search(query);
        }

        if (results.results.length === 0) {
          searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">No results found.</p>';
          return;
        }

        let html = '<ul class="space-y-2">';
        for (const result of results.results) {
          const data = await result.data();
          // Extract title from h1 or use URL slug as fallback
          const title = data.meta?.title || data.title || (data.url.split('/').pop() || 'untitled').replace(/-/g, ' ');
          html += `<li><a href="${data.url}" class="block p-3 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-2 text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-all hover:shadow-md duration-200 border border-transparent hover:border-nord-9 dark:hover:border-nord-8"><div class="font-medium">${title}</div><div class="text-xs text-nord-3 dark:text-nord-5 mt-1 line-clamp-2">${data.excerpt || ""}</div></a></li>`;
        }
        searchResults.innerHTML = html + "</ul>";
      });
    }

    function openSearch() {
      isSearchOpen = true;
      searchModal.classList.remove("hidden");
      searchInput.focus();
      document.body.style.overflow = "hidden";
    }

    function closeSearch() {
      isSearchOpen = false;
      searchModal.classList.add("hidden");
      searchInput.value = "";
      searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">Type to search...</p>';
      document.body.style.overflow = "";
    }

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initSearch);
    } else {
      initSearch();
    }
  }
})();</script> <button id="theme-toggle" aria-label="Toggle theme" title="Toggle theme" class="group relative p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-3 dark:text-nord-4 transition-all duration-200 ease-out hover:scale-110 inline-flex"> <span class="inline-block transition-transform duration-200 ease-out group-hover:rotate-12"> <svg id="sun-icon" class="w-4 h-4 text-nord-13 hidden dark:block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <circle cx="12" cy="12" r="5"></circle> <line x1="12" y1="1" x2="12" y2="3"></line> <line x1="12" y1="21" x2="12" y2="23"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line> <line x1="1" y1="12" x2="3" y2="12"></line> <line x1="21" y1="12" x2="23" y2="12"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line> </svg> <svg id="moon-icon" class="w-4 h-4 text-nord-9 block dark:hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path> </svg> </span> </button> <script>
  const THEME_KEY = 'nord-theme';
  const DARK = 'dark';
  
  function getStoredTheme() {
    return localStorage.getItem(THEME_KEY);
  }
  
  function getSystemTheme() {
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : 'light';
  }
  
  function getTheme() {
    return getStoredTheme() || getSystemTheme();
  }
  
  function applyTheme(theme) {
    const html = document.documentElement;
    if (theme === DARK) {
      html.classList.add('dark');
    } else {
      html.classList.remove('dark');
    }
  }
  
  function toggleTheme() {
    const currentTheme = getTheme();
    const newTheme = currentTheme === DARK ? 'light' : DARK;
    localStorage.setItem(THEME_KEY, newTheme);
    applyTheme(newTheme);
  }
  
  const themeToggle = document.getElementById('theme-toggle');
  if (themeToggle) {
    themeToggle.addEventListener('click', toggleTheme);
  }
</script> </div> </nav> </header> <main class="max-w-4xl mx-auto px-4 py-12" data-pagefind-body> <aside id="toc-sidebar" class="fixed left-0 top-0 h-screen w-56 bg-nord-6 dark:bg-nord-0 border-r border-nord-5 dark:border-nord-1 overflow-y-auto overflow-x-hidden pt-4 pb-4 transition-transform duration-300 -translate-x-full z-50" data-astro-cid-vrmg3htk> <nav class="px-4 space-y-1" data-astro-cid-vrmg3htk> <!-- Close button --> <button id="toc-close" class="flex justify-end w-full mb-4 p-2 text-nord-2 dark:text-nord-6 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors" aria-label="Close navigation" data-astro-cid-vrmg3htk> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-vrmg3htk> <path d="M18 6L6 18M6 6l12 12" data-astro-cid-vrmg3htk></path> </svg> </button> <h3 class="text-xs font-bold text-nord-2 dark:text-nord-6 uppercase tracking-widest px-2 py-3 border-b border-nord-5 dark:border-nord-1" data-astro-cid-vrmg3htk>
On this page
</h3> <ul class="space-y-0.5 text-sm mt-4" data-astro-cid-vrmg3htk> <li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#11--1-æŒ‡å¯¼å‡†åˆ™" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.1 Â· 1. æŒ‡å¯¼å‡†åˆ™ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#111--ç®€å•" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.1.1 Â· ç®€å• </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#112--å¯è¯»" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.1.2 Â· å¯è¯» </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#113--ç”Ÿäº§" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.1.3 Â· ç”Ÿäº§ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#12--2-æ ‡è¯†ç¬¦" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.2 Â· 2. æ ‡è¯†ç¬¦ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#121--æ ‡è¯†ç¬¦é•¿åº¦" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.1 Â· æ ‡è¯†ç¬¦é•¿åº¦ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#122--ä¸Šä¸‹æ–‡æ˜¯å…³é”®" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.2 Â· ä¸Šä¸‹æ–‡æ˜¯å…³é”® </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#123--ä¸è¦åœ¨å˜é‡å‘½åä¸­åŠ ä¸Šç±»å‹" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.3 Â· ä¸è¦åœ¨å˜é‡å‘½åä¸­åŠ ä¸Šç±»å‹ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#124--ä½¿ç”¨ä¸€è‡´çš„å‘½åé£æ ¼" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.4 Â· ä½¿ç”¨ä¸€è‡´çš„å‘½åé£æ ¼ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#125--ä½¿ç”¨ä¸€è‡´çš„å£°æ˜é£æ ¼" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.5 Â· ä½¿ç”¨ä¸€è‡´çš„å£°æ˜é£æ ¼ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#126--æˆä¸ºå›¢é˜Ÿåˆä½œè€…" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.6 Â· æˆä¸ºå›¢é˜Ÿåˆä½œè€… </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#13--3-æ³¨é‡Š" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.3 Â· 3. æ³¨é‡Š </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#131--å˜é‡å’Œå¸¸é‡çš„æ³¨é‡Šåº”è¯¥æè¿°å…¶å†…å®¹è€Œä¸æ˜¯ç›®çš„" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.1 Â· å˜é‡å’Œå¸¸é‡çš„æ³¨é‡Šåº”è¯¥æè¿°å…¶å†…å®¹ï¼Œè€Œä¸æ˜¯ç›®çš„ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#132--å…¬å¼€ç¬¦å·å§‹ç»ˆéœ€è¦æ³¨é‡Š" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.2 Â· å…¬å¼€ç¬¦å·å§‹ç»ˆéœ€è¦æ³¨é‡Š </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#14--4-åŒ…è®¾è®¡" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.4 Â· 4. åŒ…è®¾è®¡ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#15--5-é¡¹ç›®ç»“æ„" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.5 Â· 5. é¡¹ç›®ç»“æ„ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#16--6-apiè®¾è®¡" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.6 Â· 6. APIè®¾è®¡ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#161--æ³¨æ„å‡½æ•°å¤šä¸ªå‚æ•°ä¸ºç›¸åŒç±»å‹æ—¶" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.6.1 Â· æ³¨æ„å‡½æ•°å¤šä¸ªå‚æ•°ä¸ºç›¸åŒç±»å‹æ—¶ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#162--é’ˆå¯¹å…¶é»˜è®¤ç”¨ä¾‹è®¾è®¡api" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.6.2 Â· é’ˆå¯¹å…¶é»˜è®¤ç”¨ä¾‹è®¾è®¡API </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#163--è®©å‡½æ•°å®šä¹‰å®ƒä»¬æ‰€éœ€è¦çš„è¡Œä¸ºæ’é™¤å…¶ä»–ä¸éœ€è¦çš„" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.6.3 Â· è®©å‡½æ•°å®šä¹‰å®ƒä»¬æ‰€éœ€è¦çš„è¡Œä¸ºï¼Œæ’é™¤å…¶ä»–ä¸éœ€è¦çš„ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#17--7-é”™è¯¯å¤„ç†" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.7 Â· 7. é”™è¯¯å¤„ç† </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#171--é€šè¿‡æ¶ˆé™¤é”™è¯¯æ¶ˆé™¤é”™è¯¯å¤„ç†" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.7.1 Â· é€šè¿‡æ¶ˆé™¤é”™è¯¯æ¶ˆé™¤é”™è¯¯å¤„ç† </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#18--8-å¹¶å‘" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.8 Â· 8. å¹¶å‘ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#181--ä½¿è‡ªå·±ä¿æŒå¿™ç¢ŒçŠ¶æ€æˆ–è€…è‡ªå·±å®Œæˆå·¥ä½œ" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.8.1 Â· ä½¿è‡ªå·±ä¿æŒå¿™ç¢ŒçŠ¶æ€æˆ–è€…è‡ªå·±å®Œæˆå·¥ä½œ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#182--å°†å¹¶å‘ç•™ç»™è°ƒç”¨è€…" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.8.2 Â· å°†å¹¶å‘ç•™ç»™è°ƒç”¨è€… </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#183--å¦‚æœä¸çŸ¥é“è¦å¼€å¯çš„goroutineä»€ä¹ˆæ—¶å€™ç»“æŸé‚£å°±ä¸è¦å¼€å¯å®ƒ" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.8.3 Â· å¦‚æœä¸çŸ¥é“è¦å¼€å¯çš„goroutineä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œé‚£å°±ä¸è¦å¼€å¯å®ƒã€‚ </a> </li> </ul> </nav> </aside> <!-- Toggle button - fixed at left edge --> <button id="toc-toggle" class="fixed left-0 top-4 p-3 rounded-r-lg bg-nord-9 dark:bg-nord-8 text-nord-6 dark:text-nord-0 hover:bg-nord-10 dark:hover:bg-nord-7 hover:text-nord-6 dark:hover:text-nord-0 transition-colors shadow-lg z-40" aria-label="Toggle sidebar" title="Toggle sidebar (â† â†’)" data-astro-cid-vrmg3htk> <svg id="toggle-icon" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-vrmg3htk> <path d="M4 6h16M4 12h16M4 18h16" data-astro-cid-vrmg3htk></path> </svg> </button> <script>
  const TOC_KEY = 'toc-open';
  const sidebar = document.getElementById('toc-sidebar');
  const toggle = document.getElementById('toc-toggle');
  const closeBtn = document.getElementById('toc-close');

  function getSidebarState() {
    return localStorage.getItem(TOC_KEY) !== 'false';
  }

  function setSidebarState(open) {
    localStorage.setItem(TOC_KEY, open ? 'true' : 'false');
  }

  function updateSidebar() {
    const isOpen = getSidebarState();
    if (sidebar) {
      if (isOpen) {
        sidebar.classList.remove('-translate-x-full');
      } else {
        sidebar.classList.add('-translate-x-full');
      }
    }
  }

  function toggleSidebar() {
    const isOpen = getSidebarState();
    setSidebarState(!isOpen);
    updateSidebar();
  }

  // Initialize
  updateSidebar();

  // Event listeners
  if (toggle) {
    toggle.addEventListener('click', toggleSidebar);
  }

  if (closeBtn) {
    closeBtn.addEventListener('click', toggleSidebar);
  }

  // Keyboard shortcut: left/right arrow to toggle
  document.addEventListener('keydown', (e) => {
    if ((e.key === 'ArrowLeft' || e.key === 'ArrowRight') && e.ctrlKey) {
      e.preventDefault();
      toggleSidebar();
    }
  });

  // Highlight current section on scroll
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          document.querySelectorAll('.toc-item a').forEach((link) => {
            link.classList.remove('text-nord-9', 'dark:text-nord-8', 'font-semibold', 'bg-nord-5', 'dark:bg-nord-1');
            link.classList.add('text-nord-3', 'dark:text-nord-4');
          });
          const activeLink = document.querySelector(
            `.toc-item a[href="#${entry.target.id}"]`
          );
          if (activeLink) {
            activeLink.classList.remove('text-nord-3', 'dark:text-nord-4');
            activeLink.classList.add('text-nord-9', 'dark:text-nord-8', 'font-semibold', 'bg-nord-5', 'dark:bg-nord-1');
          }
        }
      });
    },
    { rootMargin: '-50% 0px -50% 0px' }
  );

  document.querySelectorAll('h2, h3').forEach((heading) => {
    if (heading.id) {
      observer.observe(heading);
    }
  });

  // Close sidebar on link click
  document.querySelectorAll('.toc-item a').forEach((link) => {
    link.addEventListener('click', () => {
      setSidebarState(false);
      updateSidebar();
    });
  });
</script>  <article class="prose prose-nord dark:prose-nord max-w-none
      prose-headings:font-serif
      prose-code:before:content-none prose-code:after:content-none" data-astro-cid-v5yihett> <header class="mb-8" data-astro-cid-v5yihett> <h1 class="mb-3" data-pagefind-meta="title" data-astro-cid-v5yihett>practical</h1> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4" data-astro-cid-v5yihett> <div class="text-sm text-nord-3 dark:text-nord-5" data-astro-cid-v5yihett> <div> <div class="flex flex-wrap gap-2 mb-2"> <span class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-nord-7 dark:bg-nord-7 text-nord-0 dark:text-nord-0 rounded font-medium"> <span>ğŸ“…</span> <span>2026-02-05</span> </span> <span class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-nord-8 dark:bg-nord-8 text-nord-0 dark:text-nord-0 rounded font-medium"> <span>âœï¸</span> <span>2026-02-05</span> </span>  <div class="flex flex-wrap gap-2"> <a href="/notes/tag/CS" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-blue-light dark:tag-text-blue-dark !no-underline hover:!no-underline" title="Tag: CS"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> <span>CS</span>  </a><a href="/notes/tag/GO" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-blue-light dark:tag-text-blue-dark !no-underline hover:!no-underline" title="Tag: GO"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> <span>GO</span>  </a> </div> </div> </div> </div> <div class="text-sm" data-astro-cid-v5yihett> <div> <div class="flex items-center gap-4"> <!-- Back to notes link - removed, now in footer --> <!-- Show only links and backlinks stats --> <!-- Outlinks -->  <!-- Backlinks -->  <!-- No links message --> <span class="text-nord-3 dark:text-nord-4 italic">No related notes</span> </div> <!-- Modals --> <div id="outlinks-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-nord-6 dark:bg-nord-0 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-nord-5 dark:border-nord-1"> <!-- Header --> <div class="sticky top-0 bg-nord-6 dark:bg-nord-0 border-b border-nord-5 dark:border-nord-1 px-6 py-4 flex items-center justify-between"> <h2 class="text-lg font-semibold text-nord-2 dark:text-nord-6"> Outlinks <span class="text-sm font-normal text-nord-3 dark:text-nord-5 ml-2">
(0)
</span> </h2> <button class="close-modal p-1 text-nord-3 dark:text-nord-4 hover:bg-nord-5 dark:hover:bg-nord-1 hover:text-nord-2 dark:hover:text-nord-5 rounded transition-colors" aria-label="Close modal"> <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M18 6L6 18M6 6l12 12"></path> </svg> </button> </div> <!-- Content --> <div class="p-6"> <p class="text-nord-3 dark:text-nord-5 text-center py-8">
No outlinks found
</p> </div> </div> </div> <script>(function(){const modalId = "outlinks-modal";
const type = "outlinks";

  const modal = document.getElementById(modalId);
  const closeButtons = modal ? modal.querySelectorAll('.close-modal') : [];

  // Create camelCase function name: "backlinks" -> "openBacklinksModal"
  const functionName = `open${type.charAt(0).toUpperCase() + type.slice(1)}Modal`;

  // Open modal
  window[functionName] = function() {
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  };

  // Close modal
  function closeModal() {
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  }

  // Close button listeners
  closeButtons.forEach((btn) => {
    btn.addEventListener('click', closeModal);
  });

  // Close on background click
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
})();</script> <div id="backlinks-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-nord-6 dark:bg-nord-0 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-nord-5 dark:border-nord-1"> <!-- Header --> <div class="sticky top-0 bg-nord-6 dark:bg-nord-0 border-b border-nord-5 dark:border-nord-1 px-6 py-4 flex items-center justify-between"> <h2 class="text-lg font-semibold text-nord-2 dark:text-nord-6"> Backlinks <span class="text-sm font-normal text-nord-3 dark:text-nord-5 ml-2">
(0)
</span> </h2> <button class="close-modal p-1 text-nord-3 dark:text-nord-4 hover:bg-nord-5 dark:hover:bg-nord-1 hover:text-nord-2 dark:hover:text-nord-5 rounded transition-colors" aria-label="Close modal"> <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M18 6L6 18M6 6l12 12"></path> </svg> </button> </div> <!-- Content --> <div class="p-6"> <p class="text-nord-3 dark:text-nord-5 text-center py-8">
No backlinks found
</p> </div> </div> </div> <script>(function(){const modalId = "backlinks-modal";
const type = "backlinks";

  const modal = document.getElementById(modalId);
  const closeButtons = modal ? modal.querySelectorAll('.close-modal') : [];

  // Create camelCase function name: "backlinks" -> "openBacklinksModal"
  const functionName = `open${type.charAt(0).toUpperCase() + type.slice(1)}Modal`;

  // Open modal
  window[functionName] = function() {
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  };

  // Close modal
  function closeModal() {
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  }

  // Close button listeners
  closeButtons.forEach((btn) => {
    btn.addEventListener('click', closeModal);
  });

  // Close on background click
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
})();</script> <script>
  // Outlinks button - calls window.openOutlinksModal()
  document.querySelectorAll('.open-outlinks-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      if (window.openOutlinksModal) {
        window.openOutlinksModal();
      }
    });
  });

  // Backlinks button - calls window.openBacklinksModal()
  document.querySelectorAll('.open-backlinks-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      if (window.openBacklinksModal) {
        window.openBacklinksModal();
      }
    });
  });
</script> </div> </div> </div> </header>    <p><a href="https://dave.cheney.net/practical-go/presentations/qcon-china.html">https://dave.cheney.net/practical-go/presentations/qcon-china.html</a></p>
<h1 id="1--å®è·µgoçœŸå®ä¸–ç•Œä¸­ç¼–å†™å¯ç»´æŠ¤goç¨‹åºçš„å»ºè®®">1 Â· å®è·µgoï¼šçœŸå®ä¸–ç•Œä¸­ç¼–å†™å¯ç»´æŠ¤goç¨‹åºçš„å»ºè®®</h1>
<p>ä»‹ç»ï¼šä½ å¥½ï¼Œæ¥ä¸‹æ¥ä¸¤ä¸ªé˜¶æ®µï¼Œæˆ‘çš„ç›®æ ‡æ˜¯ç»™ä½ ä¸€äº›æˆ‘çš„å»ºè®®ï¼Œå…³äºç¼–å†™Goä»£ç çš„æœ€ä½³å®è·µã€‚<br>
è¿™æ˜¯ä¸€ä¸ªç ”è®¨ä¼šå½¢å¼çš„å±•ç¤ºï¼Œæˆ‘å°†çœå»å¯»å¸¸çš„å¹»ç¯ç‰‡ï¼Œæˆ‘ä»¬å°†ç›´æ¥ä»ä»Šå¤©ä½ å¯ä»¥å¸¦èµ°çš„æ–‡æ¡£å¼€å§‹å·¥ä½œã€‚</p>
<h2 id="11--1-æŒ‡å¯¼å‡†åˆ™">1.1 Â· 1. æŒ‡å¯¼å‡†åˆ™</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>å°†æœ€ä½³å®è·µï¼Œå°±éœ€è¦å®šä¹‰æœ€ä½³ï¼Œç”¨RussCoxçš„åè¨€ï¼š</span></span>
<span class="line"><span>Software engineering is what happens to programming when you add time and other programmers. â€” Russ Cox</span></span>
<span class="line"><span>æŒ‡å‡ºäº†è½¯ä»¶ç¨‹åºä¸è½¯ä»¶å·¥ç¨‹çš„åŒºåˆ«ã€‚ä»¥å‰è‡ªå·±ä¸ºè‡ªå·±å†™ç¨‹åºï¼Œåæ¥å¤šäººåˆä½œèŠ±æ—¶é—´å†™ç¨‹åºã€‚å·¥ç¨‹å¸ˆæ¥æ¥èµ°èµ°ï¼Œå›¢é˜Ÿæ‰©å¼ æˆ–æ”¶ç¼©ï¼Œéœ€æ±‚ä¼šæ”¹å˜ï¼Œæ–°åŠŸèƒ½ä¼šæ·»åŠ ï¼Œç¼ºé™·ä¼šä¿®å¤ã€‚è¿™å°±æ˜¯è½¯ä»¶å·¥ç¨‹çš„æœ¬è´¨ã€‚</span></span>
<span class="line"><span>æŒ‡å¯¼å‡†åˆ™ï¼šç®€å•ã€å¯è¯»ã€ç”Ÿäº§</span></span>
<span class="line"><span>noteï¼šä¸ºä»€ä¹ˆæ²¡æœ‰æåˆ°æ€§èƒ½ã€å¹¶å‘ã€‚æœ‰ä¸€äº›è¯­è¨€æ˜¯æ¯”goå¿«ä¸€äº›çš„ï¼Œä½†æ˜¯ç»å¯¹çš„æ²¡æœ‰goç®€å•ï¼›æœ‰ä¸€äº›è¯­è¨€ï¼Œå°†å¹¶å‘è§†ä½œæœ€é«˜çš„ç›®æ ‡ï¼Œä½†æ˜¯æ—¢ä¸å…·æœ‰å¯è¯»æ€§ã€ä¹Ÿä¸å…·æœ‰ç”Ÿäº§æ€§ã€‚æ€§èƒ½å’Œå¹¶å‘æ˜¯é‡è¦çš„å±æ€§ï¼Œä½†æ˜¯æ²¡æœ‰ç®€å•ã€å¯è¯»ã€ç”Ÿæˆ é‡è¦ã€‚</span></span></code></pre>
<h3 id="111--ç®€å•">1.1.1 Â· ç®€å•</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Simplicity is prerequisite for reliability. â€” Edsger W. Dijkstra</span></span>
<span class="line"><span>ç®€å•æ˜¯å¯é çš„å‰æã€‚</span></span>
<span class="line"><span>ä¸ºä»€ä¹ˆè¦è¿½æ±‚ç®€å•ï¼Ÿä¸ºä»€ä¹ˆgoç¨‹åºå˜ç®€å•å¾ˆé‡è¦ï¼Ÿ</span></span>
<span class="line"><span>ä¸ç†è§£ä»£ç ï¼Œå®³æ€•ä¿®æ”¹ä»£ç ï¼Œæ‹…å¿ƒç ´åç¨‹åºï¼Œä¸çŸ¥é“æ€ä¹ˆä¿®å¤ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>There are two ways of constructing a software design: One way is to make it so simple that there are obviously no deficiencies, and the other way is to make it so complicated that there are no obvious deficiencies. The first method is far more difficult. â€” C. A. R. Hoare</span></span>
<span class="line"><span>æœ‰ä¸¤ç§æ–¹æ³•å»æ„å»ºä¸€ä¸ªè½¯ä»¶è®¾è®¡ï¼šå…¶ä¸€ï¼Œä½¿å…¶ç‰¹åˆ«ç®€å•ï¼Œæ‰€ä»¥æ˜æ˜¾æ²¡æœ‰ç¼ºç‚¹ï¼›å…¶äºŒï¼Œä½¿å…¶ç‰¹åˆ«å¤æ‚ï¼Œæ‰€ä»¥æ²¡æœ‰æ˜æ˜¾ç¼ºç‚¹ã€‚ç¬¬ä¸€ç§æ–¹æ³•ç‰¹åˆ«éš¾ã€‚</span></span>
<span class="line"><span>å¤åˆ¶æ€§ä½¿å¯é çš„è½¯ä»¶å˜çš„ä¸å¯é ã€‚å¤åˆ¶æ€§ä¼šæ€æ­»è½¯ä»¶é¡¹ç›®ã€‚æ‰€ä»¥ç®€å•æ€§æ˜¯goçš„æœ€é«˜ç›®æ ‡ï¼Œæ— è®ºæˆ‘ä»¬å†™ä»€ä¹ˆç¨‹åºï¼Œå¿…é¡»æ‰¿è®¤æ˜¯å¾ˆç®€å•çš„ã€‚</span></span></code></pre>
<h3 id="112--å¯è¯»">1.1.2 Â· å¯è¯»</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Readability is essential for maintainability. â€” Mark Reinhold</span></span>
<span class="line"><span>å¯¹äºå¯ç»´æŠ¤æ€§æ¥è¯´ï¼Œå¯è¯»æ€§å¾ˆé‡è¦ã€‚</span></span>
<span class="line"><span>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿½æ±‚å¯è¯»æ€§ã€‚</span></span>
<span class="line"><span>Programs must be written for people to read, and only incidentally for machines to execute â€” Hal Abelson and Gerald Sussman</span></span>
<span class="line"><span>ç¨‹åºå¿…é¡»æ˜¯ä¸ºäº†äººä»¬è¯»è€Œå†™ï¼Œä»…ä»…é¡ºä¾¿å¯ä»¥è¢«æœºå™¨æ‰§è¡Œã€‚</span></span>
<span class="line"><span>ä¸€æ®µç¨‹åºä¹Ÿè®¸ä¼šå› ä¸ºè¢«è®¸å¤šäººè¯»ï¼Œè€Œè¶…è¿‡å…¶ç”Ÿå‘½å‘¨æœŸã€‚</span></span>
<span class="line"><span>å¯è¯»æ€§æ˜¯äººä»¬ç†è§£ç¨‹åºå¦‚ä½•è¿è¡Œçš„å…³é”®ï¼Œä¸èƒ½ç†è§£ï¼Œå°±ä¸å¯ç»´æŠ¤ï¼Œé‚£å°±éœ€è¦é‡å†™ã€‚</span></span></code></pre>
<h3 id="113--ç”Ÿäº§">1.1.3 Â· ç”Ÿäº§</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Design is the art of arranging code to work today, and be changeable forever. â€” Sandi Metz</span></span>
<span class="line"><span>è®¾è®¡æ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œå®‰æ’ä»£ç ä»Šå¤©å·¥ä½œèµ·æ¥ï¼Œå¹¶ä¸”æ°¸è¿œå¯æ”¹å˜ã€‚</span></span></code></pre>
<h2 id="12--2-æ ‡è¯†ç¬¦">1.2 Â· 2. æ ‡è¯†ç¬¦</h2>
<h3 id="121--æ ‡è¯†ç¬¦é•¿åº¦">1.2.1 Â· æ ‡è¯†ç¬¦é•¿åº¦</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>å˜é‡åœ¨å£°æ˜å’Œæœ€åä¸€æ¬¡ä½¿ç”¨ä¹‹é—´çš„è·ç¦»å¾ˆçŸ­æ—¶,çŸ­å˜é‡åå¯ä»¥å·¥ä½œå¾—å¾ˆå¥½ã€‚  </span></span>
<span class="line"><span>é•¿å˜é‡åéœ€è¦è¯æ˜è‡ªå·±çš„åˆç†æ€§ï¼Œå®ƒä»¬è¶Šé•¿ï¼Œéœ€è¦æä¾›çš„ä»·å€¼å°±è¶Šå¤šã€‚å†—é•¿çš„å®˜åƒšä¸»ä¹‰å˜é‡åä¸å®ƒä»¬åœ¨é¡µé¢ä¸Šçš„ä»½é‡ç›¸æ¯”ï¼Œä¼ è¾¾çš„ä¿¡æ¯é‡å¾ˆä½ã€‚  </span></span>
<span class="line"><span>ä¸è¦åœ¨å˜é‡åä¸­åŒ…å«å˜é‡ç±»å‹çš„åç§°ã€‚  </span></span>
<span class="line"><span>å¸¸é‡åº”è¯¥æè¿°å®ƒä»¬æ‰€æŒæœ‰çš„å€¼ï¼Œè€Œä¸æ˜¯å¦‚ä½•ä½¿ç”¨è¯¥å€¼ã€‚</span></span>
<span class="line"><span>å¾ªç¯å’Œåˆ†æ”¯ä½¿ç”¨å•å­—æ¯å˜é‡ï¼Œå‚æ•°å’Œè¿”å›å€¼ä½¿ç”¨å•ä¸ªå•è¯ï¼Œå‡½æ•°å’ŒåŒ…çº§åˆ«å£°æ˜ä½¿ç”¨å¤šä¸ªå•è¯ã€‚  </span></span>
<span class="line"><span>å¯¹äºæ–¹æ³•ã€æ¥å£å’ŒåŒ…ï¼Œæ›´å–œæ¬¢ä½¿ç”¨å•ä¸ªå•è¯ã€‚  </span></span>
<span class="line"><span>è¯·è®°ä½ï¼ŒåŒ…çš„åç§°æ˜¯è°ƒç”¨è€…è°ƒç”¨åç§°çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥å¼•ç”¨è¿™ä¸ªåŒ…ï¼Œæ‰€ä»¥è¦åˆ©ç”¨å®ƒã€‚  </span></span>
<span class="line"><span>ä½¿ç”¨ç©ºç™½è¡Œæ¥åˆ†è§£å‡½æ•°çš„æµç¨‹ï¼Œå°±åƒä½¿ç”¨æ®µè½åˆ†è§£æ–‡ç« çš„æµç¨‹ä¸€æ ·ã€‚</span></span></code></pre>
<h3 id="122--ä¸Šä¸‹æ–‡æ˜¯å…³é”®">1.2.2 Â· ä¸Šä¸‹æ–‡æ˜¯å…³é”®</h3>
<h3 id="123--ä¸è¦åœ¨å˜é‡å‘½åä¸­åŠ ä¸Šç±»å‹">1.2.3 Â· ä¸è¦åœ¨å˜é‡å‘½åä¸­åŠ ä¸Šç±»å‹</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ç»™çŒ«ç‹—å‘½åä¸ä¼šå¸¦ä¸ŠçŒ«ã€ç‹—ç­‰å­—çœ¼ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>åŒ…åå’Œå˜é‡åä¸è¦é‡å¤ã€‚</span></span></code></pre>
<h3 id="124--ä½¿ç”¨ä¸€è‡´çš„å‘½åé£æ ¼">1.2.4 Â· ä½¿ç”¨ä¸€è‡´çš„å‘½åé£æ ¼</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>å‘½åå¯é¢„æ–™ï¼Œå½“é˜…è¯»è€…ç¬¬ä¸€æ¬¡é˜…è¯»æ—¶å¯ä»¥ç†è§£ã€‚</span></span>
<span class="line"><span>Goé£æ ¼æŒ‡ç¤ºæ–¹æ³•çš„æ¥æ”¶è€…æ˜¯å•ä¸ªå­—æ¯åç§°ï¼Œæˆ–ä»å…¶ç±»å‹æ´¾ç”Ÿçš„é¦–å­—æ¯ç¼©å†™è¯ã€‚</span></span></code></pre>
<h3 id="125--ä½¿ç”¨ä¸€è‡´çš„å£°æ˜é£æ ¼">1.2.5 Â· ä½¿ç”¨ä¸€è‡´çš„å£°æ˜é£æ ¼</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>goæœ‰å…­ç§ä¸åŒçš„æ–¹æ³•å»å£°æ˜å˜é‡ï¼š</span></span>
<span class="line"><span>var x int = 1</span></span>
<span class="line"><span>var x = 1</span></span>
<span class="line"><span>var x intï¼›x = 1</span></span>
<span class="line"><span>var x = int(1)</span></span>
<span class="line"><span>x := 1 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. ç”³æ˜å˜é‡ï¼Œä¸è¿›è¡Œåˆå§‹åŒ–ï¼Œä½¿ç”¨varï¼Œä¸ºé›¶å€¼ï¼Œä¸åŒ…çº§åˆ«ä½¿ç”¨varå…³é”®å­—ä¸€è‡´ ï¼š var players int ï¼›var things []Thing</span></span>
<span class="line"><span>2. å£°æ˜å˜é‡ï¼Œä¸”è¿›è¡Œåˆå§‹åŒ–ï¼Œä½¿ç”¨ ï¼š= ï¼Œè®©è¯»è€…çœ‹åˆ°å˜é‡æ˜¯åˆ»æ„è¢«åˆå§‹åŒ–çš„ï¼š </span></span>
<span class="line"><span>3. ä½¿æ£˜æ‰‹çš„å£°æ˜æ›´åŠ æ˜æ˜¾ï¼š var length uint32 = 0x80  </span></span></code></pre>
<h3 id="126--æˆä¸ºå›¢é˜Ÿåˆä½œè€…">1.2.6 Â· æˆä¸ºå›¢é˜Ÿåˆä½œè€…</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ä¿æŒå’Œå›¢é˜Ÿçš„é£æ ¼ä¸€è‡´ï¼Œæ¨èä¸€å¼€å§‹ä½¿ç”¨gofmtã€‚</span></span></code></pre>
<h2 id="13--3-æ³¨é‡Š">1.3 Â· 3. æ³¨é‡Š</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Good code has lots of comments, bad code requires lots of comments. â€” Dave Thomas and Andrew Hunt</span></span>
<span class="line"><span>æ³¨é‡Šå¯¹äºä»£ç çš„å¯è¯»æ€§æ˜¯éå¸¸é‡è¦çš„ã€‚æ¯ä¸€ä¸ªæ³¨é‡Šå¿…é¡»åšåˆ°ä»¥ä¸‹ä¸‰ç‚¹ä¹‹ä¸€ï¼š</span></span>
<span class="line"><span>1. wahtï¼Œæ³¨é‡Šåº”è¯¥è§£é‡Šåšäº†ä»€ä¹ˆï¼›  // åœ¨å…¬å¼€çš„ç¬¦å·æ˜¯ç†æƒ³å½¢å¼</span></span>
<span class="line"><span>2. howï¼Œæ³¨é‡Šåº”è¯¥è§£é‡Šæ€ä¹ˆåšçš„ï¼›  // åœ¨æ–¹æ³•å†…éƒ¨æ˜¯ç†æƒ³å½¢å¼</span></span>
<span class="line"><span>3. whyï¼Œæ³¨é‡Šåº”è¯¥è§£é‡Šä¸ºä»€ä¹ˆï¼›    // è§£é‡Šä»£ç çš„å¤–éƒ¨å› ç´ ï¼Œæ¯”å¦‚ä¸Šä¸‹æ–‡</span></span></code></pre>
<h3 id="131--å˜é‡å’Œå¸¸é‡çš„æ³¨é‡Šåº”è¯¥æè¿°å…¶å†…å®¹è€Œä¸æ˜¯ç›®çš„">1.3.1 Â· å˜é‡å’Œå¸¸é‡çš„æ³¨é‡Šåº”è¯¥æè¿°å…¶å†…å®¹ï¼Œè€Œä¸æ˜¯ç›®çš„</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ç»™å˜é‡æˆ–è€…å¸¸é‡å‘½åçš„æ—¶å€™ï¼Œéœ€è¦æè¿°å…¶ç›®çš„ï¼›</span></span>
<span class="line"><span>è€Œç»™å˜é‡æˆ–è€…å¸¸é‡æ³¨é‡Šçš„æ—¶å€™ï¼Œéœ€è¦æè¿°å…¶å†…å®¹ã€‚</span></span>
<span class="line"><span>å¯¹äºä¸€ä¸ªæ²¡æœ‰åˆå§‹åŒ–çš„å˜é‡ï¼Œæ³¨é‡Šåº”è¯¥æè¿°ç”±è°æ¥è´Ÿè´£åˆå§‹åŒ–è¿™ä¸ªå˜é‡ï¼›</span></span>
<span class="line"><span>å½“å˜é‡å‘½åéœ€è¦æ³¨é‡Šè§£é‡Šçš„æ—¶å€™ï¼Œä¹Ÿè®¸æœ€å¥½çš„å˜é‡åå°±åœ¨æ³¨é‡Šé‡Œé¢ï¼Œæ­¤æ—¶ï¼Œæ³¨é‡Šå°±æ˜¯å¤šä½™çš„ã€‚</span></span></code></pre>
<h3 id="132--å…¬å¼€ç¬¦å·å§‹ç»ˆéœ€è¦æ³¨é‡Š">1.3.2 Â· å…¬å¼€ç¬¦å·å§‹ç»ˆéœ€è¦æ³¨é‡Š</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>godocå¯ä»¥çœ‹åˆ°åŒ…çš„æ–‡æ¡£ï¼Œå› æ­¤éœ€è¦å¯¹æ‰€æœ‰çš„å…¬å¼€ç¬¦å·è¿›è¡Œæ³¨é‡Š--å£°æ˜åœ¨æ­¤åŒ…å†…çš„å˜é‡ã€å¸¸é‡ã€å‡½æ•°ã€æ–¹æ³•</span></span>
<span class="line"><span></span></span>
<span class="line"><span>googleé£æ ¼çš„æŒ‡å¯¼è§„åˆ™ï¼š</span></span>
<span class="line"><span>1. ä»»ä½•å…¬å¼€çš„å‡½æ•°ä¸æ˜¾è€Œæ˜“è§æˆ–ç®€çŸ­ï¼Œå¿…é¡»æ·»åŠ æ³¨é‡Š</span></span>
<span class="line"><span>2. ä»»ä½•åº“ä¸­çš„å‡½æ•°ï¼Œä¸ç®¡é•¿åº¦ä¸å¤æ‚åº¦ï¼Œå¿…é¡»æ·»åŠ æ³¨é‡Š</span></span>
<span class="line"><span>æœ‰ä¸€ä¸ªæ„å¤–ï¼Œå®ç°æ¥å£çš„æ–¹æ³•ï¼Œä¸éœ€è¦æ³¨é‡Šï¼›åœ¨ä½ å®ç°å‡½æ•°ä¹‹å‰ï¼Œæ·»åŠ å…¶æ³¨é‡Šï¼Œå¦‚æœä½ è§‰å¾—å†™æ³¨é‡Šå¾ˆå›°éš¾ï¼Œé‚£è¯´æ˜ä½ æ‰“ç®—ç¼–å†™çš„ä»£ç æ˜¯ä¸æ˜“ç†è§£çš„ã€‚</span></span></code></pre>
<h4 id="1321--ä¸è¦æ³¨é‡Šåä»£ç é‡å†™å®ƒ">1.3.2.1 Â· ä¸è¦æ³¨é‡Šåä»£ç ï¼Œé‡å†™å®ƒ</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Donâ€™t comment bad codeâ€‰â€”â€‰rewrite it. â€” Brian Kernighan</span></span></code></pre>
<h4 id="1322--ä¸å…¶å¯¹ä»£ç å—è¿›è¡Œæ³¨é‡Šä¸å¦‚é‡æ„å®ƒ">1.3.2.2 Â· ä¸å…¶å¯¹ä»£ç å—è¿›è¡Œæ³¨é‡Šï¼Œä¸å¦‚é‡æ„å®ƒ</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Good code is its own best documentation. As youâ€™re about to add a comment, ask yourself, 'How can I improve the code so that this comment isnâ€™t needed?' Improve the code and then document it to make it even clearer.  â€” Steve McConnell</span></span>
<span class="line"><span>å¥½çš„ä»£ç å°±æ˜¯æœ€å¥½çš„æ³¨é‡Šï¼Œå½“æ·»åŠ æ³¨é‡Šçš„æ—¶å€™ï¼Œè‡ªå·±é—®ä¸‹è‡ªå·±ï¼Œæ€ä¹ˆå¯ä»¥æé«˜ä»£ç å¯è¯»æ€§ï¼Œä½¿å¾—æ³¨é‡Šæ˜¯ä¸éœ€è¦çš„ã€‚</span></span>
<span class="line"><span>å‡½æ•°åº”è¯¥åªåšä¸€ä»¶äº‹ï¼ŒæŠ½å–å‡½æ•°ã€‚</span></span></code></pre>
<h2 id="14--4-åŒ…è®¾è®¡">1.4 Â· 4. åŒ…è®¾è®¡</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ä½¿ç”¨æ¥å£æè¿°ä½ çš„æ–¹æ³•æˆ–å‡½æ•°æ‰€éœ€è¦çš„è¡Œä¸ºã€‚</span></span>
<span class="line"><span>é˜»æ­¢ä½¿ç”¨å…¨å±€çŠ¶æ€ã€‚</span></span></code></pre>
<h2 id="15--5-é¡¹ç›®ç»“æ„">1.5 Â· 5. é¡¹ç›®ç»“æ„</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>å¼€å§‹çš„æ—¶å€™ï¼Œä¸€ä¸ªåŒ…å¯¹åº”ä¸€ä¸ªgoæ–‡ä»¶ï¼ŒæŠŠè¿™ä¸ªgoæ–‡ä»¶æ”¾åˆ°ä¸åŒ…åç›¸åŒçš„æ–‡ä»¶å¤¹ä¸­;</span></span>
<span class="line"><span>åŒ…å¼€å§‹å¢å¤§ï¼Œæ ¹æ®ä¸åŒèŒè´£æ‹†åˆ†æˆä¸åŒgoæ–‡ä»¶ï¼›</span></span>
<span class="line"><span>ä¸åŒgoæ–‡ä»¶è´Ÿè´£åŒ…çš„ä¸åŒéƒ¨åˆ†ã€‚</span></span>
<span class="line"><span></span></span>
<span class="line"><span>é¦–é€‰åè¯ä½œä¸ºgoæ–‡ä»¶åã€‚</span></span>
<span class="line"><span>goç¼–è¯‘å™¨å¹¶è¡Œç¼–è¯‘æ¯ä¸€ä¸ªåŒ…ï¼Œåœ¨ä¸€ä¸ªåŒ…å†…ï¼Œå¹¶è¡Œç¼–è¯‘å‡½æ•°ï¼Œåœ¨ä¸€ä¸ªåŒ…å†…æ”¹å˜ä»£ç å¸ƒå±€ä¸å½±å“ç¼–è¯‘æ—¶é—´ã€‚</span></span></code></pre>
<h2 id="16--6-apiè®¾è®¡">1.6 Â· 6. APIè®¾è®¡</h2>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>APIs should be easy to use and hard to misuse. â€” Josh Bloch</span></span></code></pre>
<h3 id="161--æ³¨æ„å‡½æ•°å¤šä¸ªå‚æ•°ä¸ºç›¸åŒç±»å‹æ—¶">1.6.1 Â· æ³¨æ„å‡½æ•°å¤šä¸ªå‚æ•°ä¸ºç›¸åŒç±»å‹æ—¶</h3>
<h3 id="162--é’ˆå¯¹å…¶é»˜è®¤ç”¨ä¾‹è®¾è®¡api">1.6.2 Â· é’ˆå¯¹å…¶é»˜è®¤ç”¨ä¾‹è®¾è®¡API</h3>
<h3 id="163--è®©å‡½æ•°å®šä¹‰å®ƒä»¬æ‰€éœ€è¦çš„è¡Œä¸ºæ’é™¤å…¶ä»–ä¸éœ€è¦çš„">1.6.3 Â· è®©å‡½æ•°å®šä¹‰å®ƒä»¬æ‰€éœ€è¦çš„è¡Œä¸ºï¼Œæ’é™¤å…¶ä»–ä¸éœ€è¦çš„</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>æ¥å£æè¿°è¡Œä¸ºï¼Œæ¥å£éš”ç¦»åŸç†ï¼Œé™å®šäº†æŸç§ç±»å‹ã€‚</span></span></code></pre>
<h2 id="17--7-é”™è¯¯å¤„ç†">1.7 Â· 7. é”™è¯¯å¤„ç†</h2>
<h3 id="171--é€šè¿‡æ¶ˆé™¤é”™è¯¯æ¶ˆé™¤é”™è¯¯å¤„ç†">1.7.1 Â· é€šè¿‡æ¶ˆé™¤é”™è¯¯æ¶ˆé™¤é”™è¯¯å¤„ç†</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>æ”¹å˜ä»£ç ï¼Œé¿å…é”™è¯¯ï¼Œä»è€Œé¿å…é”™è¯¯å¤„ç†ã€‚</span></span></code></pre>
<h2 id="18--8-å¹¶å‘">1.8 Â· 8. å¹¶å‘</h2>
<h3 id="181--ä½¿è‡ªå·±ä¿æŒå¿™ç¢ŒçŠ¶æ€æˆ–è€…è‡ªå·±å®Œæˆå·¥ä½œ">1.8.1 Â· ä½¿è‡ªå·±ä¿æŒå¿™ç¢ŒçŠ¶æ€æˆ–è€…è‡ªå·±å®Œæˆå·¥ä½œ</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>é¢„æœŸè®©åˆ«äººä»£ç†ï¼Œç­‰å¾…ç»“æœï¼Œä¸å¦‚è‡ªå·±åšã€‚</span></span></code></pre>
<h3 id="182--å°†å¹¶å‘ç•™ç»™è°ƒç”¨è€…">1.8.2 Â· å°†å¹¶å‘ç•™ç»™è°ƒç”¨è€…</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>å¦‚æœå¼€å¯äº†ä¸€ä¸ªgoroutineï¼Œéœ€è¦æ˜¾ç¤ºçš„æä¾›æš‚åœgoroutineçš„æ–¹æ³•ç»™è°ƒç”¨è€…ã€‚</span></span></code></pre>
<h3 id="183--å¦‚æœä¸çŸ¥é“è¦å¼€å¯çš„goroutineä»€ä¹ˆæ—¶å€™ç»“æŸé‚£å°±ä¸è¦å¼€å¯å®ƒ">1.8.3 Â· å¦‚æœä¸çŸ¥é“è¦å¼€å¯çš„goroutineä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œé‚£å°±ä¸è¦å¼€å¯å®ƒã€‚</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>goroutineå†…éƒ¨ç­‰å¾…å¤–éƒ¨çš„stop channelçš„å…³é—­ï¼Œä»è€Œåœæ­¢goroutineå†…éƒ¨çš„é€»è¾‘ï¼›</span></span>
<span class="line"><span>å¤–éƒ¨stop channelç­‰å¾…goroutineå¤„ç†å®Œæˆï¼Œä¼ é€doneä¿¡æ¯ç»™å¤–éƒ¨ï¼Œä»è€Œå¤–éƒ¨stop channelå…³é—­ã€‚</span></span></code></pre>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">	func</span><span style="color:#88C0D0"> serve</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">addr</span><span style="color:#81A1C1"> string</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> handler</span><span style="color:#D8DEE9"> http</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">Handler</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> stop</span><span style="color:#81A1C1"> &#x3C;-chan</span><span style="color:#81A1C1"> struct</span><span style="color:#ECEFF4">{})</span><span style="color:#81A1C1"> error</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">		s</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9FF"> http</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">Server</span><span style="color:#ECEFF4">{</span></span>
<span class="line"><span style="color:#D8DEE9">			Addr</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9">    addr</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#D8DEE9">			Handler</span><span style="color:#ECEFF4">:</span><span style="color:#D8DEE9"> handler</span><span style="color:#ECEFF4">,</span></span>
<span class="line"><span style="color:#ECEFF4">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">		go</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">			&#x3C;-</span><span style="color:#D8DEE9">stop</span><span style="color:#616E88"> // wait for stop signal</span></span>
<span class="line"><span style="color:#D8DEE9">			s</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Shutdown</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">context</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Background</span><span style="color:#ECEFF4">())</span></span>
<span class="line"><span style="color:#ECEFF4">		}()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">		return</span><span style="color:#D8DEE9"> s</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">ListenAndServe</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#ECEFF4">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">	func</span><span style="color:#88C0D0"> serveApp</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">stop</span><span style="color:#81A1C1"> &#x3C;-chan</span><span style="color:#81A1C1"> struct</span><span style="color:#ECEFF4">{})</span><span style="color:#81A1C1"> error</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">		mux</span><span style="color:#81A1C1"> :=</span><span style="color:#D8DEE9"> http</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">NewServeMux</span><span style="color:#ECEFF4">()</span></span>
<span class="line"><span style="color:#D8DEE9">		mux</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">HandleFunc</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">/</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">resp</span><span style="color:#D8DEE9FF"> http</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">ResponseWriter</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> req</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">http</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">Request</span><span style="color:#ECEFF4">)</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">			fmt</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Fprintln</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">resp</span><span style="color:#ECEFF4">,</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">Hello, QCon!</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">		})</span></span>
<span class="line"><span style="color:#81A1C1">		return</span><span style="color:#88C0D0"> serve</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">0.0.0.0:8080</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> mux</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> stop</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">	func</span><span style="color:#88C0D0"> serveDebug</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">stop</span><span style="color:#81A1C1"> &#x3C;-chan</span><span style="color:#81A1C1"> struct</span><span style="color:#ECEFF4">{})</span><span style="color:#81A1C1"> error</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">		return</span><span style="color:#88C0D0"> serve</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">127.0.0.1:8001</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> http</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">DefaultServeMux</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> stop</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">	func</span><span style="color:#88C0D0"> main</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">		done</span><span style="color:#81A1C1"> :=</span><span style="color:#88C0D0"> make</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">chan</span><span style="color:#81A1C1"> error</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 2</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#D8DEE9">		stop</span><span style="color:#81A1C1"> :=</span><span style="color:#88C0D0"> make</span><span style="color:#ECEFF4">(</span><span style="color:#81A1C1">chan</span><span style="color:#81A1C1"> struct</span><span style="color:#ECEFF4">{})</span></span>
<span class="line"><span style="color:#81A1C1">		go</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">			done</span><span style="color:#81A1C1"> &#x3C;-</span><span style="color:#88C0D0"> serveDebug</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">stop</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">		}()</span></span>
<span class="line"><span style="color:#81A1C1">		go</span><span style="color:#81A1C1"> func</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">			done</span><span style="color:#81A1C1"> &#x3C;-</span><span style="color:#88C0D0"> serveApp</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">stop</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">		}()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">		var</span><span style="color:#D8DEE9"> stopped</span><span style="color:#81A1C1"> bool</span></span>
<span class="line"><span style="color:#81A1C1">		for</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> :=</span><span style="color:#B48EAD"> 0</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1"> &#x3C;</span><span style="color:#88C0D0"> cap</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">done</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> i</span><span style="color:#81A1C1">++</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">			if</span><span style="color:#D8DEE9"> err</span><span style="color:#81A1C1"> :=</span><span style="color:#81A1C1"> &#x3C;-</span><span style="color:#D8DEE9">done</span><span style="color:#81A1C1">;</span><span style="color:#D8DEE9"> err</span><span style="color:#81A1C1"> !=</span><span style="color:#81A1C1"> nil</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">				fmt</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Println</span><span style="color:#ECEFF4">(</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">error: </span><span style="color:#EBCB8B">%v</span><span style="color:#ECEFF4">"</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> err</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">			}</span></span>
<span class="line"><span style="color:#81A1C1">			if</span><span style="color:#81A1C1"> !</span><span style="color:#D8DEE9">stopped</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">				stopped</span><span style="color:#81A1C1"> =</span><span style="color:#81A1C1"> true</span></span>
<span class="line"><span style="color:#88C0D0">				close</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">stop</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">			}</span></span>
<span class="line"><span style="color:#ECEFF4">		}</span></span>
<span class="line"><span style="color:#ECEFF4">	}</span></span></code></pre> <!-- Diagrams rendered at build time -->  </article> <nav class="mt-12 pt-8 border-t border-nord-4 dark:border-nord-1" data-astro-cid-v5yihett> <a href="/notes" class="btn-primary" data-astro-cid-v5yihett> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-v5yihett> <path d="M15 19l-7-7 7-7" data-astro-cid-v5yihett></path> </svg>
Back to Notes
</a> </nav>  </main> <footer class="border-t border-nord-5 dark:border-nord-1 mt-12"> <div class="max-w-4xl mx-auto px-4 py-6 text-sm text-nord-3 dark:text-nord-4 text-center"> <p>&copy; 2026. All rights reserved.</p> </div> </footer> <script type="module" src="/_astro/Base.astro_astro_type_script_index_0_lang.WDMQca9J.js"></script> <script>
      (function() {
        const root = document.getElementById('series-dropdown-root');
        const trigger = document.getElementById('series-dropdown-trigger');
        const panel = document.getElementById('series-dropdown-panel');
        const listEl = document.getElementById('series-dropdown-list');
        if (!root || !trigger || !panel || !listEl) return;

        let seriesList = null;
        let hoverTimeout = null;

        function open() {
          panel.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
          if (seriesList === null) {
            fetch('/series-list.json')
              .then((r) => r.json())
              .then((list) => {
                seriesList = list;
                if (list.length === 0) {
                  listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">æš‚æ— ç³»åˆ—</span>';
                } else {
                  listEl.innerHTML = list.map(function(name) {
                     const slug = name.toLowerCase().replace(/\s+/g, '-');
                     const url = '/notes/series/' + slug;
                     return '<a href="' + url + '" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors" role="menuitem">' + escapeHtml(name) + '</a>';
                   }).join('');
                }
              })
              .catch(function() {
                listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-11">åŠ è½½å¤±è´¥</span>';
              });
          }
        }

        function close() {
          panel.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        }

        function escapeHtml(s) {
          const div = document.createElement('div');
          div.textContent = s;
          return div.innerHTML;
        }

        // On click: allow default navigation to /notes/series
        // On hover: show dropdown menu
        trigger.addEventListener('click', function(e) {
          e.stopPropagation();
          // Don't preventDefault - allow link to navigate
        });

        trigger.addEventListener('mouseenter', function() {
          if (hoverTimeout) clearTimeout(hoverTimeout);
          hoverTimeout = setTimeout(open, 200);
        });

        root.addEventListener('mouseleave', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
          hoverTimeout = setTimeout(close, 150);
        });

        panel.addEventListener('mouseenter', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
        });

        document.addEventListener('click', function(e) {
          if (!root.contains(e.target)) close();
        });
      })();
    </script> <script>
      (function() {
        const root = document.getElementById('tags-dropdown-root');
        const trigger = document.getElementById('tags-dropdown-trigger');
        const panel = document.getElementById('tags-dropdown-panel');
        const listEl = document.getElementById('tags-dropdown-list');
        if (!root || !trigger || !panel || !listEl) return;

        let tagList = null;
        let hoverTimeout = null;

        function open() {
          panel.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
          if (tagList === null) {
            fetch('/tag-list.json')
              .then((r) => r.json())
              .then((list) => {
                tagList = list;
                if (list.length === 0) {
                  listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">æš‚æ— æ ‡ç­¾</span>';
                } else {
                  listEl.innerHTML = list.map(function(tag) {
                     const url = '/notes/tag/' + encodeURIComponent(tag);
                     return '<a href="' + url + '" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors" role="menuitem">' + escapeHtml(tag) + '</a>';
                   }).join('');
                }
              })
              .catch(function() {
                listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-11">åŠ è½½å¤±è´¥</span>';
              });
          }
        }

        function close() {
          panel.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        }

        function escapeHtml(s) {
          const div = document.createElement('div');
          div.textContent = s;
          return div.innerHTML;
        }

        trigger.addEventListener('click', function(e) {
          e.stopPropagation();
        });

        trigger.addEventListener('mouseenter', function() {
          if (hoverTimeout) clearTimeout(hoverTimeout);
          hoverTimeout = setTimeout(open, 200);
        });

        root.addEventListener('mouseleave', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
          hoverTimeout = setTimeout(close, 150);
        });

        panel.addEventListener('mouseenter', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
        });

        document.addEventListener('click', function(e) {
          if (!root.contains(e.target)) close();
        });
      })();
    </script> </body> </html>  <script>
  // Language aliases (matches server-side)
  const langAliases = {
    js: 'javascript',
    ts: 'typescript',
    yml: 'yaml',
    yaml: 'yaml',
    sh: 'bash',
    shell: 'bash',
    sql: 'postgresql',
    java: 'openjdk',
  };

  // Add headers and copy buttons to code blocks
  function initCodeBlocks() {
    document.querySelectorAll('pre[data-language]').forEach((pre) => {
      // Skip if already processed
      if (pre.parentNode.classList.contains('code-block-wrapper')) return;
      
      const lang = pre.getAttribute('data-language') || 'code';
      
      // Create wrapper
      const wrapper = document.createElement('div');
      wrapper.className = 'code-block-wrapper';
      pre.parentNode.insertBefore(wrapper, pre);
      wrapper.appendChild(pre);
      
      // Create header
      const header = document.createElement('div');
      header.className = 'code-header';
      
      const langSpan = document.createElement('span');
      langSpan.className = 'code-header-lang';
      langSpan.title = lang;
      
      // Normalize lang for devicon
      const normalizedLang = lang.toLowerCase();
      const iconLang = langAliases[normalizedLang] || normalizedLang;
      
      // Display language with devicon (format: devicon-{name}-{version} colored)
      const iconEl = document.createElement('i');
      iconEl.className = `devicon-${iconLang}-plain colored`;
      iconEl.style.marginRight = '0.375rem';
      iconEl.style.fontSize = '0.75rem';
      langSpan.appendChild(iconEl);
      langSpan.appendChild(document.createTextNode(lang));
      
      const button = document.createElement('button');
      button.className = 'copy-code-btn';
      button.title = 'Copy to clipboard';
      button.innerHTML = '<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
      
      let isCopying = false;
      button.addEventListener('click', async () => {
        if (isCopying) return;
        isCopying = true;
        
        const code = pre.querySelector('code')?.textContent || '';
        try {
          await navigator.clipboard.writeText(code);
          const originalHtml = button.innerHTML;
          button.innerHTML = '<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>';
          button.title = 'Copied!';
          setTimeout(() => {
            button.innerHTML = originalHtml;
            button.title = 'Copy to clipboard';
            isCopying = false;
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
          isCopying = false;
        }
      });
      
      header.appendChild(langSpan);
      header.appendChild(button);
      wrapper.appendChild(header);
    });
  }

  // Run ASAP, then on DOMContentLoaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCodeBlocks);
  } else {
    initCodeBlocks();
  }

  // Convert wikilinks to links on client side
  // Matches [[ref]] or [[ref|display text]]
  document.addEventListener('DOMContentLoaded', () => {
    const wikiRegex = /\[\[([a-zA-Z0-9][a-zA-Z0-9_-]*?)(?:\|([^\]]+))?\]\]/g;
    
    // Process all text nodes in prose content
    const walker = document.createTreeWalker(
      document.querySelector('.prose') || document.body,
      NodeFilter.SHOW_TEXT,
      null,
      false
    );
    
    const nodesToReplace = [];
    let node;
    
    while (node = walker.nextNode()) {
      if (node.nodeValue.includes('[[')) {
        nodesToReplace.push(node);
      }
    }
    
    nodesToReplace.forEach((textNode) => {
      const parent = textNode.parentNode;
      let lastIndex = 0;
      const matches = [...textNode.nodeValue.matchAll(wikiRegex)];
      
      if (matches.length === 0) return;
      
      const fragment = document.createDocumentFragment();
      
      matches.forEach((match) => {
        const [fullMatch, ref, displayText] = match;
        const startIndex = match.index;
        
        // Add text before match
        if (startIndex > lastIndex) {
          fragment.appendChild(
            document.createTextNode(textNode.nodeValue.slice(lastIndex, startIndex))
          );
        }
        
        // Create link
        const link = document.createElement('a');
        link.href = `/notes/${ref.toLowerCase()}`;
        link.textContent = (displayText || ref).trim();
        link.className = 'text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-colors';
        fragment.appendChild(link);
        
        lastIndex = startIndex + fullMatch.length;
      });
      
      // Add remaining text
      if (lastIndex < textNode.nodeValue.length) {
        fragment.appendChild(
          document.createTextNode(textNode.nodeValue.slice(lastIndex))
        );
      }
      
      parent.replaceChild(fragment, textNode);
    });
  });
</script> 