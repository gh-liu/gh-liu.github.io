<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Blog"><title>Go: compile ç¼–è¯‘å™¨</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.16.0/devicon.min.css"><script>
      // This script runs synchronously in the head to prevent FOUC (Flash of Unstyled Content)
      (function() {
        const THEME_KEY = 'nord-theme';
        const DARK = 'dark';
        
        function getStoredTheme() {
          try {
            return localStorage.getItem(THEME_KEY);
          } catch {
            return null;
          }
        }
        
        function getSystemTheme() {
          return window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : 'light';
        }
        
        function getTheme() {
          return getStoredTheme() || getSystemTheme();
        }
        
        function applyTheme(theme) {
          const html = document.documentElement;
          if (theme === DARK) {
            html.classList.add('dark');
          } else {
            html.classList.remove('dark');
          }
        }
        
        // Apply theme immediately before page renders
        applyTheme(getTheme());
      })();
    </script><link rel="stylesheet" href="/_astro/_id_.6ed6JusR.css">
<style>.knowledge-graph-container[data-astro-cid-zjb43jqo]{border:1px solid var(--nord-4);border-radius:8px;background:var(--nord-6);position:relative;overflow:hidden}.knowledge-graph-container[data-astro-cid-zjb43jqo]:fullscreen,.knowledge-graph-container[data-astro-cid-zjb43jqo]::-webkit-full-screen{width:100vw;height:100vh;border-radius:0}.knowledge-graph-container[data-astro-cid-zjb43jqo]:fullscreen .knowledge-graph-wrapper[data-astro-cid-zjb43jqo],.knowledge-graph-container[data-astro-cid-zjb43jqo]::-webkit-full-screen .knowledge-graph-wrapper[data-astro-cid-zjb43jqo]{width:100%;height:100%}.knowledge-graph-toolbar{position:absolute;top:8px;right:8px;z-index:10;display:flex;gap:4px;align-items:center}.knowledge-graph-toolbar-btn{width:32px;height:32px;padding:0;border:1px solid var(--nord-4);border-radius:6px;background:var(--nord-6);color:var(--nord-2);font-size:16px;font-weight:600;line-height:1;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .15s,color .15s}.knowledge-graph-toolbar-btn:hover{background:var(--nord-5);color:var(--nord-10)}.knowledge-graph-toolbar-btn:active{background:var(--nord-4)}.knowledge-graph-wrapper[data-astro-cid-zjb43jqo]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.knowledge-graph-node{cursor:pointer;stroke:#5e81ac;stroke-width:2.5px;transition:all .2s ease}.knowledge-graph-node:hover{stroke-width:2.5px;filter:brightness(1.2)}.knowledge-graph-node.active{stroke:var(--nord-14);stroke-width:3px;filter:drop-shadow(0 0 8px rgba(191,97,106,.5))}.knowledge-graph-node--current{stroke:var(--nord-10);stroke-width:3px;filter:drop-shadow(0 0 6px rgba(94,129,172,.6))}.knowledge-graph-node--outlink{stroke:var(--nord-14);stroke-width:2.5px}.knowledge-graph-node--backlink{stroke:var(--nord-15);stroke-width:2.5px}.knowledge-graph-node--both{stroke:var(--nord-12);stroke-width:2.5px}.knowledge-graph-node--neighbor{stroke:var(--nord-4);stroke-width:2px;opacity:.9}.knowledge-graph-link{stroke:#4c566a;stroke-opacity:.85;stroke-width:2px}.knowledge-graph-link.active{stroke:var(--nord-11);stroke-opacity:.9;stroke-width:2px}.knowledge-graph-label{pointer-events:none;font-size:11px;text-anchor:middle;fill:var(--nord-1);font-weight:500;text-shadow:0 0 3px var(--nord-6)}.knowledge-graph-tooltip{position:absolute;padding:8px 12px;background:var(--nord-0);border:1px solid var(--nord-3);border-radius:4px;font-size:12px;color:var(--nord-6);pointer-events:none;z-index:1000;box-shadow:0 2px 8px #0000004d;white-space:nowrap}.knowledge-graph-tooltip-type{color:var(--nord-8);font-size:11px}.knowledge-graph-legend{position:absolute;bottom:8px;left:8px;z-index:10;display:flex;flex-wrap:wrap;gap:8px 12px;font-size:11px;color:var(--nord-2)}.kg-legend-item{display:inline-flex;align-items:center;gap:4px}.kg-legend--current{color:var(--nord-10)}.kg-legend--outlink{color:var(--nord-14)}.kg-legend--backlink{color:var(--nord-15)}.kg-legend--both{color:var(--nord-12)}.kg-legend--neighbor{color:var(--nord-4);opacity:.9}
html{scroll-behavior:smooth}article[data-astro-cid-v5yihett]{word-break:break-word}
</style></head> <body class="text-nord-3 dark:text-nord-5 transition-all bg-gradient-light"> <header class="border-b border-nord-5 dark:border-nord-1 bg-nord-6 dark:bg-nord-0"> <nav class="max-w-4xl mx-auto px-4 py-5 flex items-center justify-between gap-4"> <div class="flex items-center gap-2 min-w-0"> <a href="/" title="Liu" class="shrink-0 p-1.5 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-lg dark:hover:shadow-nord-8/20 active:scale-95"> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"> <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path> <circle cx="12" cy="7" r="4"></circle> </svg> </a> <h1 class="text-xl font-bold truncate"> <a href="/" class="text-nord-2 dark:text-nord-6 hover:text-nord-10 dark:hover:text-nord-8 transition-colors"> Liu </a> </h1> </div> <div class="flex items-center gap-2 shrink-0"> <a href="https://github.com/gh-liu" title="GitHub" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-label="GitHub"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </svg> </a> <a href="https://x.com" title="X" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-label="X"> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24h-6.657l-5.207-6.807-5.975 6.807H2.306l7.644-8.74-8.179-10.76h6.467l4.713 6.231 5.429-6.231zM17.002 18.807h1.844L6.983 4.126H5.025l11.977 14.681z"></path> </svg> </a> <span class="w-px h-4 bg-nord-4 dark:bg-nord-2 shrink-0" aria-hidden="true"></span> <div class="relative series-dropdown" id="series-dropdown-root"> <a href="/notes/series" title="Series" aria-expanded="false" aria-haspopup="true" aria-controls="series-dropdown-panel" id="series-dropdown-trigger" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M4 6h16M4 12h16M4 18h16"></path> </svg> </a> <div id="series-dropdown-panel" class="absolute right-0 top-full mt-1 py-2 min-w-[12rem] max-h-[70vh] overflow-y-auto rounded-lg border border-nord-4 dark:border-nord-2 bg-nord-6 dark:bg-nord-1 shadow-lg z-50 hidden" role="menu"> <div id="series-dropdown-list" class="py-1"> <span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">åŠ è½½ä¸­â€¦</span> </div> <div class="border-t border-nord-4 dark:border-nord-2 pt-1 mt-1"> <a href="/notes/series" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors">
æŸ¥çœ‹å…¨éƒ¨ç³»åˆ— â†’
</a> </div> </div> </div> <div class="relative tags-dropdown" id="tags-dropdown-root"> <a href="/notes/tags" title="Tags" aria-expanded="false" aria-haspopup="true" aria-controls="tags-dropdown-panel" id="tags-dropdown-trigger" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex active:scale-95"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> </a> <div id="tags-dropdown-panel" class="absolute right-0 top-full mt-1 py-2 min-w-[12rem] max-h-[70vh] overflow-y-auto rounded-lg border border-nord-4 dark:border-nord-2 bg-nord-6 dark:bg-nord-1 shadow-lg z-50 hidden" role="menu"> <div id="tags-dropdown-list" class="py-1"> <span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">åŠ è½½ä¸­â€¦</span> </div> <div class="border-t border-nord-4 dark:border-nord-2 pt-1 mt-1"> <a href="/notes/tags" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors">
æŸ¥çœ‹å…¨éƒ¨æ ‡ç­¾ â†’
</a> </div> </div> </div> <div class="search-container" id="search-wrapper" data-astro-cid-t47yvtpn><button id="search-toggle" class="p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-2 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 transition-all duration-300 ease-out hover:scale-110 hover:shadow-md dark:hover:shadow-md dark:hover:shadow-nord-8/15 inline-flex" aria-label="Search notes" title="Search (âŒ˜K)" data-astro-cid-t47yvtpn><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-t47yvtpn><circle cx="11" cy="11" r="8" data-astro-cid-t47yvtpn></circle><path d="m21 21-4.35-4.35" data-astro-cid-t47yvtpn></path></svg></button><div id="search-modal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-50 flex items-start justify-center pt-20 backdrop-blur-sm" data-astro-cid-t47yvtpn><div class="bg-nord-6 dark:bg-nord-0 rounded-2xl shadow-2xl w-full max-w-2xl border border-nord-5 dark:border-nord-1 max-h-[70vh] flex flex-col overflow-hidden animate-fade-in" data-astro-cid-t47yvtpn><div class="p-4 border-b border-nord-5 dark:border-nord-1" data-astro-cid-t47yvtpn><input type="search" id="search-input" placeholder="Search notes... (use #tag for tag search)" class="w-full px-4 py-2 bg-nord-5 dark:bg-nord-1 text-nord-2 dark:text-nord-6 placeholder-nord-3 dark:placeholder-nord-4 rounded focus:outline-none focus:ring-2 focus:ring-nord-9 dark:focus:ring-nord-8" autocomplete="off" data-astro-cid-t47yvtpn></div><div id="search-results" class="flex-1 overflow-y-auto p-4" data-astro-cid-t47yvtpn><p class="text-nord-3 dark:text-nord-5 text-sm" data-astro-cid-t47yvtpn>Type to search...</p></div><div class="p-3 border-t border-nord-5 dark:border-nord-1 text-xs text-nord-3 dark:text-nord-4" data-astro-cid-t47yvtpn><p data-astro-cid-t47yvtpn>Press <kbd class="px-1 py-0.5 bg-nord-4 dark:bg-nord-2 rounded" data-astro-cid-t47yvtpn>Esc</kbd> to close | Use <kbd class="px-1 py-0.5 bg-nord-4 dark:bg-nord-2 rounded" data-astro-cid-t47yvtpn>#tag</kbd> to search by tag</p></div></div></div></div><script>(function(){const pagefindUrl = "/pagefind/pagefind.js";

  if (!globalThis.pagefindLoaded) {
    globalThis.pagefindLoaded = true;
    
    let pagefind;
    let searchInput;
    let searchModal;
    let searchResults;
    let isSearchOpen = false;

    async function initSearch() {
      if (typeof window === "undefined") return;

      try {
        pagefind = await import(pagefindUrl);
        await pagefind.init();
      } catch (error) {
        console.log("Search not available.", error);
        return;
      }

      searchInput = document.getElementById("search-input");
      searchModal = document.getElementById("search-modal");
      searchResults = document.getElementById("search-results");
      const toggleBtn = document.getElementById("search-toggle");

      if (!searchInput || !searchModal || !searchResults || !toggleBtn) return;

      toggleBtn.addEventListener("click", () => {
        openSearch();
      });

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          closeSearch();
        }
        if ((e.metaKey || e.ctrlKey) && e.key === "k") {
          e.preventDefault();
          isSearchOpen ? closeSearch() : openSearch();
        }
      });

      searchModal.addEventListener("click", (e) => {
        if (e.target === searchModal) closeSearch();
      });

      searchInput.addEventListener("input", async (e) => {
        const query = e.target.value.trim();
        if (!query) {
          searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">Type to search...</p>';
          return;
        }

        // Check if query starts with #tag
        const isTagSearch = query.startsWith('#');
        let results;
        
        if (isTagSearch) {
          // Tag search
          const tag = query.slice(1).toUpperCase();
          results = await pagefind.search(`tag:${tag}`);
        } else {
          // Regular text search
          results = await pagefind.search(query);
        }

        if (results.results.length === 0) {
          searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">No results found.</p>';
          return;
        }

        let html = '<ul class="space-y-2">';
        for (const result of results.results) {
          const data = await result.data();
          // Extract title from h1 or use URL slug as fallback
          const title = data.meta?.title || data.title || (data.url.split('/').pop() || 'untitled').replace(/-/g, ' ');
          html += `<li><a href="${data.url}" class="block p-3 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-2 text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-all hover:shadow-md duration-200 border border-transparent hover:border-nord-9 dark:hover:border-nord-8"><div class="font-medium">${title}</div><div class="text-xs text-nord-3 dark:text-nord-5 mt-1 line-clamp-2">${data.excerpt || ""}</div></a></li>`;
        }
        searchResults.innerHTML = html + "</ul>";
      });
    }

    function openSearch() {
      isSearchOpen = true;
      searchModal.classList.remove("hidden");
      searchInput.focus();
      document.body.style.overflow = "hidden";
    }

    function closeSearch() {
      isSearchOpen = false;
      searchModal.classList.add("hidden");
      searchInput.value = "";
      searchResults.innerHTML = '<p class="text-nord-3 dark:text-nord-5 text-sm">Type to search...</p>';
      document.body.style.overflow = "";
    }

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initSearch);
    } else {
      initSearch();
    }
  }
})();</script> <button id="theme-toggle" aria-label="Toggle theme" title="Toggle theme" class="group relative p-2 rounded-lg hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-3 dark:text-nord-4 transition-all duration-200 ease-out hover:scale-110 inline-flex"> <span class="inline-block transition-transform duration-200 ease-out group-hover:rotate-12"> <svg id="sun-icon" class="w-4 h-4 text-nord-13 hidden dark:block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <circle cx="12" cy="12" r="5"></circle> <line x1="12" y1="1" x2="12" y2="3"></line> <line x1="12" y1="21" x2="12" y2="23"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line> <line x1="1" y1="12" x2="3" y2="12"></line> <line x1="21" y1="12" x2="23" y2="12"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line> </svg> <svg id="moon-icon" class="w-4 h-4 text-nord-9 block dark:hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path> </svg> </span> </button> <script>
  const THEME_KEY = 'nord-theme';
  const DARK = 'dark';
  
  function getStoredTheme() {
    return localStorage.getItem(THEME_KEY);
  }
  
  function getSystemTheme() {
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : 'light';
  }
  
  function getTheme() {
    return getStoredTheme() || getSystemTheme();
  }
  
  function applyTheme(theme) {
    const html = document.documentElement;
    if (theme === DARK) {
      html.classList.add('dark');
    } else {
      html.classList.remove('dark');
    }
  }
  
  function toggleTheme() {
    const currentTheme = getTheme();
    const newTheme = currentTheme === DARK ? 'light' : DARK;
    localStorage.setItem(THEME_KEY, newTheme);
    applyTheme(newTheme);
  }
  
  const themeToggle = document.getElementById('theme-toggle');
  if (themeToggle) {
    themeToggle.addEventListener('click', toggleTheme);
  }
</script> </div> </nav> </header> <main class="max-w-4xl mx-auto px-4 py-12" data-pagefind-body> <aside id="toc-sidebar" class="fixed left-0 top-0 h-screen w-56 bg-nord-6 dark:bg-nord-0 border-r border-nord-5 dark:border-nord-1 overflow-y-auto overflow-x-hidden pt-4 pb-4 transition-transform duration-300 -translate-x-full z-50" data-astro-cid-vrmg3htk> <nav class="px-4 space-y-1" data-astro-cid-vrmg3htk> <!-- Close button --> <button id="toc-close" class="flex justify-end w-full mb-4 p-2 text-nord-2 dark:text-nord-6 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors" aria-label="Close navigation" data-astro-cid-vrmg3htk> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-vrmg3htk> <path d="M18 6L6 18M6 6l12 12" data-astro-cid-vrmg3htk></path> </svg> </button> <h3 class="text-xs font-bold text-nord-2 dark:text-nord-6 uppercase tracking-widest px-2 py-3 border-b border-nord-5 dark:border-nord-1" data-astro-cid-vrmg3htk>
On this page
</h3> <ul class="space-y-0.5 text-sm mt-4" data-astro-cid-vrmg3htk> <li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#11--å¿«é€Ÿæ¦‚è§ˆç¼–è¯‘æµç¨‹" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.1 Â· å¿«é€Ÿæ¦‚è§ˆï¼šç¼–è¯‘æµç¨‹ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#12--ç¼–è¯‘å·¥å…·ä¸ä½¿ç”¨ç¤ºä¾‹" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.2 Â· ç¼–è¯‘å·¥å…·ä¸ä½¿ç”¨ç¤ºä¾‹ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#121--å·¥å…·é“¾æ¦‚è§ˆ" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.1 Â· å·¥å…·é“¾æ¦‚è§ˆ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#122--ç¤ºä¾‹ç¼–è¯‘ä¸€ä¸ªç®€å•çš„-go-ç¨‹åº" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.2 Â· ç¤ºä¾‹ï¼šç¼–è¯‘ä¸€ä¸ªç®€å•çš„ Go ç¨‹åº </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#123--å®é™…ç”¨é€”ç¤ºä¾‹" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.2.3 Â· å®é™…ç”¨é€”ç¤ºä¾‹ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#13--ç¼–è¯‘ç»†èŠ‚æ·±å…¥" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.3 Â· ç¼–è¯‘ç»†èŠ‚æ·±å…¥ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#131--å‰ç«¯è¯¦è§£" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.1 Â· å‰ç«¯è¯¦è§£ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#132--ä¸­ç«¯ä¼˜åŒ–é˜¶æ®µ" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.2 Â· ä¸­ç«¯ï¼šä¼˜åŒ–é˜¶æ®µ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#133--walk-é˜¶æ®µ" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.3 Â· Walk é˜¶æ®µ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#134--åŒ…åˆå§‹åŒ–" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.4 Â· åŒ…åˆå§‹åŒ– </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#135--ä¼˜åŒ–é˜¶æ®µ" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.5 Â· ä¼˜åŒ–é˜¶æ®µ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#136--åç«¯è¯¦è§£" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.3.6 Â· åç«¯è¯¦è§£ </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#14--ç¼–è¯‘æµç¨‹æ€»ç»“" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.4 Â· ç¼–è¯‘æµç¨‹æ€»ç»“ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#141--å®Œæ•´ç¼–è¯‘é“¾" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.4.1 Â· å®Œæ•´ç¼–è¯‘é“¾ </a> </li><li class="toc-item pl-4" data-astro-cid-vrmg3htk> <a href="#142--ä¼˜åŒ–å‘ç”Ÿçš„ä½ç½®" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="3" data-astro-cid-vrmg3htk> 1.4.2 Â· ä¼˜åŒ–å‘ç”Ÿçš„ä½ç½® </a> </li><li class="toc-item pl-0" data-astro-cid-vrmg3htk> <a href="#15--å‚è€ƒèµ„æº" class="block py-1.5 px-2 text-nord-3 dark:text-nord-5 hover:text-nord-9 dark:hover:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-1 rounded transition-colors truncate" data-depth="2" data-astro-cid-vrmg3htk> 1.5 Â· å‚è€ƒèµ„æº </a> </li> </ul> </nav> </aside> <!-- Toggle button - fixed at left edge --> <button id="toc-toggle" class="fixed left-0 top-4 p-3 rounded-r-lg bg-nord-9 dark:bg-nord-8 text-nord-6 dark:text-nord-0 hover:bg-nord-10 dark:hover:bg-nord-7 hover:text-nord-6 dark:hover:text-nord-0 transition-colors shadow-lg z-40" aria-label="Toggle sidebar" title="Toggle sidebar (â† â†’)" data-astro-cid-vrmg3htk> <svg id="toggle-icon" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-vrmg3htk> <path d="M4 6h16M4 12h16M4 18h16" data-astro-cid-vrmg3htk></path> </svg> </button> <script>
  const TOC_KEY = 'toc-open';
  const sidebar = document.getElementById('toc-sidebar');
  const toggle = document.getElementById('toc-toggle');
  const closeBtn = document.getElementById('toc-close');

  function getSidebarState() {
    return localStorage.getItem(TOC_KEY) !== 'false';
  }

  function setSidebarState(open) {
    localStorage.setItem(TOC_KEY, open ? 'true' : 'false');
  }

  function updateSidebar() {
    const isOpen = getSidebarState();
    if (sidebar) {
      if (isOpen) {
        sidebar.classList.remove('-translate-x-full');
      } else {
        sidebar.classList.add('-translate-x-full');
      }
    }
  }

  function toggleSidebar() {
    const isOpen = getSidebarState();
    setSidebarState(!isOpen);
    updateSidebar();
  }

  // Initialize
  updateSidebar();

  // Event listeners
  if (toggle) {
    toggle.addEventListener('click', toggleSidebar);
  }

  if (closeBtn) {
    closeBtn.addEventListener('click', toggleSidebar);
  }

  // Keyboard shortcut: left/right arrow to toggle
  document.addEventListener('keydown', (e) => {
    if ((e.key === 'ArrowLeft' || e.key === 'ArrowRight') && e.ctrlKey) {
      e.preventDefault();
      toggleSidebar();
    }
  });

  // Highlight current section on scroll
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          document.querySelectorAll('.toc-item a').forEach((link) => {
            link.classList.remove('text-nord-9', 'dark:text-nord-8', 'font-semibold', 'bg-nord-5', 'dark:bg-nord-1');
            link.classList.add('text-nord-3', 'dark:text-nord-4');
          });
          const activeLink = document.querySelector(
            `.toc-item a[href="#${entry.target.id}"]`
          );
          if (activeLink) {
            activeLink.classList.remove('text-nord-3', 'dark:text-nord-4');
            activeLink.classList.add('text-nord-9', 'dark:text-nord-8', 'font-semibold', 'bg-nord-5', 'dark:bg-nord-1');
          }
        }
      });
    },
    { rootMargin: '-50% 0px -50% 0px' }
  );

  document.querySelectorAll('h2, h3').forEach((heading) => {
    if (heading.id) {
      observer.observe(heading);
    }
  });

  // Close sidebar on link click
  document.querySelectorAll('.toc-item a').forEach((link) => {
    link.addEventListener('click', () => {
      setSidebarState(false);
      updateSidebar();
    });
  });
</script>  <article class="prose prose-nord dark:prose-nord max-w-none
      prose-headings:font-serif
      prose-code:before:content-none prose-code:after:content-none" data-astro-cid-v5yihett> <header class="mb-8" data-astro-cid-v5yihett> <h1 class="mb-3" data-pagefind-meta="title" data-astro-cid-v5yihett>Go: compile ç¼–è¯‘å™¨</h1> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4" data-astro-cid-v5yihett> <div class="text-sm text-nord-3 dark:text-nord-5" data-astro-cid-v5yihett> <div> <div class="flex flex-wrap gap-2 mb-2"> <span class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-nord-7 dark:bg-nord-7 text-nord-0 dark:text-nord-0 rounded font-medium"> <span>ğŸ“…</span> <span>2026-02-05</span> </span> <span class="inline-flex items-center gap-1 px-2.5 py-1 text-xs bg-nord-8 dark:bg-nord-8 text-nord-0 dark:text-nord-0 rounded font-medium"> <span>âœï¸</span> <span>2026-02-05</span> </span> <a href="/notes/series/inside-go" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-green-light dark:tag-text-green-dark !no-underline hover:!no-underline" title="ç³»åˆ—ï¼šInside Go"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M4 6h16M4 12h16M4 18h16"></path> </svg> <span>Inside Go</span>  </a> <div class="flex flex-wrap gap-2"> <a href="/notes/tag/CS" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-blue-light dark:tag-text-blue-dark !no-underline hover:!no-underline" title="Tag: CS"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> <span>CS</span>  </a><a href="/notes/tag/GO" class="inline-flex items-center gap-1 px-2.5 sm:px-3 py-1.5 sm:py-1 text-xs sm:text-xs font-semibold rounded bg-nord-6 dark:bg-nord-2/60 shadow-sm dark:shadow-md transition-all duration-200 ease-out hover:shadow-md dark:hover:shadow-lg hover:translate-y-[-1px] tag-text-blue-light dark:tag-text-blue-dark !no-underline hover:!no-underline" title="Tag: GO"> <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M5 3h14v17L12 17l-7 3V3z"></path> </svg> <span>GO</span>  </a> </div> </div> </div> </div> <div class="text-sm" data-astro-cid-v5yihett> <div> <div class="flex items-center gap-4"> <!-- Back to notes link - removed, now in footer --> <!-- Show only links and backlinks stats --> <!-- Outlinks -->  <!-- Backlinks -->  <button class="open-backlinks-btn flex items-center gap-2 px-3 py-1 rounded hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-14 hover:opacity-90 transition-colors" aria-label="Open 1 backlinks" title="Linked from 1 note(s)"> <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M11 17l-5-5m0 0l5-5m-5 5h12"></path> </svg> <span class="font-medium">1 backlinks</span> </button>  <!-- No links message -->  </div> <!-- Modals --> <div id="outlinks-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-nord-6 dark:bg-nord-0 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-nord-5 dark:border-nord-1"> <!-- Header --> <div class="sticky top-0 bg-nord-6 dark:bg-nord-0 border-b border-nord-5 dark:border-nord-1 px-6 py-4 flex items-center justify-between"> <h2 class="text-lg font-semibold text-nord-2 dark:text-nord-6"> Outlinks <span class="text-sm font-normal text-nord-3 dark:text-nord-5 ml-2">
(0)
</span> </h2> <button class="close-modal p-1 text-nord-3 dark:text-nord-4 hover:bg-nord-5 dark:hover:bg-nord-1 hover:text-nord-2 dark:hover:text-nord-5 rounded transition-colors" aria-label="Close modal"> <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M18 6L6 18M6 6l12 12"></path> </svg> </button> </div> <!-- Content --> <div class="p-6"> <p class="text-nord-3 dark:text-nord-5 text-center py-8">
No outlinks found
</p> </div> </div> </div> <script>(function(){const modalId = "outlinks-modal";
const type = "outlinks";

  const modal = document.getElementById(modalId);
  const closeButtons = modal ? modal.querySelectorAll('.close-modal') : [];

  // Create camelCase function name: "backlinks" -> "openBacklinksModal"
  const functionName = `open${type.charAt(0).toUpperCase() + type.slice(1)}Modal`;

  // Open modal
  window[functionName] = function() {
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  };

  // Close modal
  function closeModal() {
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  }

  // Close button listeners
  closeButtons.forEach((btn) => {
    btn.addEventListener('click', closeModal);
  });

  // Close on background click
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
})();</script> <div id="backlinks-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"> <div class="bg-nord-6 dark:bg-nord-0 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-nord-5 dark:border-nord-1"> <!-- Header --> <div class="sticky top-0 bg-nord-6 dark:bg-nord-0 border-b border-nord-5 dark:border-nord-1 px-6 py-4 flex items-center justify-between"> <h2 class="text-lg font-semibold text-nord-2 dark:text-nord-6"> Backlinks <span class="text-sm font-normal text-nord-3 dark:text-nord-5 ml-2">
(1)
</span> </h2> <button class="close-modal p-1 text-nord-3 dark:text-nord-4 hover:bg-nord-5 dark:hover:bg-nord-1 hover:text-nord-2 dark:hover:text-nord-5 rounded transition-colors" aria-label="Close modal"> <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M18 6L6 18M6 6l12 12"></path> </svg> </button> </div> <!-- Content --> <div class="p-6"> <ul class="space-y-2"> <li> <a href="/notes/1770123038-CJXA" class="block p-3 rounded hover:bg-nord-5 dark:hover:bg-nord-1 text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-colors"> <div class="font-medium">Go: channel é€šé“</div> <div class="text-xs text-nord-3 dark:text-nord-5 mt-1 break-all"> /notes/1770123038-CJXA </div> </a> </li> </ul> </div> </div> </div> <script>(function(){const modalId = "backlinks-modal";
const type = "backlinks";

  const modal = document.getElementById(modalId);
  const closeButtons = modal ? modal.querySelectorAll('.close-modal') : [];

  // Create camelCase function name: "backlinks" -> "openBacklinksModal"
  const functionName = `open${type.charAt(0).toUpperCase() + type.slice(1)}Modal`;

  // Open modal
  window[functionName] = function() {
    if (modal) {
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
  };

  // Close modal
  function closeModal() {
    if (modal) {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }
  }

  // Close button listeners
  closeButtons.forEach((btn) => {
    btn.addEventListener('click', closeModal);
  });

  // Close on background click
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
})();</script> <script>
  // Outlinks button - calls window.openOutlinksModal()
  document.querySelectorAll('.open-outlinks-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      if (window.openOutlinksModal) {
        window.openOutlinksModal();
      }
    });
  });

  // Backlinks button - calls window.openBacklinksModal()
  document.querySelectorAll('.open-backlinks-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      if (window.openBacklinksModal) {
        window.openBacklinksModal();
      }
    });
  });
</script> </div> </div> </div> </header>    <h1 id="1--go-ç¼–è¯‘å™¨">1 Â· Go ç¼–è¯‘å™¨</h1>
<h2 id="11--å¿«é€Ÿæ¦‚è§ˆç¼–è¯‘æµç¨‹">1.1 Â· å¿«é€Ÿæ¦‚è§ˆï¼šç¼–è¯‘æµç¨‹</h2>
<p>Go ç¼–è¯‘å™¨å°†æºä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…±8ä¸ªä¸»è¦é˜¶æ®µï¼ˆå®˜æ–¹åˆ†ä¸ºå‰ç«¯ã€ä¸­ç«¯ã€åç«¯ï¼‰ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>æºä»£ç  â†’ è¯æ³•/è¯­æ³•åˆ†æ â†’ ç±»å‹æ£€æŸ¥ â†’ IRç”Ÿæˆ â†’ ä¸­ç«¯ä¼˜åŒ– â†’ Walk â†’ SSA â†’ æœºå™¨ç  â†’ å¯æ‰§è¡Œæ–‡ä»¶</span></span>
<span class="line"><span>         â””â”€â”€â”€â”€â”€â”€ å‰ç«¯ â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€ ä¸­ç«¯ â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€ åç«¯ â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span></code></pre>
<p><strong>å…³é”®é˜¶æ®µ</strong>ï¼š</p>
<ol>
<li><strong>è¯æ³•åˆ†æ</strong>ï¼šæºä»£ç  â†’ Token æµ</li>
<li><strong>è¯­æ³•åˆ†æ</strong>ï¼šToken â†’ æŠ½è±¡è¯­æ³•æ ‘ï¼ˆsyntax.Fileï¼‰</li>
<li><strong>ç±»å‹æ£€æŸ¥</strong>ï¼šAST â†’ ç¬¦å·è¡¨ã€ç±»å‹ä¿¡æ¯ï¼ˆä½¿ç”¨ types2 åŒ…ï¼‰</li>
<li><strong>ä¸­é—´ä»£ç ç”Ÿæˆ</strong>ï¼ˆNodingï¼‰ï¼šé€šè¿‡ Unified IR å°† types2 è¡¨ç¤ºè½¬æ¢ä¸ºç¼–è¯‘å™¨çš„ IR</li>
<li><strong>ä¸­ç«¯ä¼˜åŒ–</strong>ï¼šå†…è”ã€é€ƒé€¸åˆ†æã€æ­»ä»£ç æ¶ˆé™¤ç­‰</li>
<li><strong>Walk é˜¶æ®µ</strong>ï¼šåç³–ã€æ‹†è§£å¤æ‚è¯­å¥ã€è½¬æ¢é«˜çº§æ„é€ </li>
<li><strong>SSA ç”Ÿæˆä¸ä¼˜åŒ–</strong>ï¼šIR â†’ SSA â†’ æœºå™¨æ— å…³ä¼˜åŒ–</li>
<li><strong>æœºå™¨ç ç”Ÿæˆ</strong>ï¼šSSA é™çº§ â†’ æœºå™¨ç›¸å…³ä¼˜åŒ– â†’ æ±‡ç¼– â†’ ç›®æ ‡æ–‡ä»¶ â†’ é“¾æ¥ â†’ å¯æ‰§è¡Œæ–‡ä»¶</li>
</ol>
<hr>
<h2 id="12--ç¼–è¯‘å·¥å…·ä¸ä½¿ç”¨ç¤ºä¾‹">1.2 Â· ç¼–è¯‘å·¥å…·ä¸ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 id="121--å·¥å…·é“¾æ¦‚è§ˆ">1.2.1 Â· å·¥å…·é“¾æ¦‚è§ˆ</h3>













































<table><thead><tr><th>å·¥å…·</th><th>åŠŸèƒ½</th><th>é˜¶æ®µ</th></tr></thead><tbody><tr><td><code>go tool compile</code></td><td>ç¼–è¯‘æºæ–‡ä»¶ä¸ºç›®æ ‡æ–‡ä»¶ (.o/.a)</td><td>å‰ç«¯+ä¸­ç«¯</td></tr><tr><td><code>go tool asm</code></td><td>æ±‡ç¼–å™¨ï¼Œç¼–è¯‘æ±‡ç¼–ä»£ç </td><td>åç«¯</td></tr><tr><td><code>go tool link</code></td><td>é“¾æ¥å™¨ï¼Œé“¾æ¥ç›®æ ‡æ–‡ä»¶ä¸ºå¯æ‰§è¡Œæ–‡ä»¶</td><td>åç«¯</td></tr><tr><td><code>go tool objdump</code></td><td>åæ±‡ç¼–å·¥å…·ï¼ŒæŸ¥çœ‹äºŒè¿›åˆ¶å†…å®¹</td><td>åˆ†æ</td></tr><tr><td><code>go tool nm</code></td><td>ç¬¦å·åˆ—è¡¨å·¥å…·</td><td>åˆ†æ</td></tr><tr><td><code>go tool cgo</code></td><td>C è¯­è¨€äº’æ“ä½œ</td><td>ç‰¹æ®Š</td></tr><tr><td><code>go build</code></td><td>é«˜çº§æ„å»ºå·¥å…·ï¼ˆè‡ªåŠ¨è°ƒåº¦ï¼‰</td><td>å®Œæ•´æµç¨‹</td></tr></tbody></table>
<h3 id="122--ç¤ºä¾‹ç¼–è¯‘ä¸€ä¸ªç®€å•çš„-go-ç¨‹åº">1.2.2 Â· ç¤ºä¾‹ï¼šç¼–è¯‘ä¸€ä¸ªç®€å•çš„ Go ç¨‹åº</h3>
<p>åˆ›å»ºæµ‹è¯•æ–‡ä»¶ <code>main.go</code>ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">package</span><span style="color:#D8DEE9FF"> main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">import</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">fmt</span><span style="color:#ECEFF4">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> add</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">a</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9"> b</span><span style="color:#81A1C1"> int</span><span style="color:#ECEFF4">)</span><span style="color:#81A1C1"> int</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#81A1C1">	return</span><span style="color:#D8DEE9"> a</span><span style="color:#81A1C1"> +</span><span style="color:#D8DEE9"> b</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1">func</span><span style="color:#88C0D0"> main</span><span style="color:#ECEFF4">()</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#D8DEE9">	result</span><span style="color:#81A1C1"> :=</span><span style="color:#88C0D0"> add</span><span style="color:#ECEFF4">(</span><span style="color:#B48EAD">2</span><span style="color:#ECEFF4">,</span><span style="color:#B48EAD"> 3</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#D8DEE9">	fmt</span><span style="color:#ECEFF4">.</span><span style="color:#88C0D0">Println</span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">result</span><span style="color:#ECEFF4">)</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
<h4 id="1221--1-æŸ¥çœ‹æ±‡ç¼–ä»£ç ">1.2.2.1 Â· 1. æŸ¥çœ‹æ±‡ç¼–ä»£ç </h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># ç¼–è¯‘æ—¶æ‰“å°æ±‡ç¼–ï¼ˆä½¿ç”¨ go buildï¼‰</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=-S</span><span style="color:#A3BE8C"> main.go</span><span style="color:#81A1C1"> 2>&#x26;1</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> head</span><span style="color:#A3BE8C"> -100</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æˆ–è€…ä½¿ç”¨ go tool compile ç›´æ¥æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> -S</span><span style="color:#A3BE8C"> main.go</span><span style="color:#81A1C1"> 2>&#x26;1</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> grep</span><span style="color:#A3BE8C"> -A</span><span style="color:#B48EAD"> 20</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">func main</span><span style="color:#ECEFF4">"</span></span></code></pre>
<h4 id="1222--2-æŸ¥çœ‹-ssa-ä¼˜åŒ–è¿‡ç¨‹">1.2.2.2 Â· 2. æŸ¥çœ‹ SSA ä¼˜åŒ–è¿‡ç¨‹</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># ç”ŸæˆåŒ…å«æ‰€æœ‰ SSA ä¼˜åŒ–é˜¶æ®µçš„ HTML æ–‡æ¡£</span></span>
<span class="line"><span style="color:#D8DEE9">GOSSAFUNC</span><span style="color:#81A1C1">=</span><span style="color:#A3BE8C">main</span><span style="color:#88C0D0"> go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"><span style="color:#616E88"># ä¼šç”Ÿæˆ ssa.htmlï¼Œç”¨æµè§ˆå™¨æ‰“å¼€æŸ¥çœ‹æ¯ä¸ªé˜¶æ®µçš„ä¼˜åŒ–</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># åªæŸ¥çœ‹ç‰¹å®šå‡½æ•°</span></span>
<span class="line"><span style="color:#D8DEE9">GOSSAFUNC</span><span style="color:#81A1C1">=</span><span style="color:#A3BE8C">add</span><span style="color:#88C0D0"> go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> main.go</span></span></code></pre>
<h4 id="1223--3-æŸ¥çœ‹ç¼–è¯‘å‘½ä»¤ä¸æ‰§è¡Œ">1.2.2.3 Â· 3. æŸ¥çœ‹ç¼–è¯‘å‘½ä»¤ï¼ˆä¸æ‰§è¡Œï¼‰</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># æ‰“å°ç¼–è¯‘å‘½ä»¤ä½†ä¸æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -n</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"><span style="color:#616E88"># è¾“å‡ºä¼šæ˜¾ç¤ºè°ƒç”¨äº†å“ªäº› compile å’Œ link å‘½ä»¤</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æ‰“å°å‘½ä»¤å¹¶æ‰§è¡Œï¼Œçœ‹å®Œæ•´è¿‡ç¨‹</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -x</span><span style="color:#A3BE8C"> main.go</span></span></code></pre>
<h4 id="1224--4-ç¼–è¯‘ç»†èŠ‚æ§åˆ¶">1.2.2.4 Â· 4. ç¼–è¯‘ç»†èŠ‚æ§åˆ¶</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># ç¦ç”¨ä¼˜åŒ–</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=-N</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># ç¦ç”¨å†…è”</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=-l</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æ‰“å°ä¼˜åŒ–å†³ç­–</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=-m</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"><span style="color:#616E88"># è¾“å‡ºä¼šæ˜¾ç¤ºå†…è”ã€é€ƒé€¸åˆ†æç­‰ä¼˜åŒ–ä¿¡æ¯</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æ‰“å°æ›´è¯¦ç»†çš„ä¼˜åŒ–ä¿¡æ¯</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">-m=2</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æ‰“å°ç±»å‹æ£€æŸ¥è¿‡ç¨‹</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=-w</span><span style="color:#A3BE8C"> main.go</span></span></code></pre>
<h4 id="1225--5-åˆ†æç¼–è¯‘åçš„äºŒè¿›åˆ¶">1.2.2.5 Â· 5. åˆ†æç¼–è¯‘åçš„äºŒè¿›åˆ¶</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶ä¸­çš„æ‰€æœ‰ç¬¦å·</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> nm</span><span style="color:#A3BE8C"> main</span><span style="color:#81A1C1"> ></span><span style="color:#A3BE8C"> symbols.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æŸ¥çœ‹ç‰¹å®šç¬¦å·çš„å¤§å°</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> nm</span><span style="color:#A3BE8C"> main</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> grep</span><span style="color:#A3BE8C"> add</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># åæ±‡ç¼–äºŒè¿›åˆ¶ï¼ŒæŸ¥çœ‹ main å‡½æ•°çš„æœºå™¨ç </span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> objdump</span><span style="color:#A3BE8C"> main</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> grep</span><span style="color:#A3BE8C"> -A</span><span style="color:#B48EAD"> 30</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">TEXT main.main</span><span style="color:#ECEFF4">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æŸ¥çœ‹å®Œæ•´çš„åæ±‡ç¼–</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> objdump</span><span style="color:#A3BE8C"> main</span><span style="color:#81A1C1"> ></span><span style="color:#A3BE8C">disasm.txt</span></span></code></pre>
<h4 id="1226--6-ä½çº§ç¼–è¯‘æ‰‹åŠ¨è°ƒç”¨ç¼–è¯‘å™¨">1.2.2.6 Â· 6. ä½çº§ç¼–è¯‘ï¼ˆæ‰‹åŠ¨è°ƒç”¨ç¼–è¯‘å™¨ï¼‰</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># ç¬¬ä¸€æ­¥ï¼šç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> -o</span><span style="color:#A3BE8C"> main.o</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># ç¬¬äºŒæ­¥ï¼šé“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> link</span><span style="color:#A3BE8C"> -o</span><span style="color:#A3BE8C"> main</span><span style="color:#A3BE8C"> main.o</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æˆ–è€…ä¸€æ­¥å®Œæˆï¼Œä½¿ç”¨ -pack ç”Ÿæˆ .a æ–‡ä»¶</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> -pack</span><span style="color:#A3BE8C"> -o</span><span style="color:#A3BE8C"> main.a</span><span style="color:#A3BE8C"> main.go</span></span></code></pre>
<h4 id="1227--7-åˆ†ææ„å»ºè¿‡ç¨‹">1.2.2.7 Â· 7. åˆ†ææ„å»ºè¿‡ç¨‹</h4>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># æ‰“å°è¯¦ç»†çš„ç¼–è¯‘è¿‡ç¨‹</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -v</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># ä¿å­˜ä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸ä¼šåˆ é™¤ï¼‰</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -work</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"><span style="color:#616E88"># ä¼šåœ¨æœ€åæ‰“å°ä¸´æ—¶ç›®å½•è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># æŸ¥çœ‹å¯¼å…¥é…ç½®</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -x</span><span style="color:#A3BE8C"> main.go</span><span style="color:#81A1C1"> 2>&#x26;1</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> grep</span><span style="color:#A3BE8C"> importcfg</span></span></code></pre>
<h3 id="123--å®é™…ç”¨é€”ç¤ºä¾‹">1.2.3 Â· å®é™…ç”¨é€”ç¤ºä¾‹</h3>
<p><strong>æƒ³è¦ä¼˜åŒ–ç¨‹åºæ€§èƒ½</strong>ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># 1. æŸ¥çœ‹å“ªäº›å‡½æ•°è¢«å†…è”</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">-m=2</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C"> myapp.go</span><span style="color:#81A1C1"> 2>&#x26;1</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> grep</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">inlined</span><span style="color:#ECEFF4">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 2. æŸ¥çœ‹é€ƒé€¸åˆ†æç»“æœ</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">-m=2</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C"> myapp.go</span><span style="color:#81A1C1"> 2>&#x26;1</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> grep</span><span style="color:#ECEFF4"> "</span><span style="color:#A3BE8C">escape</span><span style="color:#ECEFF4">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 3. æŸ¥çœ‹ç”Ÿæˆçš„æ±‡ç¼–</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -gcflags=-S</span><span style="color:#A3BE8C"> myapp.go</span><span style="color:#81A1C1"> ></span><span style="color:#A3BE8C"> asm.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 4. å…³é”®å‡½æ•°çš„ SSA ä¼˜åŒ–è¿‡ç¨‹</span></span>
<span class="line"><span style="color:#D8DEE9">GOSSAFUNC</span><span style="color:#81A1C1">=</span><span style="color:#A3BE8C">criticalFunc</span><span style="color:#88C0D0"> go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> myapp.go</span></span></code></pre>
<p><strong>æƒ³è¦å‡å°äºŒè¿›åˆ¶å¤§å°</strong>ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># 1. ç§»é™¤ DWARF è°ƒè¯•ä¿¡æ¯</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -ldflags=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">-w</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 2. ç§»é™¤ç¬¦å·è¡¨</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -ldflags=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">-s</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 3. åŒæ—¶ç§»é™¤</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -ldflags=</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C">-s -w</span><span style="color:#ECEFF4">"</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 4. æŸ¥çœ‹ç¬¦å·å ç”¨ç©ºé—´</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> nm</span><span style="color:#A3BE8C"> -S</span><span style="color:#A3BE8C"> main</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> sort</span><span style="color:#A3BE8C"> -k2</span><span style="color:#A3BE8C"> -rn</span><span style="color:#81A1C1"> |</span><span style="color:#88C0D0"> head</span><span style="color:#A3BE8C"> -20</span></span></code></pre>
<p><strong>è°ƒè¯•ç¼–è¯‘é—®é¢˜</strong>ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#616E88"># 1. æ‰“å°å®Œæ•´çš„ç¼–è¯‘å‘½ä»¤</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -x</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 2. ä¿å­˜ä¸´æ—¶ç¼–è¯‘ä¸­é—´ç»“æœ</span></span>
<span class="line"><span style="color:#D8DEE9">TMPDIR</span><span style="color:#81A1C1">=</span><span style="color:#A3BE8C">/tmp/gobuild</span><span style="color:#88C0D0"> go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -work</span><span style="color:#A3BE8C"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 3. æ£€æŸ¥ç±»å‹æ£€æŸ¥è¿‡ç¨‹</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> tool</span><span style="color:#A3BE8C"> compile</span><span style="color:#A3BE8C"> -d</span><span style="color:#A3BE8C"> help</span><span style="color:#616E88"> # æŸ¥çœ‹æ‰€æœ‰è°ƒè¯•é€‰é¡¹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88"># 4. ç«æ€æ£€æµ‹ç¼–è¯‘</span></span>
<span class="line"><span style="color:#88C0D0">go</span><span style="color:#A3BE8C"> build</span><span style="color:#A3BE8C"> -race</span><span style="color:#A3BE8C"> main.go</span></span></code></pre>
<hr>
<h2 id="13--ç¼–è¯‘ç»†èŠ‚æ·±å…¥">1.3 Â· ç¼–è¯‘ç»†èŠ‚æ·±å…¥</h2>
<h3 id="131--å‰ç«¯è¯¦è§£">1.3.1 Â· å‰ç«¯è¯¦è§£</h3>
<h4 id="1311--1-è¯æ³•ä¸è¯­æ³•åˆ†æ">1.3.1.1 Â· 1. è¯æ³•ä¸è¯­æ³•åˆ†æ</h4>
<p><strong>è¯æ³•åˆ†æï¼ˆLexical Analysisï¼‰</strong>ï¼š</p>
<ul>
<li>åŒ…ï¼š<code>cmd/compile/internal/syntax</code></li>
<li>å·¥å…·ï¼š<code>syntax.Token</code> å’Œ <code>syntax.Scanner</code></li>
<li>è¿‡ç¨‹ï¼šæºä»£ç  â†’ Token æµ</li>
<li>ä½ç½®ä¿¡æ¯ï¼šç”¨äºé”™è¯¯æŠ¥å‘Šå’Œè°ƒè¯•</li>
</ul>
<p><strong>è¯­æ³•åˆ†æï¼ˆSyntax Analysisï¼‰</strong>ï¼š</p>
<ul>
<li>å·¥å…·ï¼š<code>syntax.Parser</code> å’Œ <code>syntax.File</code></li>
<li>å…¥å£å‡½æ•°ï¼š<code>syntax.Parse()</code></li>
<li>ç»“æ„è§„åˆ™ï¼š
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>SourceFile = PackageClause ";" { ImportDecl ";" } { TopLevelDecl ";" }</span></span>
<span class="line"><span>TopLevelDecl = Declaration | FunctionDecl | MethodDecl</span></span>
<span class="line"><span>Declaration = ConstDecl | TypeDecl | VarDecl</span></span></code></pre>
</li>
<li>Parser æ–¹æ³•åˆ†ç±»ï¼š
<ol>
<li>è¯æ³•ç›¸å…³ï¼šè¯»å–å’Œç®¡ç† Token</li>
<li>ç»“æ„è§£æï¼šå£°æ˜ã€è¡¨è¾¾å¼ã€è¯­å¥</li>
<li>é”™è¯¯å¤„ç†</li>
</ol>
</li>
</ul>
<h4 id="1312--2-ç±»å‹æ£€æŸ¥semantic-analysis">1.3.1.2 Â· 2. ç±»å‹æ£€æŸ¥ï¼ˆSemantic Analysisï¼‰</h4>
<p><strong>å…¥å£</strong>ï¼š<code>types2/check.go</code> ä¸­çš„ <code>Checker.checkFiles()</code> æ–¹æ³•ï¼Œç”± <code>noder/irgen.go</code> ä¸­çš„ <code>checkFiles()</code> å‡½æ•°è°ƒç”¨</p>
<p><strong>ç±»å‹æ£€æŸ¥çš„ä¸‰ä¸ªæ ¸å¿ƒä»»åŠ¡</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ ‡è¯†ç¬¦è§£æ</strong>ï¼ˆIdentifier Resolutionï¼‰ï¼šæ ‡è¯†ç¬¦ â†’ Object</p>
<ul>
<li>å°† AST ä¸­çš„æ ‡è¯†ç¬¦æ˜ å°„åˆ°å£°æ˜çš„å¯¹è±¡</li>
</ul>
</li>
<li>
<p><strong>ç±»å‹æ¨å¯¼</strong>ï¼ˆType Deductionï¼‰ï¼šè¡¨è¾¾å¼ â†’ Type</p>
<ul>
<li>ç¡®å®šæ¯ä¸ªè¡¨è¾¾å¼çš„ç±»å‹</li>
</ul>
</li>
<li>
<p><strong>å¸¸é‡æ±‚å€¼</strong>ï¼ˆConstant Evaluationï¼‰ï¼šå¸¸é‡è¡¨è¾¾å¼ â†’ Value</p>
<ul>
<li>åœ¨ç¼–è¯‘æœŸè®¡ç®—å¸¸é‡çš„å€¼</li>
</ul>
</li>
</ol>
<p>è¿™ä¸‰ä¸ªä»»åŠ¡ç›¸äº’ä¾èµ–ï¼š</p>
<ul>
<li>å¸¸é‡å€¼çš„ç¡®å®šå¯èƒ½ä¾èµ–ç±»å‹</li>
<li>è¡¨è¾¾å¼çš„ç±»å‹å¯èƒ½ä¾èµ–å¸¸é‡çš„å€¼</li>
<li>æ ‡è¯†ç¬¦çš„è§£æå¯èƒ½ä¾èµ–ç±»å‹ä¿¡æ¯ï¼ˆå¦‚ç»“æ„ä½“å­—æ®µï¼‰</li>
</ul>
<p><strong>å…³é”®æ•°æ®ç»“æ„</strong>ï¼š</p>
<p><strong>Objectï¼ˆç¬¦å·å¯¹è±¡ï¼‰</strong>ï¼š<code>types2/object.go</code></p>
<ul>
<li>ä»£è¡¨æ‰€æœ‰å‘½åå®ä½“ï¼ˆconstã€varã€typeã€func ç­‰ï¼‰</li>
<li>æ¯ä¸ª AST æ ‡è¯†ç¬¦æ˜ å°„åˆ°ä¸€ä¸ª Object</li>
<li>æ¥å£å®šä¹‰ï¼š
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#81A1C1">type</span><span style="color:#D8DEE9FF"> Object </span><span style="color:#81A1C1">interface</span><span style="color:#ECEFF4"> {</span></span>
<span class="line"><span style="color:#88C0D0">	Name</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> string</span><span style="color:#616E88">   // åŒ…çº§åˆ«åç§°</span></span>
<span class="line"><span style="color:#88C0D0">	Exported</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> bool</span><span style="color:#616E88"> // æ˜¯å¦ä»¥å¤§å†™å­—æ¯å¼€å¤´</span></span>
<span class="line"><span style="color:#88C0D0">	Type</span><span style="color:#ECEFF4">()</span><span style="color:#D8DEE9FF"> Type     </span><span style="color:#616E88">// å¯¹è±¡ç±»å‹</span></span>
<span class="line"><span style="color:#88C0D0">	Pos</span><span style="color:#ECEFF4">()</span><span style="color:#D8DEE9FF"> token</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9FF">Pos </span><span style="color:#616E88">// å£°æ˜ä¸­æ ‡è¯†ç¬¦çš„ä½ç½®</span></span>
<span class="line"><span style="color:#88C0D0">	Parent</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">Scope </span><span style="color:#616E88">// å£°æ˜è¯¥å¯¹è±¡çš„ä½œç”¨åŸŸ</span></span>
<span class="line"><span style="color:#88C0D0">	Pkg</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> *</span><span style="color:#D8DEE9FF">Package  </span><span style="color:#616E88">// æ‰€åœ¨åŒ…ï¼Œnil è¡¨ç¤º Universe scope</span></span>
<span class="line"><span style="color:#88C0D0">	Id</span><span style="color:#ECEFF4">()</span><span style="color:#81A1C1"> string</span><span style="color:#616E88">     // å¯¹è±¡ IDï¼ˆç”¨äºå”¯ä¸€æ€§ï¼‰</span></span>
<span class="line"><span style="color:#ECEFF4">}</span></span></code></pre>
</li>
</ul>
<p><strong>Scopeï¼ˆä½œç”¨åŸŸï¼‰</strong>ï¼š<code>types2/scope.go</code></p>
<ul>
<li>é™æ€ä½œç”¨åŸŸï¼ˆè¯æ³•ä½œç”¨åŸŸï¼‰</li>
<li>åˆ†å±‚ï¼šå…¨å±€ â†’ åŒ… â†’ æ–‡ä»¶ â†’ ä»£ç å—</li>
<li>å­˜æ”¾ Objectï¼Œæ”¯æŒåç§°æŸ¥æ‰¾</li>
</ul>
<p><strong>Typeï¼ˆç±»å‹ï¼‰</strong>ï¼š<code>types2/type.go</code> åŠç›¸å…³æ–‡ä»¶</p>
<ul>
<li>åŸºç¡€ç±»å‹ã€å¤åˆç±»å‹ã€ç»“æ„ä½“ã€æ¥å£ã€Namedã€Tuple ç­‰</li>
<li>ç±»å‹ç­‰ä»·æ€§ï¼š<code>Identical()</code> å‡½æ•°ï¼ˆç»“æ„ä¸€è‡´åˆ™ç­‰ä»·ï¼‰</li>
<li>ç±»å‹æ¯”è¾ƒï¼šå¯æ¯”è¾ƒï¼ˆç­‰/ä¸ç­‰ï¼‰ã€å¯æ’åºï¼ˆå¤§å°ç­‰ï¼‰</li>
</ul>
<p><strong>Checkerï¼ˆæ£€æŸ¥å™¨ï¼‰</strong>ï¼š<code>types2/check.go</code></p>
<ul>
<li>æ ¸å¿ƒæ–¹æ³•ï¼š<code>checkFiles()</code></li>
<li>ç»´æŠ¤ç±»å‹æ£€æŸ¥çš„çŠ¶æ€å’Œä¿¡æ¯</li>
</ul>
<p><strong>ç±»å‹æ£€æŸ¥æµç¨‹</strong>ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>checkFiles()</span></span>
<span class="line"><span>  â”œâ”€ initFilesï¼ˆéªŒè¯åŒä¸€åŒ…ï¼‰</span></span>
<span class="line"><span>  â”œâ”€ collectObjectsï¼ˆAST â†’ Object + declInfoï¼‰</span></span>
<span class="line"><span>  â”œâ”€ packageObjectsï¼ˆé€’å½’æ£€æŸ¥ check.objMap ä¸­çš„å¯¹è±¡ï¼‰</span></span>
<span class="line"><span>  â”‚  â””â”€ check.objDecl() å¯¹æ¯ä¸ªå¯¹è±¡è¿›è¡Œæ£€æŸ¥</span></span>
<span class="line"><span>  â”‚     â”œâ”€ ç±»å‹è¡¨è¾¾å¼ï¼šChecker.typ()</span></span>
<span class="line"><span>  â”‚     â”œâ”€ æ±‚å€¼è¡¨è¾¾å¼ï¼šChecker.exprInternal()</span></span>
<span class="line"><span>  â”‚     â””â”€ ç±»å‹å…¼å®¹æ€§ï¼šChecker.assignment()</span></span>
<span class="line"><span>  â”œâ”€ processDelayedï¼ˆå¤„ç†å»¶è¿Ÿé˜Ÿåˆ—ï¼‰</span></span>
<span class="line"><span>  â”‚  â””â”€ å‡½æ•°ä½“æ£€æŸ¥ã€å¾ªç¯ä¾èµ–ã€æ¥å£æ•´ç†</span></span>
<span class="line"><span>  â””â”€ initOrderï¼ˆç¡®å®šå…¨å±€åˆå§‹åŒ–é¡ºåºï¼‰</span></span></code></pre>
<p><strong>åŒ…åŠ è½½ä¸å¯¼å‡ºæ•°æ®</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ Importer æ¥å£çš„ Import æ–¹æ³•å¯¼å…¥å…¶ä»–åŒ…</li>
<li>è¯»å–ç¼–è¯‘è¾“å‡ºçš„å¯¹è±¡æ–‡ä»¶ï¼ˆ.a æˆ– .oï¼‰ä¸­çš„ export data</li>
<li>é™æ€é“¾æ¥ï¼šé“¾æ¥å™¨æ ¹æ®é‡å®šä½ä¿¡æ¯è§„åˆ’å†…å­˜</li>
</ul>
<h4 id="1313--3-ä¸­é—´ä»£ç ç”Ÿæˆir-tree">1.3.1.3 Â· 3. ä¸­é—´ä»£ç ç”Ÿæˆï¼ˆIR Treeï¼‰</h4>
<p><strong>åŒ…</strong>ï¼š<code>src/cmd/compile/internal/ir</code></p>
<p><strong>ä½œç”¨</strong>ï¼š</p>
<ul>
<li>AST æ˜¯æºä»£ç çš„ç›´æ¥è¡¨ç¤ºï¼Œä¿¡æ¯ä¸å®Œæ•´</li>
<li>IR Tree æ˜¯ä¿¡æ¯æ›´ä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼ŒåŒ…å«ç¼–è¯‘ä¿¡æ¯</li>
<li>ä¾¿äºåç»­ä¼˜åŒ–å’Œä»£ç ç”Ÿæˆ</li>
</ul>
<p><strong>å…³é”®æ¥å£å’Œç»“æ„</strong>ï¼š</p>
<ul>
<li>
<p><strong>Node æ¥å£</strong>ï¼šå®ç° Node çš„å„ç§ç±»å‹</p>
<ul>
<li>expr.goï¼šè¡¨è¾¾å¼èŠ‚ç‚¹</li>
<li>stmt.goï¼šè¯­å¥èŠ‚ç‚¹</li>
<li>func.goï¼šå‡½æ•°èŠ‚ç‚¹</li>
<li>name.goï¼šåç§°èŠ‚ç‚¹</li>
</ul>
</li>
<li>
<p><strong>Name ç»“æ„</strong>ï¼šå˜é‡/å¸¸é‡åç§°åŠå…¶ä¿¡æ¯</p>
</li>
<li>
<p><strong>Func ç»“æ„</strong>ï¼šå‡½æ•°å®šä¹‰åŠå…¶ä¿¡æ¯</p>
</li>
<li>
<p><strong>Op ç±»å‹</strong>ï¼šæ“ä½œç±»å‹ï¼ˆå¦‚åŠ æ³•ã€è°ƒç”¨ç­‰ï¼‰</p>
</li>
</ul>
<p><strong>æ„å»ºé€»è¾‘</strong>ï¼šç”± <code>irgen.generate()</code> é©±åŠ¨</p>
<hr>
<h3 id="132--ä¸­ç«¯ä¼˜åŒ–é˜¶æ®µ">1.3.2 Â· ä¸­ç«¯ï¼šä¼˜åŒ–é˜¶æ®µ</h3>
<p>Go ç¼–è¯‘å™¨åœ¨å¤šä¸ªé˜¶æ®µè¿›è¡Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬ï¼š</p>
<h4 id="1321--å‰æœŸä¼˜åŒ–åœ¨-unified-ir-å†™å…¥é˜¶æ®µ">1.3.2.1 Â· å‰æœŸä¼˜åŒ–ï¼ˆåœ¨ Unified IR å†™å…¥é˜¶æ®µï¼‰</h4>
<ul>
<li><strong>æ—©æœŸæ­»ä»£ç æ¶ˆé™¤</strong>ï¼šåœ¨ unified IR å†™å…¥è¿‡ç¨‹ä¸­é›†æˆ</li>
</ul>
<h4 id="1322--ä¸­æœŸä¼˜åŒ–ir-çº§åˆ«walk-å‰">1.3.2.2 Â· ä¸­æœŸä¼˜åŒ–ï¼ˆIR çº§åˆ«ï¼ŒWalk å‰ï¼‰</h4>
<ul>
<li><strong>å†…è”</strong>ã€<strong>é€ƒé€¸åˆ†æ</strong>ã€<strong>æ­»ä»£ç æ¶ˆé™¤</strong></li>
<li><strong>å»è™šæ‹ŸåŒ–</strong>ï¼šç”¨å®é™…ç±»å‹æ›¿æ¢æ¥å£è°ƒç”¨</li>
</ul>
<hr>
<h3 id="133--walk-é˜¶æ®µ">1.3.3 Â· Walk é˜¶æ®µ</h3>
<p><strong>åŒ…</strong>ï¼š<code>cmd/compile/internal/walk</code></p>
<p><strong>ç›®çš„</strong>ï¼š</p>
<ol>
<li><strong>æ‹†è§£å¤æ‚è¯­å¥</strong>ï¼šå°†å¤æ‚è¯­å¥åˆ†è§£ä¸ºæ›´ç®€å•çš„è¯­å¥ï¼Œå¼•å…¥ä¸´æ—¶å˜é‡</li>
<li><strong>åç³–</strong>ï¼ˆDesugaringï¼‰ï¼šå°†é«˜çº§æ„é€ è½¬æ¢ä¸ºä½çº§æ„é€ 
<ul>
<li><code>switch</code> â†’ äºŒåˆ†æŸ¥æ‰¾æˆ–è·³è½¬è¡¨</li>
<li><code>for-range</code> â†’ ç®€å• for å¾ªç¯</li>
<li><code>map</code>/<code>channel</code> æ“ä½œ â†’ è¿è¡Œæ—¶è°ƒç”¨</li>
</ul>
</li>
</ol>
<p><strong>æ‰§è¡Œæ—¶é—´</strong>ï¼šåœ¨ SSA ç”Ÿæˆå‰ï¼Œæ˜¯ IR ä¸Šçš„æœ€åä¸€ä¸ªéå†</p>
<hr>
<h3 id="134--åŒ…åˆå§‹åŒ–">1.3.4 Â· åŒ…åˆå§‹åŒ–</h3>
<p><strong>åŒ…</strong>ï¼š</p>
<ul>
<li><code>src/cmd/compile/internal/pkginit</code>ï¼šåˆå§‹åŒ–é€»è¾‘</li>
<li><code>src/cmd/compile/internal/staticinit</code>ï¼šé™æ€ vs åŠ¨æ€åˆå§‹åŒ–åˆ¤æ–­</li>
</ul>
<p><strong>åˆå§‹åŒ–é¡ºåº</strong>ï¼š</p>
<ol>
<li>ä¾èµ–åŒ…çš„åˆå§‹åŒ–</li>
<li>å…¨å±€å˜é‡åˆå§‹åŒ–ï¼ˆç¼–è¯‘æ—¶ç¡®å®š vs è¿è¡Œæ—¶ï¼‰</li>
<li>init å‡½æ•°åˆå§‹åŒ–</li>
</ol>
<p><strong>ä¼˜åŒ–</strong>ï¼šå°½å¯èƒ½åœ¨ç¼–è¯‘æœŸå®Œæˆå˜é‡åˆå§‹åŒ–</p>
<hr>
<h3 id="135--ä¼˜åŒ–é˜¶æ®µ">1.3.5 Â· ä¼˜åŒ–é˜¶æ®µ</h3>
<h4 id="1351--1-dead-code-æ¶ˆé™¤">1.3.5.1 Â· 1. Dead Code æ¶ˆé™¤</h4>
<p><strong>åŒ…</strong>ï¼š<code>src/cmd/compile/internal/deadcode</code></p>
<ul>
<li>å…¥å£ï¼š<code>deadcode.Func()</code></li>
<li>ä½œç”¨ï¼š
<ul>
<li>å‡å°å¯æ‰§è¡Œæ–‡ä»¶å¤§å°</li>
<li>æå‡ç¼“å­˜å‘½ä¸­ç‡ï¼ˆå¢åŠ å±€éƒ¨æ€§ï¼‰</li>
</ul>
</li>
<li>ä¾‹ï¼šç§»é™¤ if åˆ†æ”¯ä¸­æ°¸ä¸æ‰§è¡Œçš„ä»£ç ã€å¸ƒå°”è¿ç®—çš„å†—ä½™åˆ†æ”¯</li>
</ul>
<h4 id="1352--2-å‡½æ•°å†…è”inline">1.3.5.2 Â· 2. å‡½æ•°å†…è”ï¼ˆInlineï¼‰</h4>
<p><strong>åŒ…</strong>ï¼š<code>src/cmd/compile/internal/inline</code></p>
<p><strong>åŸç†</strong>ï¼š</p>
<ul>
<li>å‡½æ•°è°ƒç”¨æœ‰å›ºå®šå¼€é”€ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰</li>
<li>ä½¿ç”¨å‡½æ•°ä½“æ›¿æ¢å‡½æ•°è°ƒç”¨ä»¥æ¶ˆé™¤å¼€é”€</li>
</ul>
<p><strong>ä¼˜ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šç¼©çŸ­è°ƒç”¨é“¾ï¼Œæå‡æ€§èƒ½</li>
<li>ç¼ºç‚¹ï¼šå¢å¤§å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯ï¼Œé”™è¯¯ä¿¡æ¯å±•ç¤ºä¸å‹å¥½</li>
</ul>
<p><strong>è¿‡ç¨‹</strong>ï¼š</p>
<ol>
<li>éå†å‡½æ•°è°ƒç”¨é“¾ï¼ˆ<code>ir/scc.go</code> çš„ <code>VisitFuncsBottomUp</code>ï¼‰</li>
<li>è®¡ç®—å‡½æ•°å¤æ‚åº¦ï¼ˆ<code>hairyVisitor</code> ç»“æ„ä½“ï¼‰</li>
<li>åˆ¤æ–­æ˜¯å¦å¯ä»¥å†…è”</li>
<li>è¿›è¡Œå†…è”ï¼ˆ<code>InlineCalls</code> å‡½æ•°ï¼‰</li>
</ol>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>ä¸€ä¸ªå‡½æ•°è¢«é¢‘ç¹è°ƒç”¨ä½†å¤æ‚åº¦é«˜ï¼Œä¸ä¼šè¢«å†…è”</li>
<li>è§£å†³æ–¹æ¡ˆï¼šæŠ½å‡ºå¤æ‚ä»£ç ä¸ºå•ç‹¬å‡½æ•°ï¼Œé™ä½åŸå‡½æ•°å¤æ‚åº¦ï¼Œæé«˜å†…è”æœºä¼š</li>
</ul>
<h4 id="1353--3-é€ƒé€¸åˆ†æescape-analysis">1.3.5.3 Â· 3. é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰</h4>
<p><strong>åŒ…</strong>ï¼š<code>src/cmd/compile/internal/escape</code></p>
<p><strong>ç›®æ ‡</strong>ï¼š</p>
<ul>
<li>ç¡®å®šå˜é‡åº”è¯¥åˆ†é…åœ¨æ ˆè¿˜æ˜¯å †ä¸Š</li>
<li>æ ˆï¼šå¿«ï¼Œç”Ÿå‘½å‘¨æœŸä¸å‡½æ•°ä¸€è‡´ï¼Œè‡ªåŠ¨é‡Šæ”¾</li>
<li>å †ï¼šæ…¢ï¼Œéœ€è¦ GC ç®¡ç†</li>
</ul>
<p><strong>åˆ†æè§„åˆ™</strong>ï¼š</p>
<ol>
<li>æŒ‡å‘æ ˆä¸Šå¯¹è±¡çš„æŒ‡é’ˆä¸èƒ½åœ¨å †ä¸Š</li>
<li>æŒ‡å‘æ ˆä¸Šå¯¹è±¡çš„æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½å¤§äºå…¶æŒ‡å‘çš„å¯¹è±¡</li>
<li>å¤§å¯¹è±¡åˆ†é…åˆ°å †ä¸Š</li>
</ol>
<p><strong>ç®—æ³•</strong>ï¼šåŸºäº AST çš„é™æ€æ•°æ®æµåˆ†æ</p>
<hr>
<h3 id="136--åç«¯è¯¦è§£">1.3.6 Â· åç«¯è¯¦è§£</h3>
<h4 id="1361--1-ssastatic-single-assignmentç”Ÿæˆ">1.3.6.1 Â· 1. SSAï¼ˆStatic Single Assignmentï¼‰ç”Ÿæˆ</h4>
<p><strong>åŒ…</strong>ï¼š<code>src/cmd/compile/internal/{ssagen,ssa}</code></p>
<p><strong>å…¥å£</strong>ï¼š<code>ssagen.Compile()</code> å‡½æ•°å’Œ <code>ssa.Compile()</code> å‡½æ•°</p>
<p><strong>SSA ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªå˜é‡åªèµ‹å€¼ä¸€æ¬¡</li>
<li>ä½çº§ä¸­é—´è¡¨ç¤ºï¼Œä¾¿äºå®ç°ä¼˜åŒ–</li>
<li>ä¾¿äºè¿›è¡Œæ•°æ®æµåˆ†æ</li>
</ul>
<p><strong>è¿‡ç¨‹</strong>ï¼š</p>
<ul>
<li>IR â†’ <code>buildssa()</code> å‡½æ•°ï¼ˆssagen/ssa.goï¼‰å°† IR è½¬æ¢ä¸º SSA</li>
<li>é€šè¿‡ insertPhis å‡½æ•°å¤„ç† phi èŠ‚ç‚¹</li>
<li>è°ƒç”¨ <code>ssa.Compile()</code> è¿›è¡Œ SSA ä¼˜åŒ–</li>
<li>è¾“å‡ºï¼šSSA å€¼ï¼ˆValueï¼‰å’Œå—ï¼ˆBlockï¼‰å½¢æˆçš„ SSA å›¾</li>
</ul>
<h4 id="1362--2-ssa-ä¼˜åŒ–">1.3.6.2 Â· 2. SSA ä¼˜åŒ–</h4>
<p><strong>æœºå™¨æ— å…³ä¼˜åŒ–</strong>ï¼ˆGeneric Passesï¼‰ï¼š</p>
<ul>
<li>æ­»ä»£ç æ¶ˆé™¤ï¼šç§»é™¤æœªä½¿ç”¨çš„è®¡ç®—</li>
<li>ç©ºæŒ‡é’ˆæ£€æŸ¥ç§»é™¤ï¼šæ¶ˆé™¤å†—ä½™çš„ nil æ£€æŸ¥</li>
<li>æœªä½¿ç”¨åˆ†æ”¯ç§»é™¤ï¼šåˆ é™¤æœªè¢«å–ç”¨çš„æ§åˆ¶æµåˆ†æ”¯</li>
<li>è¡¨è¾¾å¼ä¼˜åŒ–ï¼š
<ul>
<li>å¸¸é‡æŠ˜å ï¼š<code>1 + 2</code> â†’ <code>3</code></li>
<li>ä¹˜æ³•ä¼˜åŒ–ï¼š<code>x * 2</code> â†’ <code>x &#x3C;&#x3C; 1</code></li>
<li>æµ®ç‚¹è¿ç®—ä¼˜åŒ–</li>
</ul>
</li>
</ul>
<p><strong>å®ç°æ–¹å¼</strong>ï¼š</p>
<ul>
<li>ç›´æ¥åœ¨ Go ä»£ç ä¸­å®ç°çš„ passes</li>
<li>é€šè¿‡ rewrite rulesï¼ˆ<code>cmd/compile/internal/ssa/_gen/*.rules</code>ï¼‰ä»£ç ç”Ÿæˆçš„ä¼˜åŒ–è§„åˆ™</li>
</ul>
<p><strong>å…³é”®æœºåˆ¶</strong>ï¼š</p>
<ul>
<li><strong>Lower Pass</strong>ï¼šå°†é€šç”¨ SSA è½¬æ¢ä¸ºæœºå™¨ç›¸å…³çš„å˜ä½“ï¼ˆå¦‚ amd64 ç‰¹å®šæ“ä½œï¼‰</li>
<li><strong>Rewrite Rules</strong>ï¼šä½¿ç”¨ S-expression å½¢å¼çš„ DSL æè¿°ï¼Œè‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–ä»£ç </li>
<li><strong>å®Œæ•´ä¼˜åŒ–æµç¨‹</strong>ï¼šä»é«˜çº§ SSA å¼€å§‹ï¼Œç»è¿‡å¤šä¸ª passesï¼Œæœ€ç»ˆå¾—åˆ°æœºå™¨ç›¸å…³çš„ SSA</li>
</ul>
<h4 id="1363--3-æœºå™¨ç ç”Ÿæˆ">1.3.6.3 Â· 3. æœºå™¨ç ç”Ÿæˆ</h4>
<p><strong>æµç¨‹</strong>ï¼š</p>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>SSA â†’ Lower Passï¼ˆSSA â†’ æœºå™¨ç›¸å…³å˜ä½“ï¼‰</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>æœ€ç»ˆä¼˜åŒ–ï¼ˆdead codeã€å€¼ç§»åŠ¨ã€å¯„å­˜å™¨åˆ†é…ï¼‰</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>æ ˆå¸§å¸ƒå±€ï¼ˆåˆ†é…æ ˆåç§»ç»™å±€éƒ¨å˜é‡ï¼‰</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>obj.Prog æŒ‡ä»¤æµ</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>æ±‡ç¼–å™¨ï¼ˆcmd/internal/objï¼‰</span></span>
<span class="line"><span>  â†“</span></span>
<span class="line"><span>æœºå™¨ç  â†’ ç›®æ ‡æ–‡ä»¶</span></span></code></pre>
<p><strong>æœ€ç»ˆæ–‡ä»¶å†…å®¹</strong>ï¼š</p>
<ul>
<li>æœºå™¨ç </li>
<li>Reflect æ•°æ®ï¼ˆç”¨äºåå°„ï¼‰</li>
<li>Export æ•°æ®ï¼ˆç”¨äºå¯¼å…¥ï¼‰</li>
<li>è°ƒè¯•ä¿¡æ¯ï¼ˆDWARFï¼‰</li>
</ul>
<h4 id="1364--4-abiåº”ç”¨äºŒè¿›åˆ¶æ¥å£">1.3.6.4 Â· 4. ABIï¼ˆåº”ç”¨äºŒè¿›åˆ¶æ¥å£ï¼‰</h4>
<ul>
<li>åŸºäºå¯„å­˜å™¨çš„ ABIï¼ˆæ›¿ä»£æ ˆä¼ å‚ï¼‰</li>
<li>å®šä¹‰å‚æ•°/è¿”å›å€¼å¦‚ä½•é€šè¿‡å¯„å­˜å™¨ä¼ é€’</li>
<li>ä¼˜åŒ–å‡½æ•°è°ƒç”¨æ€§èƒ½</li>
</ul>
<hr>
<h2 id="14--ç¼–è¯‘æµç¨‹æ€»ç»“">1.4 Â· ç¼–è¯‘æµç¨‹æ€»ç»“</h2>
<h3 id="141--å®Œæ•´ç¼–è¯‘é“¾">1.4.1 Â· å®Œæ•´ç¼–è¯‘é“¾</h3>
<pre class="astro-code nord" style="background-color:#2e3440ff;color:#d8dee9ff; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>go build main.go</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>Go å‘½ä»¤è¡Œè°ƒåº¦ç¼–è¯‘</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>go tool compile main.go â†’ main.o</span></span>
<span class="line"><span>    â”œâ”€ è¯æ³•åˆ†æï¼šsource â†’ tokens</span></span>
<span class="line"><span>    â”œâ”€ è¯­æ³•åˆ†æï¼štokens â†’ AST (syntax.File)</span></span>
<span class="line"><span>    â”œâ”€ ç±»å‹æ£€æŸ¥ï¼šAST â†’ Object + Type (types2)</span></span>
<span class="line"><span>    â”œâ”€ IR ç”Ÿæˆï¼ˆNodingï¼‰ï¼štypes2 â†’ Unified IR â†’ compiler IR</span></span>
<span class="line"><span>    â”œâ”€ ä¸­ç«¯ä¼˜åŒ–ï¼šå†…è”ã€é€ƒé€¸åˆ†æã€æ­»ä»£ç æ¶ˆé™¤ï¼ˆIR çº§ï¼‰</span></span>
<span class="line"><span>    â”œâ”€ Walkï¼šåç³–ã€æ‹†è§£ã€é«˜çº§æ„é€ è½¬æ¢</span></span>
<span class="line"><span>    â”œâ”€ SSA ç”Ÿæˆï¼šIR â†’ SSA</span></span>
<span class="line"><span>    â”œâ”€ SSA ä¼˜åŒ–ï¼šæœºå™¨æ— å…³ä¼˜åŒ– (Generic Passes)</span></span>
<span class="line"><span>    â”œâ”€ SSA é™çº§ï¼šé€šç”¨ SSA â†’ æœºå™¨ç›¸å…³ SSA (Lower Pass)</span></span>
<span class="line"><span>    â”œâ”€ æœ€ç»ˆä¼˜åŒ–ï¼šæ­»ä»£ç æ¶ˆé™¤ã€å¯„å­˜å™¨åˆ†é…ã€æŒ‡ä»¤è°ƒåº¦</span></span>
<span class="line"><span>    â””â”€ æœºå™¨ç ï¼šSSA â†’ obj.Prog â†’ ç›®æ ‡æ–‡ä»¶ main.o</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>go tool link main.o â†’ main</span></span>
<span class="line"><span>    â”œâ”€ è¯»å–æ‰€æœ‰ .o æ–‡ä»¶å’Œ export data</span></span>
<span class="line"><span>    â”œâ”€ ç¬¦å·è§£æå’Œé‡å®šä½</span></span>
<span class="line"><span>    â”œâ”€ å†…å­˜å¸ƒå±€</span></span>
<span class="line"><span>    â””â”€ ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>mainï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰</span></span></code></pre>
<h3 id="142--ä¼˜åŒ–å‘ç”Ÿçš„ä½ç½®">1.4.2 Â· ä¼˜åŒ–å‘ç”Ÿçš„ä½ç½®</h3>
<ul>
<li><strong>Unified IR å†™å…¥é˜¶æ®µ</strong>ï¼šæ—©æœŸæ­»ä»£ç æ¶ˆé™¤</li>
<li><strong>IR çº§</strong>ï¼ˆWalk å‰ï¼‰ï¼šå†…è”ã€é€ƒé€¸åˆ†æã€æ­»ä»£ç æ¶ˆé™¤ã€å»è™šæ‹ŸåŒ–</li>
<li><strong>SSA çº§ï¼ˆGeneric Passesï¼‰</strong>ï¼šæœºå™¨æ— å…³ä¼˜åŒ–ï¼ˆå¸¸é‡æŠ˜å ã€åˆ†æ”¯æ¶ˆé™¤ã€nil æ£€æŸ¥ç§»é™¤ç­‰ï¼‰</li>
<li><strong>SSA é™çº§å</strong>ï¼šæœºå™¨ç›¸å…³ä¼˜åŒ–ï¼ˆå¦‚ amd64 ç‰¹å®šçš„æŒ‡ä»¤ç»„åˆï¼‰</li>
<li><strong>æœ€ç»ˆä¼˜åŒ–</strong>ï¼šå¯„å­˜å™¨åˆ†é…ã€æ ˆå¸§å¸ƒå±€ã€æŒ‡ä»¤è°ƒåº¦ã€æ´»è·ƒæŒ‡é’ˆåˆ†æ</li>
</ul>
<hr>
<h2 id="15--å‚è€ƒèµ„æº">1.5 Â· å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://github.com/golang/go/tree/master/src/cmd/compile">Go ç¼–è¯‘å™¨ä»“åº“</a></li>
<li><a href="https://github.com/golang/example/blob/master/gotypes/README.md">types åŒ…ç¤ºä¾‹</a></li>
<li><a href="https://go.dev/ref/spec#Declarations_and_scope">Go è§„èŒƒ - å£°æ˜å’Œä½œç”¨åŸŸ</a></li>
<li><a href="https://github.com/golang/go/blob/master/src/cmd/compile/internal/ssa/README.md">SSA æ–‡æ¡£</a></li>
</ul> <div class="mt-8 pt-8 border-t border-nord-4 dark:border-nord-2"> <details class="group cursor-pointer"> <summary class="btn-primary list-none"> <svg class="w-5 h-5 transition-transform group-open:rotate-90" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"> <path d="M9 5l7 7-7 7"></path> </svg> <span>Local Knowledge Graph</span> </summary> <div class="mt-4"> <div id="local-graph-1770123038-RTOD" style="height: 400px;" class="knowledge-graph-container" data-astro-cid-zjb43jqo> <div class="knowledge-graph-wrapper" data-astro-cid-zjb43jqo> <svg id="local-graph-1770123038-RTOD-svg" style="width: 100%; height: 100%;" data-astro-cid-zjb43jqo></svg> </div> </div>  <script>(function(){const containerId = "local-graph-1770123038-RTOD";
const nodeRadius = 4;
const showLabels = true;
const enableZoom = true;
const enableDrag = true;
const dataJson = "{\"nodes\":[{\"id\":\"1770123038-RTOD\",\"urlId\":\"1770123038-RTOD\",\"label\":\"Go: compile ç¼–è¯‘å™¨\",\"title\":\"Go: compile ç¼–è¯‘å™¨\",\"group\":\"default\",\"nodeType\":\"current\"},{\"id\":\"1770123038-CJXA\",\"urlId\":\"1770123038-CJXA\",\"label\":\"Go: channel é€šé“\",\"title\":\"Go: channel é€šé“\",\"group\":\"default\",\"nodeType\":\"backlink\"},{\"id\":\"1770786730-PFOI\",\"urlId\":\"1770786730-PFOI\",\"label\":\"Go: goroutine åç¨‹\",\"title\":\"Go: goroutine åç¨‹\",\"group\":\"default\",\"nodeType\":\"neighbor\"}],\"links\":[{\"source\":\"1770123038-CJXA\",\"target\":\"1770786730-PFOI\"},{\"source\":\"1770123038-CJXA\",\"target\":\"1770123038-RTOD\"}]}";

  (window.__KNOWLEDGE_GRAPH_QUEUE__ = window.__KNOWLEDGE_GRAPH_QUEUE__ || []).push({
    containerId,
    dataJson,
    nodeRadius,
    showLabels,
    enableZoom,
    enableDrag,
  });
})();</script> </div> </details> </div><!-- Diagrams rendered at build time -->  </article> <nav class="mt-12 pt-8 border-t border-nord-4 dark:border-nord-1" data-astro-cid-v5yihett> <a href="/notes" class="btn-primary" data-astro-cid-v5yihett> <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" data-astro-cid-v5yihett> <path d="M15 19l-7-7 7-7" data-astro-cid-v5yihett></path> </svg>
Back to Notes
</a> </nav>  </main> <footer class="border-t border-nord-5 dark:border-nord-1 mt-12"> <div class="max-w-4xl mx-auto px-4 py-6 text-sm text-nord-3 dark:text-nord-4 text-center"> <p>&copy; 2026. All rights reserved.</p> </div> </footer> <script type="module" src="/_astro/Base.astro_astro_type_script_index_0_lang.WDMQca9J.js"></script> <script>
      (function() {
        const root = document.getElementById('series-dropdown-root');
        const trigger = document.getElementById('series-dropdown-trigger');
        const panel = document.getElementById('series-dropdown-panel');
        const listEl = document.getElementById('series-dropdown-list');
        if (!root || !trigger || !panel || !listEl) return;

        let seriesList = null;
        let hoverTimeout = null;

        function open() {
          panel.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
          if (seriesList === null) {
            fetch('/series-list.json')
              .then((r) => r.json())
              .then((list) => {
                seriesList = list;
                if (list.length === 0) {
                  listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">æš‚æ— ç³»åˆ—</span>';
                } else {
                  listEl.innerHTML = list.map(function(name) {
                     const slug = name.toLowerCase().replace(/\s+/g, '-');
                     const url = '/notes/series/' + slug;
                     return '<a href="' + url + '" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors" role="menuitem">' + escapeHtml(name) + '</a>';
                   }).join('');
                }
              })
              .catch(function() {
                listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-11">åŠ è½½å¤±è´¥</span>';
              });
          }
        }

        function close() {
          panel.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        }

        function escapeHtml(s) {
          const div = document.createElement('div');
          div.textContent = s;
          return div.innerHTML;
        }

        // On click: allow default navigation to /notes/series
        // On hover: show dropdown menu
        trigger.addEventListener('click', function(e) {
          e.stopPropagation();
          // Don't preventDefault - allow link to navigate
        });

        trigger.addEventListener('mouseenter', function() {
          if (hoverTimeout) clearTimeout(hoverTimeout);
          hoverTimeout = setTimeout(open, 200);
        });

        root.addEventListener('mouseleave', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
          hoverTimeout = setTimeout(close, 150);
        });

        panel.addEventListener('mouseenter', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
        });

        document.addEventListener('click', function(e) {
          if (!root.contains(e.target)) close();
        });
      })();
    </script> <script>
      (function() {
        const root = document.getElementById('tags-dropdown-root');
        const trigger = document.getElementById('tags-dropdown-trigger');
        const panel = document.getElementById('tags-dropdown-panel');
        const listEl = document.getElementById('tags-dropdown-list');
        if (!root || !trigger || !panel || !listEl) return;

        let tagList = null;
        let hoverTimeout = null;

        function open() {
          panel.classList.remove('hidden');
          trigger.setAttribute('aria-expanded', 'true');
          if (tagList === null) {
            fetch('/tag-list.json')
              .then((r) => r.json())
              .then((list) => {
                tagList = list;
                if (list.length === 0) {
                  listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-4 dark:text-nord-3">æš‚æ— æ ‡ç­¾</span>';
                } else {
                  listEl.innerHTML = list.map(function(tag) {
                     const url = '/notes/tag/' + encodeURIComponent(tag);
                     return '<a href="' + url + '" class="block px-3 py-2 text-sm text-nord-9 dark:text-nord-8 hover:bg-nord-5 dark:hover:bg-nord-2 transition-colors" role="menuitem">' + escapeHtml(tag) + '</a>';
                   }).join('');
                }
              })
              .catch(function() {
                listEl.innerHTML = '<span class="block px-3 py-2 text-xs text-nord-11">åŠ è½½å¤±è´¥</span>';
              });
          }
        }

        function close() {
          panel.classList.add('hidden');
          trigger.setAttribute('aria-expanded', 'false');
        }

        function escapeHtml(s) {
          const div = document.createElement('div');
          div.textContent = s;
          return div.innerHTML;
        }

        trigger.addEventListener('click', function(e) {
          e.stopPropagation();
        });

        trigger.addEventListener('mouseenter', function() {
          if (hoverTimeout) clearTimeout(hoverTimeout);
          hoverTimeout = setTimeout(open, 200);
        });

        root.addEventListener('mouseleave', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
          hoverTimeout = setTimeout(close, 150);
        });

        panel.addEventListener('mouseenter', function() {
          if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
        });

        document.addEventListener('click', function(e) {
          if (!root.contains(e.target)) close();
        });
      })();
    </script> </body> </html>  <script>
  // Language aliases (matches server-side)
  const langAliases = {
    js: 'javascript',
    ts: 'typescript',
    yml: 'yaml',
    yaml: 'yaml',
    sh: 'bash',
    shell: 'bash',
    sql: 'postgresql',
    java: 'openjdk',
  };

  // Add headers and copy buttons to code blocks
  function initCodeBlocks() {
    document.querySelectorAll('pre[data-language]').forEach((pre) => {
      // Skip if already processed
      if (pre.parentNode.classList.contains('code-block-wrapper')) return;
      
      const lang = pre.getAttribute('data-language') || 'code';
      
      // Create wrapper
      const wrapper = document.createElement('div');
      wrapper.className = 'code-block-wrapper';
      pre.parentNode.insertBefore(wrapper, pre);
      wrapper.appendChild(pre);
      
      // Create header
      const header = document.createElement('div');
      header.className = 'code-header';
      
      const langSpan = document.createElement('span');
      langSpan.className = 'code-header-lang';
      langSpan.title = lang;
      
      // Normalize lang for devicon
      const normalizedLang = lang.toLowerCase();
      const iconLang = langAliases[normalizedLang] || normalizedLang;
      
      // Display language with devicon (format: devicon-{name}-{version} colored)
      const iconEl = document.createElement('i');
      iconEl.className = `devicon-${iconLang}-plain colored`;
      iconEl.style.marginRight = '0.375rem';
      iconEl.style.fontSize = '0.75rem';
      langSpan.appendChild(iconEl);
      langSpan.appendChild(document.createTextNode(lang));
      
      const button = document.createElement('button');
      button.className = 'copy-code-btn';
      button.title = 'Copy to clipboard';
      button.innerHTML = '<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
      
      let isCopying = false;
      button.addEventListener('click', async () => {
        if (isCopying) return;
        isCopying = true;
        
        const code = pre.querySelector('code')?.textContent || '';
        try {
          await navigator.clipboard.writeText(code);
          const originalHtml = button.innerHTML;
          button.innerHTML = '<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>';
          button.title = 'Copied!';
          setTimeout(() => {
            button.innerHTML = originalHtml;
            button.title = 'Copy to clipboard';
            isCopying = false;
          }, 2000);
        } catch (err) {
          console.error('Failed to copy:', err);
          isCopying = false;
        }
      });
      
      header.appendChild(langSpan);
      header.appendChild(button);
      wrapper.appendChild(header);
    });
  }

  // Run ASAP, then on DOMContentLoaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCodeBlocks);
  } else {
    initCodeBlocks();
  }

  // Convert wikilinks to links on client side
  // Matches [[ref]] or [[ref|display text]]
  document.addEventListener('DOMContentLoaded', () => {
    const wikiRegex = /\[\[([a-zA-Z0-9][a-zA-Z0-9_-]*?)(?:\|([^\]]+))?\]\]/g;
    
    // Process all text nodes in prose content
    const walker = document.createTreeWalker(
      document.querySelector('.prose') || document.body,
      NodeFilter.SHOW_TEXT,
      null,
      false
    );
    
    const nodesToReplace = [];
    let node;
    
    while (node = walker.nextNode()) {
      if (node.nodeValue.includes('[[')) {
        nodesToReplace.push(node);
      }
    }
    
    nodesToReplace.forEach((textNode) => {
      const parent = textNode.parentNode;
      let lastIndex = 0;
      const matches = [...textNode.nodeValue.matchAll(wikiRegex)];
      
      if (matches.length === 0) return;
      
      const fragment = document.createDocumentFragment();
      
      matches.forEach((match) => {
        const [fullMatch, ref, displayText] = match;
        const startIndex = match.index;
        
        // Add text before match
        if (startIndex > lastIndex) {
          fragment.appendChild(
            document.createTextNode(textNode.nodeValue.slice(lastIndex, startIndex))
          );
        }
        
        // Create link
        const link = document.createElement('a');
        link.href = `/notes/${ref.toLowerCase()}`;
        link.textContent = (displayText || ref).trim();
        link.className = 'text-nord-9 dark:text-nord-8 hover:text-nord-10 dark:hover:text-nord-7 transition-colors';
        fragment.appendChild(link);
        
        lastIndex = startIndex + fullMatch.length;
      });
      
      // Add remaining text
      if (lastIndex < textNode.nodeValue.length) {
        fragment.appendChild(
          document.createTextNode(textNode.nodeValue.slice(lastIndex))
        );
      }
      
      parent.replaceChild(fragment, textNode);
    });
  });
</script> 